# PROMPT SPLIT v4 - Défactorisation avec GROUPES et NAV4

Version: v4 (2025-12-31)
Changements v3→v4:
- Structure GROUPES (remplace tabs/ plat)
- NAV4 (sous-tabs)
- Service orchestrateur autorisé
- CSS layout page autorisé
- Barrel files modals autorisés

---

## A) Contexte

Tu es un expert en refactoring React/TypeScript pour le projet New Manager OVHcloud.

**Architecture de navigation :**
- **NAV1** : Catégorie principale (ex: general, web-cloud, bare-metal, network...)
- **NAV2** : Sous-catégorie / Produit (ex: domains, hosting, emails, vps...)
- **NAV3-GROUP** : Groupe de tabs (ex: general, dns, expert)
- **NAV3-TAB** : Onglet fonctionnel dans un groupe (ex: zone, dnssec, glue)
- **NAV4** : Sous-tab (ex: dynhost/login, contacts/owo)

**Convention : le 1er élément de chaque niveau s'appelle `general`**

**Objectif :** DÉFACTORISER un module monolithique en modules ISOLÉS par tab, organisés en GROUPES.

---

## B) Arborescence Cible

### B.1) Structure SIMPLE (sans groupes)

Pour les NAV2 avec peu de tabs (< 5), structure plate :

```
src/pages/{NAV1}/{NAV2}/
├── {nav2}.types.ts              ← Types partagés NAV2
├── {nav2}.service.ts            ← Orchestrateur (LEFT PANEL)
├── {nav2}.css                   ← Layout page (LEFT + RIGHT)
├── index.tsx                    ← Page principale
└── tabs/
    └── {tab}/
        ├── {Tab}Tab.tsx
        ├── {Tab}Tab.service.ts
        ├── {Tab}Tab.css
        └── modals/
            └── {Modal}Modal.tsx
```

### B.2) Structure avec GROUPES (recommandée)

Pour les NAV2 avec beaucoup de tabs (>= 5), organisation en groupes :

```
src/pages/{NAV1}/{NAV2}/
├── {nav2}.types.ts              ← Types partagés NAV2
├── {nav2}.service.ts            ← Orchestrateur (LEFT PANEL)
├── {nav2}.css                   ← Layout page
├── index.tsx                    ← Page principale
│
├── general/                     ← GROUPE 1 (toujours présent)
│   ├── index.ts                 ← Export modals du groupe
│   ├── GeneralTab.tsx           ← Tab principal du groupe
│   ├── GeneralTab.service.ts
│   ├── GeneralTab.css
│   ├── {Modal}Modal.tsx         ← Modals partagées du groupe
│   └── {subtab}/                ← NAV4: sous-tabs
│       ├── {Subtab}Tab.tsx
│       ├── {Subtab}Tab.service.ts
│       └── {Subtab}Tab.css
│
├── {group2}/                    ← GROUPE 2
│   ├── index.ts
│   ├── {tab}/
│   │   ├── {Tab}Tab.tsx
│   │   ├── {Tab}Tab.service.ts
│   │   └── {Tab}Tab.css
│   └── {Modal}Modal.tsx
│
└── expert/                      ← GROUPE N (souvent "expert")
    ├── index.ts
    ├── tasks/
    │   ├── TasksTab.tsx
    │   ├── TasksTab.service.ts
    │   └── TasksTab.css
    └── ...
```

### B.3) Exemple concret : web-cloud/domains

```
src/pages/web-cloud/domains/
├── domains.types.ts
├── domains.service.ts           ← Liste domaines/zones (LEFT PANEL)
├── domains.css                  ← Layout 280px + flex
├── index.tsx
│
├── general/                     ← GROUPE: Général
│   ├── index.ts                 ← Export: LockModal, RenewModal...
│   ├── GeneralTab.tsx
│   ├── GeneralTab.service.ts
│   ├── GeneralTab.css
│   ├── AuthInfoModal.tsx
│   ├── LockModal.tsx
│   ├── RenewModal.tsx
│   ├── contacts/                ← NAV4
│   │   ├── ContactsTab.tsx
│   │   ├── ContactsTab.service.ts
│   │   └── ContactsTab.css
│   └── alldom/                  ← NAV4
│       └── ...
│
├── dns/                         ← GROUPE: DNS
│   ├── index.ts                 ← Export: AddRecordModal...
│   ├── zone/
│   │   ├── ZoneTab.tsx
│   │   ├── ZoneTab.service.ts
│   │   └── ZoneTab.css
│   ├── dnssec/
│   ├── dynhost/
│   │   ├── DynHostTab.tsx
│   │   └── login/               ← NAV4
│   │       └── LoginTab.tsx
│   ├── AddRecordModal.tsx
│   └── ...
│
└── expert/                      ← GROUPE: Expert
    ├── index.ts
    ├── glue/
    └── tasks/
```

### B.4) Traductions

```
public/locales/{lang}/{NAV1}/{NAV2}/
├── index.json                   ← Labels page principale
├── {group}.json                 ← Labels groupe (si besoin)
└── {tab}.json                   ← Labels tab (1 fichier par tab)
```

**Exemple :**
```
public/locales/fr/web-cloud/domains/
├── index.json
├── general.json
├── contacts.json
├── alldom.json
├── zone.json
├── dnssec.json
├── dynhost.json
├── glue.json
└── tasks.json
```

---

## C) Principe de DÉFACTORISATION (STRICT)

### Définition

**DÉFACTORISATION** = L'inverse de la factorisation/mutualisation.
Au lieu de partager le code commun, on le **DUPLIQUE VOLONTAIREMENT** pour garantir l'**INDÉPENDANCE TOTALE**.

> "Chaque tab est une île. Aucun pont entre les îles. Ni en JS, ni en CSS."

### Pourquoi défactoriser ?

| Factorisation (AVANT)                | Défactorisation (APRÈS)              |
|--------------------------------------|--------------------------------------|
| 1 service partagé = 1 point de casse | N services isolés = 0 régression     |
| 1 CSS partagé = styles qui cassent   | N CSS isolés = styles indépendants   |
| Modifier Zone casse Dnssec           | Modifier Zone n'impacte QUE Zone     |
| Couplage fort entre tabs             | Couplage ZÉRO entre tabs             |
| "DRY" mal appliqué                   | "WET" assumé (Write Everything Twice)|

### Règle d'or

```
SI deux tabs ont besoin de la même fonction/style/helper :
   → DUPLIQUER le code dans CHAQUE tab
   → NE JAMAIS créer un fichier partagé entre tabs
```

---

## D) INTERDITS ABSOLUS - JAVASCRIPT/TYPESCRIPT

### ❌ INTERDIT JS-1 : Import croisé entre TABS

```typescript
// ❌ INTERDIT - ZoneTab.tsx ne doit JAMAIS faire :
import { dnssecService } from "../dnssec/DnssecTab.service";
import { quelqueChose } from "../../general/GeneralTab";
import { formatRecord } from "../dynhost/DynHostTab";
```

### ❌ INTERDIT JS-2 : Import croisé entre GROUPES

```typescript
// ❌ INTERDIT - Un tab du groupe dns/ ne doit JAMAIS importer de general/
import { lockService } from "../../general/GeneralTab.service";
import { ContactsTab } from "../../general/contacts/ContactsTab";
```

### ❌ INTERDIT JS-3 : Service MÉTIER global dans /services/

```typescript
// ❌ INTERDIT - Plus JAMAIS de service métier mutualisé
import { domainsService } from "../../../../../services/web-cloud.domains";
import { hostingService } from "../../../../../services/web-cloud.hosting";
```

### ❌ INTERDIT JS-4 : Helper/utils partagé au niveau NAV2

```typescript
// ❌ INTERDIT - Pas de fichier utils/helpers commun
import { formatDate } from "../../domains.utils";
import { validateRecord } from "../../domains.helpers";
import { useDomainData } from "../../hooks/useDomainData";
```

### ❌ INTERDIT JS-5 : Composant partagé interne au NAV2

```typescript
// ❌ INTERDIT - Pas de composants mutualisés entre tabs
import { DomainCard } from "../../components/DomainCard";
import { RecordSelector } from "../../shared/RecordSelector";
```

### ❌ INTERDIT JS-6 : Context/Provider partagé entre tabs

```typescript
// ❌ INTERDIT - Pas de context commun entre tabs
import { useDomainContext } from "../../DomainContext";
import { DomainProvider } from "../../DomainProvider";
```

---

## E) INTERDITS ABSOLUS - CSS/STYLES

### ❌ INTERDIT CSS-1 : Import CSS d'un autre TAB

```typescript
// ❌ INTERDIT - ZoneTab ne doit JAMAIS importer le CSS d'un autre tab
import "../dnssec/DnssecTab.css";
import styles from "../../general/GeneralTab.module.css";
```

### ❌ INTERDIT CSS-2 : Import CSS d'un autre GROUPE

```typescript
// ❌ INTERDIT - Tab dns/ ne doit JAMAIS importer CSS de general/
import "../../general/GeneralTab.css";
```

### ❌ INTERDIT CSS-3 : Classes CSS génériques sans préfixe

```css
/* ❌ INTERDIT - Pas de classes génériques sans préfixe tab */
.record-table { }
.domain-card { }
.dns-modal { }
```

### ❌ INTERDIT CSS-4 : Variables CSS locales partagées

```css
/* ❌ INTERDIT - Pas de variables CSS communes entre tabs */
/* domains-variables.css */
:root {
  --domains-primary: #0050d7;
  --domains-spacing: 16px;
}
```

---

## F) AUTORISÉS

### ✅ AUTORISÉ 1 : Types partagés au niveau NAV2

```typescript
// ✅ OK - Un seul fichier types partagé
import type { Domain, DnsZone, DnsRecord } from "../../domains.types";
```

**Pourquoi ?** Les types sont des contrats d'API, pas du code exécutable.

### ✅ AUTORISÉ 2 : Service ORCHESTRATEUR au niveau NAV2

```typescript
// ✅ OK - Service pour le LEFT PANEL (liste items)
// domains.service.ts
import { ovhGet } from "../../../services/api";

class DomainsPageService {
  async listDomains(): Promise<string[]> {
    return ovhGet<string[]>("/domain");
  }
  async listZones(): Promise<string[]> {
    return ovhGet<string[]>("/domain/zone");
  }
}
export const domainsPageService = new DomainsPageService();
```

**Pourquoi ?** L'orchestrateur gère le LEFT PANEL, pas la logique métier des tabs.

### ✅ AUTORISÉ 3 : CSS LAYOUT PAGE au niveau NAV2

```typescript
// ✅ OK - CSS pour layout page (uniquement dans index.tsx)
import "./domains.css";
```

```css
/* domains.css - Layout LEFT PANEL + RIGHT PANEL */
.domains-page { display: flex; height: 100%; }
.domains-left-panel { width: 280px; border-right: 1px solid var(--ods-color-border); }
.domains-right-panel { flex: 1; overflow: auto; }
```

**Pourquoi ?** Le layout de la page est géré par index.tsx, pas par les tabs.

### ✅ AUTORISÉ 4 : Services API globaux (/services/api.ts)

```typescript
// ✅ OK - Fonctions API bas niveau
import { ovhGet, ovhPost, ovhPut, ovhDelete } from "../../../../../services/api";
```

### ✅ AUTORISÉ 5 : Composants design system global (/components/)

```typescript
// ✅ OK - Composants UI génériques
import { Button, Modal, Table, Alert } from "../../../../../components/ui";
import { DataGrid } from "../../../../../components/DataGrid";
import { LeftPanel } from "../../../../../components/LeftPanel";
```

### ✅ AUTORISÉ 6 : CSS design system global (/styles/)

```css
/* ✅ OK - Utiliser les variables CSS globales ODS */
.zone-card {
  color: var(--ods-color-primary);
  padding: var(--ods-spacing-md);
  border-radius: var(--ods-radius-md);
}
```

### ✅ AUTORISÉ 7 : Hooks globaux (/hooks/)

```typescript
// ✅ OK - Hooks génériques
import { useApi } from "../../../../../hooks/useApi";
import { useToast } from "../../../../../hooks/useToast";
import { useTranslation } from "react-i18next";
```

### ✅ AUTORISÉ 8 : Barrel file pour MODALS d'un groupe

```typescript
// ✅ OK - index.ts qui exporte UNIQUEMENT les modals d'un groupe
// dns/index.ts
export { AddRecordModal } from "./AddRecordModal";
export { EditRecordModal } from "./EditRecordModal";
export { DeleteRecordModal } from "./DeleteRecordModal";

// ❌ INTERDIT - NE PAS exporter les tabs
export { ZoneTab } from "./zone/ZoneTab";  // ❌ NON
```

### ✅ AUTORISÉ 9 : Lazy loading des tabs

```typescript
// ✅ OK - Lazy loading dans index.tsx
const ZoneTab = React.lazy(() =>
  import("./dns/zone/ZoneTab").then(m => ({ default: m.ZoneTab }))
);
const DnssecTab = React.lazy(() =>
  import("./dns/dnssec/DnssecTab").then(m => ({ default: m.DnssecTab }))
);
```

### ✅ AUTORISÉ 10 : Duplication JS ASSUMÉE

```typescript
// ✅ OK - Si Zone et Dnssec ont besoin de formatTtl(), CHAQUE tab a SA copie

// dns/zone/ZoneTab.service.ts
const formatTtl = (ttl: number) => ttl >= 3600 ? `${ttl/3600}h` : `${ttl}s`;

// dns/dnssec/DnssecTab.service.ts
const formatTtl = (ttl: number) => ttl >= 3600 ? `${ttl/3600}h` : `${ttl}s`;
```

### ✅ AUTORISÉ 11 : Duplication CSS ASSUMÉE

```css
/* ✅ OK - Si Zone et Dnssec ont besoin du même style, CHAQUE tab a SA copie */

/* dns/zone/ZoneTab.css */
.zone-status-badge {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
}

/* dns/dnssec/DnssecTab.css */
.dnssec-status-badge {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
}
```

---

## G) Structure par Tab

### G.1) Fichiers d'un tab

```
{group}/{tab}/
├── {Tab}Tab.tsx              ← Composant React
├── {Tab}Tab.service.ts       ← Service API isolé
├── {Tab}Tab.css              ← Styles isolés
└── {Tab}Tab.types.ts         ← Types locaux (optionnel)
```

### G.2) Convention de nommage CSS

**Préfixe OBLIGATOIRE par tab :**

| Tab | Préfixe CSS | Exemples |
|-----|-------------|----------|
| zone | `.zone-` | `.zone-table`, `.zone-record` |
| dnssec | `.dnssec-` | `.dnssec-status`, `.dnssec-key` |
| dynhost | `.dynhost-` | `.dynhost-entry`, `.dynhost-ip` |
| glue | `.glue-` | `.glue-record`, `.glue-host` |
| tasks | `.tasks-` | `.tasks-table`, `.tasks-status` |

### G.3) Structure d'un service tab

```typescript
// {Tab}Tab.service.ts
import { ovhGet, ovhPost, ovhPut, ovhDelete } from "../../../../../services/api";
import type { DnsRecord } from "../../domains.types";

// ========================================
// SERVICE ZONE - ISOLÉ
// ========================================

// Helpers locaux (dupliqués si nécessaire)
const formatTtl = (ttl: number): string =>
  ttl >= 3600 ? `${Math.floor(ttl/3600)}h` : `${ttl}s`;

// API calls
export const zoneService = {
  getRecords: (zone: string): Promise<number[]> =>
    ovhGet(`/domain/zone/${zone}/record`),

  getRecord: (zone: string, id: number): Promise<DnsRecord> =>
    ovhGet(`/domain/zone/${zone}/record/${id}`),

  createRecord: (zone: string, data: Partial<DnsRecord>): Promise<DnsRecord> =>
    ovhPost(`/domain/zone/${zone}/record`, data),

  updateRecord: (zone: string, id: number, data: Partial<DnsRecord>): Promise<void> =>
    ovhPut(`/domain/zone/${zone}/record/${id}`, data),

  deleteRecord: (zone: string, id: number): Promise<void> =>
    ovhDelete(`/domain/zone/${zone}/record/${id}`),

  refresh: (zone: string): Promise<void> =>
    ovhPost(`/domain/zone/${zone}/refresh`),
};
```

---

## H) Structure des GROUPES

### H.1) Qu'est-ce qu'un groupe ?

Un **groupe** organise plusieurs tabs thématiquement liés.

| Groupe | Description | Tabs typiques |
|--------|-------------|---------------|
| `general` | Informations générales | general, contacts, alldom |
| `dns` | Configuration DNS | zone, dnssec, dnsservers, dynhost |
| `expert` | Fonctions avancées | glue, tasks |

### H.2) Règles des groupes

| Règle | Description |
|-------|-------------|
| **Isolation** | Chaque groupe est INDÉPENDANT des autres |
| **Pas d'import croisé** | Un tab de `dns/` n'importe JAMAIS de `general/` |
| **Modals partagées** | Les modals d'un groupe sont à sa racine |
| **index.ts** | Exporte UNIQUEMENT les modals du groupe |

### H.3) Navigation entre groupes

Dans `index.tsx`, le groupe actif est géré par état :

```typescript
const [activeGroup, setActiveGroup] = useState<"general" | "dns" | "expert">("general");
const [activeTab, setActiveTab] = useState<string>("general");

// Render tabs du groupe actif
{activeGroup === "general" && (
  <>
    {activeTab === "general" && <GeneralTab {...props} />}
    {activeTab === "contacts" && <ContactsTab {...props} />}
    {activeTab === "alldom" && <AlldomTab {...props} />}
  </>
)}
```

---

## I) Structure NAV4 (Sous-tabs)

### I.1) Qu'est-ce qu'un NAV4 ?

Un **NAV4** est un sous-tab d'un tab principal.

**Exemples :**
- `general/contacts/` → Sous-tab "Contacts" du groupe general
- `dns/dynhost/login/` → Sous-tab "Logins" du tab DynHost

### I.2) Arborescence NAV4

```
{group}/{tab}/
├── {Tab}Tab.tsx              ← Tab principal (affiche sub-navigation)
├── {Tab}Tab.service.ts
├── {Tab}Tab.css
└── {subtab}/                 ← NAV4
    ├── {Subtab}Tab.tsx
    ├── {Subtab}Tab.service.ts
    └── {Subtab}Tab.css
```

### I.3) Exemple : DynHost avec NAV4

```
dns/dynhost/
├── DynHostTab.tsx            ← Affiche: [Entrées] [Logins]
├── DynHostTab.service.ts     ← API: /domain/zone/{z}/dynHost/record
├── DynHostTab.css
└── login/                    ← NAV4: Logins
    ├── LoginTab.tsx
    ├── LoginTab.service.ts   ← API: /domain/zone/{z}/dynHost/login
    └── LoginTab.css
```

### I.4) Règles NAV4

| Règle | Description |
|-------|-------------|
| **Isolation** | Chaque NAV4 est INDÉPENDANT des autres |
| **Pas d'import parent** | LoginTab n'importe PAS DynHostTab.service |
| **Service propre** | Chaque NAV4 a son propre service |
| **CSS propre** | Chaque NAV4 a son propre CSS |

---

## J) Indépendance entre niveaux

| Niveau | Indépendance | Partage autorisé |
|--------|--------------|------------------|
| **NAV1 ↔ NAV1** | ✅ TOTALE | Globaux uniquement |
| **NAV2 ↔ NAV2** | ✅ TOTALE | Globaux uniquement |
| **GROUPE ↔ GROUPE** | ✅ TOTALE | `{nav2}.types.ts` uniquement |
| **TAB ↔ TAB** | ✅ TOTALE | `{nav2}.types.ts` uniquement |
| **NAV4 ↔ NAV4** | ✅ TOTALE | `{nav2}.types.ts` uniquement |

**Globaux autorisés :**
- `/services/api.ts`
- `/components/ui/`
- `/components/LeftPanel/`
- `/hooks/`
- Variables CSS ODS (`var(--ods-*)`)

---

## K) Conventions de Nommage

### K.1) Fichiers

| Élément | Convention | Exemple |
|---------|------------|---------|
| **Types NAV2** | `{nav2}.types.ts` | `domains.types.ts` |
| **Orchestrateur** | `{nav2}.service.ts` | `domains.service.ts` |
| **CSS page** | `{nav2}.css` | `domains.css` |
| **Page principale** | `index.tsx` | `index.tsx` |
| **Groupe** | `{group}/` | `general/`, `dns/`, `expert/` |
| **Tab** | `{Tab}Tab.tsx` | `ZoneTab.tsx`, `GlueTab.tsx` |
| **Service tab** | `{Tab}Tab.service.ts` | `ZoneTab.service.ts` |
| **CSS tab** | `{Tab}Tab.css` | `ZoneTab.css` |
| **NAV4** | `{subtab}/` | `contacts/`, `login/` |
| **Modal** | `{Action}Modal.tsx` | `AddRecordModal.tsx` |
| **Traduction** | `{tab}.json` | `zone.json`, `dnssec.json` |

### K.2) Classes CSS

| Tab | Préfixe | Exemples |
|-----|---------|----------|
| general | `.general-` | `.general-card`, `.general-info` |
| contacts | `.contacts-` | `.contacts-table`, `.contacts-row` |
| zone | `.zone-` | `.zone-record`, `.zone-ttl` |
| dnssec | `.dnssec-` | `.dnssec-key`, `.dnssec-status` |
| dnsservers | `.dnsservers-` | `.dnsservers-list` |
| dynhost | `.dynhost-` | `.dynhost-entry`, `.dynhost-ip` |
| glue | `.glue-` | `.glue-record`, `.glue-host` |
| tasks | `.tasks-` | `.tasks-table`, `.tasks-status` |

### K.3) Services

| Type | Nommage | Exemple |
|------|---------|---------|
| Orchestrateur | `{nav2}PageService` | `domainsPageService` |
| Tab service | `{tab}Service` | `zoneService`, `glueService` |

### K.4) Imports depuis un tab

```typescript
// Service API global
import { ovhGet, ovhPost } from "../../../../../services/api";

// Types NAV2 (seul partage autorisé)
import type { Domain, DnsRecord } from "../../domains.types";

// Service local
import { zoneService } from "./ZoneTab.service";

// CSS local
import "./ZoneTab.css";

// Traductions
import { useTranslation } from "react-i18next";
const { t } = useTranslation("web-cloud/domains/zone");
```

---

## L) Workflow de Défactorisation

### PHASE 1 : ANALYSE

```bash
# 1. Identifier la structure actuelle
find src/pages/{nav1}/{nav2} -type f -name "*.ts*" | head -30

# 2. Lister les services monolithiques
grep -rn "from.*services/{nav1}\.{nav2}" src/pages/{nav1}/{nav2}/

# 3. Lister les imports croisés
grep -rn "from.*\.\.\/.*Tab" src/pages/{nav1}/{nav2}/

# 4. Lister les CSS partagés
grep -rn "import.*\.\.\/.*\.css" src/pages/{nav1}/{nav2}/
```

### PHASE 2 : CRÉATION STRUCTURE

```bash
# Créer les groupes
mkdir -p src/pages/{nav1}/{nav2}/{general,dns,expert}

# Créer les tabs
mkdir -p src/pages/{nav1}/{nav2}/dns/{zone,dnssec,dynhost}
mkdir -p src/pages/{nav1}/{nav2}/expert/{glue,tasks}
```

### PHASE 3 : CRÉATION FICHIERS

Pour chaque tab, créer :
1. `{Tab}Tab.tsx` - Composant
2. `{Tab}Tab.service.ts` - Service isolé
3. `{Tab}Tab.css` - Styles isolés

### PHASE 4 : VÉRIFICATION

```bash
# ===== TESTS ISOLATION (doivent retourner 0 résultat) =====

echo "=== Test: imports croisés entre tabs ==="
grep -rn "from.*\.\.\/.*Tab" src/pages/{nav1}/{nav2}/ | grep -v "index.tsx"

echo "=== Test: imports croisés entre groupes ==="
grep -rn "from.*\.\.\/\.\.\/general\|from.*\.\.\/\.\.\/dns\|from.*\.\.\/\.\.\/expert" src/pages/{nav1}/{nav2}/

echo "=== Test: ancien service monolithique ==="
grep -rn "from.*services/{nav1}\.{nav2}" src/pages/{nav1}/{nav2}/

echo "=== Test: CSS croisé entre tabs ==="
grep -rn "import.*\.\.\/.*\.css" src/pages/{nav1}/{nav2}/ | grep -v "index.tsx"

# ===== BUILD =====
cd /home/ubuntu/aiapp/frontend && npm run build:dev
```

---

## M) Checklist Finale

### Structure

- [ ] `{nav2}.types.ts` créé
- [ ] `{nav2}.service.ts` créé (orchestrateur)
- [ ] `{nav2}.css` créé (layout page)
- [ ] `index.tsx` créé (page principale)
- [ ] Groupes créés (`general/`, `dns/`, `expert/`)
- [ ] Tabs créés dans chaque groupe

### Par Tab

- [ ] `{Tab}Tab.tsx` créé
- [ ] `{Tab}Tab.service.ts` créé (service isolé)
- [ ] `{Tab}Tab.css` créé (styles préfixés)
- [ ] Helpers dupliqués (pas de partage)

### Traductions

- [ ] `public/locales/fr/{nav1}/{nav2}/{tab}.json` créé
- [ ] `public/locales/en/{nav1}/{nav2}/{tab}.json` créé

### Validation

- [ ] Test imports croisés tabs → 0 résultat
- [ ] Test imports croisés groupes → 0 résultat
- [ ] Test ancien service → 0 résultat
- [ ] Test CSS croisé → 0 résultat
- [ ] Build réussi

---

## N) Rappel Final

> **DÉFACTORISATION = DUPLICATION VOLONTAIRE**
>
> Si tu hésites entre "factoriser pour éviter la duplication" et "dupliquer pour garantir l'isolation" :
>
> **→ TOUJOURS CHOISIR L'ISOLATION**
>
> Le coût de la duplication (quelques lignes JS/CSS en plus) est INFINIMENT plus faible que le coût du couplage (régressions en cascade, styles qui cassent, tests impossibles).

### Hiérarchie des partages

```
AUTORISÉ:
├── /services/api.ts           ← Globaux app
├── /components/ui/            ← Design system
├── /hooks/                    ← Hooks génériques
├── {nav2}.types.ts            ← Types NAV2
├── {nav2}.service.ts          ← Orchestrateur page
└── {nav2}.css                 ← Layout page

INTERDIT:
├── Service partagé entre tabs
├── CSS partagé entre tabs
├── Import croisé tab ↔ tab
├── Import croisé groupe ↔ groupe
└── Helper/utils partagé entre tabs
```

### Mantra

> **"Chaque tab est une île. Chaque groupe est un archipel. Aucun pont entre les îles. Ni en JS, ni en CSS."**

---

FIN PROMPT SPLIT v4
