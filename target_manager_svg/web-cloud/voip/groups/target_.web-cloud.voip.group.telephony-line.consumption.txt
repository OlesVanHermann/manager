# CAHIER DES CHARGES - old_manager.telecom.telephony.line.consumption
# Page consommation d'une ligne SIP

## 1. RESUME EXECUTIF

### Perimetre
Consultation de l'historique de consommation d'une ligne telephonique.

### Objectif fonctionnel
Visualiser les appels passes/recus, fax, et couts associes.

---

## 2. ARCHITECTURE

### Arborescence fichiers source
```
telecom/telephony/line/consumption/
├── consumption.module.js
├── incomingCalls/
├── outgoingCalls/
├── incomingFax/
├── outgoingFax/
└── translations/
```

---

## 3. PAGES & NAVIGATION

### Route
- State: `telecom.telephony.billingAccount.line.dashboard.consumption`
- URL: `/telephony/{billingAccount}/line/{serviceName}/consumption`

---

## 4. COMPOSANTS UI

### Filtres
- Periode (date debut / date fin)
- Type (appels / fax)
- Direction (entrant / sortant)

### Datagrid Appels
| Colonne | Description |
|---------|-------------|
| Date | Date et heure |
| Correspondant | Numero appele/appelant |
| Duree | En secondes |
| Type | National, mobile, international |
| Cout | En euros (HT) |

---

## 5. APIs & DONNEES

### Endpoints

```
GET /telephony/{billingAccount}/service/{serviceName}/voiceConsumption
GET /telephony/{billingAccount}/service/{serviceName}/voiceConsumption/{consumptionId}
Response: {
  consumptionId: number,
  creationDatetime: string,
  destination: string,
  duration: number,
  priceWithoutTax: { value: number, text: string },
  wayType: "incoming" | "outgoing"
}
```

```
GET /telephony/{billingAccount}/service/{serviceName}/faxConsumption
```

---

## 6. TRADUCTIONS

### Cles i18n (FR)
| Cle | Valeur FR |
|-----|-----------|
| telephony_line_tab_consumption | Consommation |
| telephony_line_management_actions_line_consumption_incoming_fax_breadcrumb | Fax recus |
| telephony_line_management_actions_line_consumption_outgoing_fax_breadcrumb | Fax emis |

---

## 7. REGLES METIER

### Periode consultation
- Maximum 3 mois glissants

### Types de destinations
| Code | Label FR |
|------|----------|
| landline | Fixe national |
| mobile | Mobile |
| international | International |
