# Cahier des Charges : telecom/telephony - Consommation ligne

## 1. RESUME EXECUTIF

### Perimetre
Page de suivi de la consommation d'une ligne VoIP.

### Objectif fonctionnel
- Consulter les statistiques de consommation
- Voir l'historique des appels emis/recus
- Filtrer par periode et type
- Identifier les appels hors forfait

---

## 2. LAYOUT

### Structure page avec onglets, cartes stats et tableau historique

---

## 3. COMPOSANTS UI

### Header page
| Element | Description |
|---------|-------------|
| Retour | ← Retour vers la gestion de votre consommation |
| Titre | Consommation |
| Sous-titre | Ligne XXXXXXXXXXXX |

### Onglets principaux
| Onglet | Etat |
|--------|------|
| Gestion | Inactif |
| Consommation | Actif (bleu) |
| Gestion des appels | Inactif |
| Gestion des musiques | Inactif |
| Softphone | Inactif |

### Sous-onglets consommation
| Onglet | Etat |
|--------|------|
| Appels emis | Actif (bleu) |
| Appels recus | Inactif |
| Fax emis | Inactif |
| Fax recus | Inactif |

### Selecteur periode
| Element | Description |
|---------|-------------|
| Type | Select dropdown |
| Icone | Calendrier |
| Format | Mois Annee |

### Cartes statistiques
| Carte | Contenu |
|-------|---------|
| Total appels | Nombre (ex: 127) |
| Duree totale | Format Xh XXmin |
| Cout total | XX,XX € |
| Hors forfait | XX,XX € (rouge) |

### Tableau historique
| Colonne | Description |
|---------|-------------|
| Date | DD/MM HH:MM |
| Numero appele | Format international |
| Destination | Type (Mobile France, Fixe, etc.) |
| Duree | MM:SS |
| Cout | X,XX € (rouge si hors forfait) |
| Type | Forfait / Hors forfait / Gratuit |

### Ligne tableau
| Etat | Style |
|------|-------|
| Normal | Cout 0,00€, type Forfait |
| Hors forfait | Cout rouge, type rouge |
| Gratuit | Cout 0,00€, type Gratuit |

### Pagination
| Element | Description |
|---------|-------------|
| Navigation | ← 1 2 3 → |
| Page active | Fond bleu |

---

## 4. APIS & DONNEES

### Endpoints
```
GET /telephony/{billingAccount}/line/{serviceName}/statistics/outgoing
GET /telephony/{billingAccount}/line/{serviceName}/statistics/incoming
GET /telephony/{billingAccount}/line/{serviceName}/fax/statistics
```

### Modele Call
```typescript
interface CallRecord {
  id: string;
  date: string;
  calledNumber: string;
  destination: string;
  duration: number;
  cost: number;
  type: 'included' | 'outOfPlan' | 'free';
}

interface ConsumptionSummary {
  totalCalls: number;
  totalDuration: number;
  totalCost: number;
  outOfPlanCost: number;
}
```

---

## 5. TRADUCTIONS (i18n)

```json
{
  "telephony_consumption_title": "Consommation",
  "telephony_consumption_back": "Retour vers la gestion de votre consommation",
  "telephony_consumption_tab_outgoing": "Appels emis",
  "telephony_consumption_tab_incoming": "Appels recus",
  "telephony_consumption_tab_fax_out": "Fax emis",
  "telephony_consumption_tab_fax_in": "Fax recus",
  "telephony_consumption_total_calls": "Total appels",
  "telephony_consumption_total_duration": "Duree totale",
  "telephony_consumption_total_cost": "Cout total",
  "telephony_consumption_out_of_plan": "Hors forfait",
  "telephony_consumption_col_date": "Date",
  "telephony_consumption_col_number": "Numero appele",
  "telephony_consumption_col_destination": "Destination",
  "telephony_consumption_col_duration": "Duree",
  "telephony_consumption_col_cost": "Cout",
  "telephony_consumption_col_type": "Type",
  "telephony_consumption_type_included": "Forfait",
  "telephony_consumption_type_out": "Hors forfait",
  "telephony_consumption_type_free": "Gratuit",
  "telephony_consumption_dest_mobile_fr": "Mobile France",
  "telephony_consumption_dest_fixed_fr": "Fixe France",
  "telephony_consumption_dest_international": "International",
  "telephony_consumption_dest_free": "Numero vert"
}
```

---

## 6. REGLES METIER

- Historique disponible sur 12 mois
- Durees en secondes converties en HH:MM:SS
- Couts affiches TTC
- Hors forfait = appels vers destinations non incluses
- Pagination par defaut: 10 lignes
