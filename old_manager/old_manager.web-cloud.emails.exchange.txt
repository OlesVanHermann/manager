# CAHIER DES CHARGES - Microsoft Exchange
# Source: old_manager_web-cloud_emails_exchange.tar
# Généré le: 2025-01-XX
# Navigation: Web & Cloud → Emails → Microsoft → Exchange

---

## 1. RÉSUMÉ EXÉCUTIF

### 1.1 Périmètre fonctionnel
- **Module**: Microsoft Exchange (Hosted, Dedicated, Provider)
- **Navigation**: Web & Cloud → Emails → Microsoft → Exchange
- **Cible**: Gestion complète des services Exchange OVHcloud
- **Utilisateurs**: Administrateurs, Techniciens, Contacts facturation

### 1.2 Fonctionnalités principales

| Fonctionnalité | Description |
|----------------|-------------|
| Dashboard | Vue d'ensemble du service Exchange avec diagnostics serveur |
| Comptes | CRUD comptes email, quotas, MFA, licences Outlook |
| Domaines | Association domaines, configuration DNS, DKIM, SPF |
| Groupes | Mailing lists, membres, managers, délégations |
| Contacts externes | Gestion des contacts hors Exchange |
| Comptes partagés | Boîtes partagées avec délégations (SendAs, FullAccess) |
| Ressources | Salles de réunion, équipements (calendrier) |
| Sécurité | Politique sécurité globale, MFA |
| Disclaimers | Signatures email par domaine |
| Dossiers publics | Folders partagés (Exchange 2010 uniquement) |
| Tâches | Suivi des opérations asynchrones |
| Logs | Journaux d'activité (beta) |

### 1.3 Types de services Exchange

| Type | Code | Description |
|------|------|-------------|
| Hosted Exchange | HOSTED | Exchange mutualisé |
| Private Exchange | DEDICATED | Exchange privé |
| Dedicated Exchange | DEDICATED_CLUSTER | Exchange cluster dédié |
| Exchange Revendeur | PROVIDER | Exchange pour revendeurs |

---

## 2. ARCHITECTURE

### 2.1 Structure des fichiers source

```
packages/manager/modules/exchange/src/
├── dashboard/                    # Vue principale (1.5M)
│   ├── exchange.controller.js
│   ├── exchange.html
│   ├── exchange.routes.js
│   ├── exchange.constants.js
│   ├── exchange.api.js
│   ├── exchange.password.service.js
│   └── translations/
├── account/                      # Gestion comptes (577K)
│   ├── account.controller.js
│   ├── account.service.js
│   ├── account.html
│   ├── add/
│   ├── alias/
│   ├── delegation/
│   ├── export-as-csv/
│   ├── export-as-pst/
│   ├── mfa/
│   ├── order/
│   ├── outlook/
│   ├── remove/
│   ├── update/
│   └── upgrade-300g/
├── domain/                       # Domaines (159K)
│   ├── domain.controller.js
│   ├── domain.service.js
│   ├── add/
│   ├── dkim-autoconfig/
│   ├── mx-autoconfig/
│   ├── remove/
│   └── update/
├── group/                        # Groupes/Mailing lists (130K)
│   ├── group.controller.js
│   ├── group.service.js
│   ├── add/
│   ├── accounts/
│   ├── alias/
│   ├── delegation/
│   ├── manager/
│   ├── member/
│   ├── remove/
│   └── update/
├── external-contact/             # Contacts externes
├── shared-account/               # Comptes partagés (138K)
│   ├── shared-account.controller.js
│   ├── shared-account.service.js
│   ├── add/
│   ├── alias/
│   ├── delegation/
│   ├── delete/
│   └── update/
├── resource/                     # Ressources calendrier (114K)
│   ├── resource.controller.js
│   ├── resource.service.js
│   ├── add/
│   ├── delegation/
│   ├── remove/
│   └── update/
├── security/                     # Paramètres sécurité (37K)
├── disclaimer/                   # Signatures email (49K)
├── shared/                       # Dossiers publics (119K)
├── task/                         # Tâches (19K)
├── diagnostic/                   # Diagnostics (46K)
├── billing/                      # Facturation (44K)
├── wizard-hosted-creation/       # Assistant création (184K)
├── services/                     # Services utilitaires
│   ├── exchange.formValidation.service.js
│   ├── exchange.messaging.service.js
│   ├── exchange.navigation.service.js
│   ├── exchange.selectedService.service.js
│   ├── exchange.serviceInfrastucture.service.js
│   ├── exchange.state.service.js
│   └── exchange.version.service.js
├── header/                       # En-tête + licence
└── order/                        # Commande
```

### 2.2 Dépendances principales

```javascript
// Layout helpers
import { ListLayoutHelper } from '@ovh-ux/manager-ng-layout-helpers';

// Services OVH
- wucExchange              // Service principal Exchange
- OvhApiEmailExchange      // API wrapper
- OvhHttp                  // Client HTTP
- iceberg                  // Pagination Iceberg

// UI Components (OVH UI Kit)
- oui-datagrid
- oui-spinner
- oui-header-tabs
- oui-action-menu
- oui-message
- oui-progress
- oui-button
- oui-modal
- oui-form-field
- oui-select
- oui-checkbox
- oui-badge
```

### 2.3 Services API (ovh-api-services)

```
ovh-api-services/src/api/email/exchange/
├── email-exchange.service.js
└── service/
    ├── email-exchange-service.service.js
    ├── email-exchange-service.v6.service.js      # APIv6
    ├── email-exchange-service.aapi.service.js    # 2API
    └── server/
        ├── email-exchange-service-server.service.js
        └── email-exchange-service-server.v6.service.js
```

---

## 3. PAGES & NAVIGATION

### 3.1 Routes principales

| Route | State | Composant | Description |
|-------|-------|-----------|-------------|
| `/exchange` | exchange.index | managerListLayout | Liste des services Exchange |
| `/exchange/order` | exchange.order | ExchangeOrderCtrl | Commander un Exchange |
| `/exchange/:organization/:productId` | exchange.dashboard | ExchangeCtrl | Dashboard principal |
| `.../information` | exchange.dashboard.information | - | Informations générales |
| `.../domain` | exchange.dashboard.domain | - | Domaines associés |
| `.../account` | exchange.dashboard.account | ExchangeAccountHomeController | Comptes email |
| `.../group` | exchange.dashboard.group | - | Groupes/Mailing lists |
| `.../external-contact` | exchange.dashboard.external-contact | - | Contacts externes |
| `.../shared-account` | exchange.dashboard.shared-account | - | Comptes partagés |
| `.../diagnostic` | exchange.dashboard.diagnostic | - | Diagnostic |
| `.../security` | exchange.dashboard.security | - | Sécurité |
| `.../resource` | exchange.dashboard.resource | - | Ressources |
| `.../disclaimer` | exchange.dashboard.disclaimer | - | Disclaimers |
| `.../shared` | exchange.dashboard.shared | - | Dossiers publics |
| `.../task` | exchange.dashboard.task | - | Tâches |
| `.../logs` | exchange.dashboard.logs | - | Logs (beta) |

### 3.2 Paramètres URL

```javascript
// Paramètres de route
{
  organization: string,  // Nom de l'organisation Exchange
  productId: string      // Identifiant du service Exchange
}
```

### 3.3 Navigation par onglets

```html
<oui-header-tabs>
    <oui-header-tabs-item href="informationLink">Informations générales</oui-header-tabs-item>
    <oui-header-tabs-item href="domainLink">Domaines associés</oui-header-tabs-item>
    <oui-header-tabs-item href="accountLink">Comptes e-mail</oui-header-tabs-item>
    <oui-header-tabs-item href="groupLink">Groupes</oui-header-tabs-item>
    <oui-header-tabs-item href="externalContactLink">Contacts externes</oui-header-tabs-item>
    <oui-header-tabs-item href="sharedAccountLink" ng-if="version > 2010">Comptes partagés</oui-header-tabs-item>
    <oui-header-tabs-item href="diagnosticLink">Diagnostic</oui-header-tabs-item>
    <oui-header-tabs-item href="securityLink">Sécurité</oui-header-tabs-item>
    <oui-header-tabs-dropdown text="Plus">
        <oui-header-tabs-item href="resourceLink">Ressources</oui-header-tabs-item>
        <oui-header-tabs-item href="disclaimerLink">Pied de page</oui-header-tabs-item>
        <oui-header-tabs-item href="sharedLink" ng-if="isDedicated && version2010">Dossiers partagés</oui-header-tabs-item>
        <oui-header-tabs-item href="taskLink">Tâches récentes</oui-header-tabs-item>
        <oui-header-tabs-item href="logsLink" ng-if="logsAvailable">Logs <span class="oui-badge_beta">Beta</span></oui-header-tabs-item>
    </oui-header-tabs-dropdown>
</oui-header-tabs>
```

### 3.4 Wizard de création (Hosted Exchange)

Affichage conditionnel si:
- `shouldOpenWizard === true`
- `hasNoDomain === true`

Étapes:
1. Configuration du domaine
2. Création du premier compte email
3. Configuration DNS (auto/manuel)
4. Finalisation

---

## 4. COMPOSANTS UI

### 4.1 Datagrid des comptes

```html
<oui-datagrid
    data-id="exchangeAccountHome"
    data-rows-loader="$ctrl.fetchAccounts($config)"
    data-customizable
    data-columns-parameters="$ctrl.getColumnParameters()"
    data-on-columns-parameters-change="$ctrl.onColumnsParametersChange(id, columns)"
>
    <!-- Colonnes -->
    <oui-datagrid-column
        data-title="'exchange_tab_ACCOUNTS_table_email'"
        data-property="emailAddress"
        data-type="string"
        data-searchable
        data-filterable
        data-sortable="asc"
        data-prevent-customization
    ></oui-datagrid-column>
    
    <oui-datagrid-column
        data-title="'exchange_tab_ACCOUNTS_table_type'"
        data-property="accountLicense"
        data-type="options"
        data-type-options="accountTypeColumnOptions"
        data-filterable
        data-sortable
    ></oui-datagrid-column>
    
    <oui-datagrid-column
        data-title="'exchange_tab_ACCOUNTS_table_company'"
        data-property="company"
        data-sortable
        data-filterable
    ></oui-datagrid-column>
    
    <oui-datagrid-column
        data-title="'exchange_tab_ACCOUNTS_table_size'"
        data-property="size"
    >
        <!-- Barre de progression quota -->
        <div class="oui-progress"
             ng-class="{
                 'oui-progress_success': usage < 51,
                 'oui-progress_warning': usage > 50 && usage < 81,
                 'oui-progress_error': usage > 80
             }">
            <div class="oui-progress__bar" style="width: {{usage}}%">
                <span>{{progressionText}}</span>
            </div>
        </div>
    </oui-datagrid-column>
    
    <oui-datagrid-column
        data-title="'exchange_tab_ACCOUNTS_table_alias'"
        data-property="numberOfAliases"
        data-sortable
    ></oui-datagrid-column>
    
    <oui-datagrid-column
        data-title="'exchange_tab_ACCOUNTS_table_outlook'"
        data-property="outlookStatus"
    ></oui-datagrid-column>
    
    <oui-datagrid-column
        data-title="'exchange_tab_ACCOUNTS_table_status'"
        data-property="status"
    ></oui-datagrid-column>
    
    <oui-datagrid-column
        data-title="'exchange_tab_ACCOUNTS_table_mfa'"
        data-property="mfa"
        data-hidden
    ></oui-datagrid-column>
    
    <!-- Menu actions -->
    <oui-action-menu data-compact data-placement="bottom-end">
        <oui-action-menu-item on-click="displayAccountUpdateView($row)">Modifier</oui-action-menu-item>
        <oui-action-menu-item on-click="displayAliasManagementView($row)">Gérer les alias</oui-action-menu-item>
        <oui-action-menu-item on-click="displayDialog('delegation', $row)">Délégations</oui-action-menu-item>
        <!-- MFA actions (si disponible) -->
        <oui-action-menu-item ng-if="mfa.status === 'NONE'">Activer MFA</oui-action-menu-item>
        <oui-action-menu-item ng-if="mfa.status === 'ENABLED'">Désactiver MFA</oui-action-menu-item>
        <oui-action-menu-item ng-if="mfa.status === 'ENABLED'">Réinitialiser MFA</oui-action-menu-item>
        <!-- Outlook -->
        <oui-action-menu-divider></oui-action-menu-divider>
        <oui-action-menu-item ng-if="canOrderOutlook">Commander Outlook</oui-action-menu-item>
        <oui-action-menu-item ng-if="canActivateOutlook">Activer Outlook</oui-action-menu-item>
        <!-- Suppression -->
        <oui-action-menu-divider></oui-action-menu-divider>
        <oui-action-menu-item ng-if="canReset">Réinitialiser</oui-action-menu-item>
        <oui-action-menu-item ng-if="canDelete">Supprimer</oui-action-menu-item>
    </oui-action-menu>
    
    <!-- Topbar -->
    <oui-datagrid-topbar>
        <oui-action-menu text="Actions">
            <oui-action-menu-item ng-if="canAdd" on-click="displayAccountAddingView()">
                Ajouter un compte
            </oui-action-menu-item>
            <oui-action-menu-item ng-if="canOrder" on-click="openAccountOrderingDialog()">
                Commander des comptes
            </oui-action-menu-item>
            <oui-action-menu-item on-click="exportCSV()">
                Exporter en CSV
            </oui-action-menu-item>
            <oui-action-menu-item ng-if="mfaAvailable">
                Activer MFA sur tous les comptes
            </oui-action-menu-item>
            <oui-action-menu-item href="OVH_MAIL_MIGRATOR_URL" external>
                Migrer des comptes
            </oui-action-menu-item>
        </oui-action-menu>
        <oui-button on-click="refreshList()">
            <span class="oui-icon oui-icon-refresh"></span>
        </oui-button>
    </oui-datagrid-topbar>
</oui-datagrid>
```

### 4.2 Messages et alertes

```html
<!-- Spinner de chargement -->
<div class="text-center" ng-if="ctrl.isLoading">
    <oui-spinner data-size="l"></oui-spinner>
</div>

<!-- Message d'erreur -->
<div class="oui-message oui-message_error" ng-if="ctrl.loadingExchangeError">
    <span class="oui-message_l-icon"></span>
    <h1 class="oui-message__title">Une erreur s'est produite lors du chargement</h1>
</div>

<!-- Message MFA désactivé -->
<oui-message ng-if="mfaAvailable && !owaMfa" data-type="info">
    <p>
        La double authentification est désactivée sur votre service Exchange.
        <a href="securityLink">Accéder aux paramètres de sécurité</a>
    </p>
</oui-message>

<!-- Alertes messaging -->
<div id="exchangeMessagingContainerId"
     class="alert alert-dismissible"
     ng-class="messaging.alertType"
     ng-if="messaging.message">
    <button class="close" data-dismiss="alert"></button>
    <span ng-bind-html="messaging.message"></span>
</div>
```

### 4.3 Modales

```html
<!-- Container modal générique -->
<div class="modal fade currentAction" id="currentAction" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content" id="modal-container" ng-include="navigation.stepPath"></div>
        <div class="help4wizards" id="modal-help"></div>
    </div>
</div>
```

---

## 5. APIs & DONNÉES

### 5.1 APIs 2API (AAPI) - Backend For Frontend

**Base URL**: `/sws/exchange/{organization}/{exchange}`

| Méthode | Endpoint | Description | Params |
|---------|----------|-------------|--------|
| GET | `/sws/exchange/{org}/{exchange}` | Détails complets du service | - |
| GET | `/sws/exchange/{org}/{exchange}/accounts` | Liste comptes avec pagination | count, offset, search |
| GET | `/sws/exchange/{org}/{exchange}/accounts/options` | Options création compte | - |
| GET | `/sws/exchange/{org}/{exchange}/accounts/contacts` | Contacts disponibles | - |
| GET | `/sws/exchange/{org}/{exchange}/accounts/{account}/rights` | Droits délégation compte | count, offset, search |
| PUT | `/sws/exchange/{org}/{exchange}/accounts/{account}/rights-update` | Mise à jour droits | sendRights, fullAccessRights, sendOnBehalfRights |
| GET | `/sws/exchange/{org}/{exchange}/accounts/renew` | Info renouvellement | - |
| GET | `/sws/exchange/{org}/{exchange}/domains` | Liste domaines | count, offset, search |
| GET | `/sws/exchange/{org}/{exchange}/domains/options` | Options ajout domaine | - |
| GET | `/sws/exchange/{org}/{exchange}/domains/{domain}/dnsSettings` | Configuration DNS actuelle | - |
| PUT | `/sws/exchange/{org}/{exchange}/domains/{domain}/dnsSettings-update` | Mise à jour DNS | data |
| GET | `/sws/exchange/{org}/{exchange}/groups` | Liste groupes | count, offset, search |
| GET | `/sws/exchange/{org}/{exchange}/groups/{group}/members` | Membres du groupe | count, offset, search |
| GET | `/sws/exchange/{org}/{exchange}/groups/{group}/managers` | Managers du groupe | count, offset, search |
| GET | `/sws/exchange/{org}/{exchange}/groups/{group}/rights` | Droits du groupe | count, offset |
| PUT | `/sws/exchange/{org}/{exchange}/groups/{group}/rights-update` | Mise à jour droits groupe | data |
| GET | `/sws/exchange/{org}/{exchange}/groups/{group}/accounts` | Comptes du groupe | count, offset |
| GET | `/sws/exchange/{org}/{exchange}/groups/{group}/alias` | Alias du groupe | - |
| POST | `/sws/exchange/{org}/{exchange}/groups-add` | Créer groupe | data |
| PUT | `/sws/exchange/{org}/{exchange}/groups/{group}/update` | Modifier groupe | data |
| GET | `/sws/exchange/{org}/{exchange}/sharedAccounts` | Liste comptes partagés | count, offset, search |
| GET | `/sws/exchange/{org}/{exchange}/sharedAccounts/{account}/delegations` | Délégations compte partagé | count, offset, search |
| PUT | `/sws/exchange/{org}/{exchange}/sharedAccounts/{account}/delegations-update` | Mise à jour délégations | sendRights, fullAccessRights, sendOnBehalfRights |
| GET | `/sws/exchange/{org}/{exchange}/resources` | Liste ressources | count, offset, search |
| GET | `/sws/exchange/{org}/{exchange}/resources/{resource}/rights` | Droits ressource | count, offset |
| PUT | `/sws/exchange/{org}/{exchange}/resources/{resource}/rights-update` | Mise à jour droits ressource | data |
| GET | `/sws/exchange/{org}/{exchange}/externalContacts` | Liste contacts externes | count, offset, search |
| GET | `/sws/exchange/{org}/{exchange}/disclaimers` | Liste disclaimers | - |
| GET | `/sws/exchange/{org}/{exchange}/disclaimers/new/options` | Options création disclaimer | - |
| GET | `/sws/exchange/{org}/{exchange}/publicFolders` | Liste dossiers publics | count, offset |
| GET | `/sws/exchange/{org}/{exchange}/publicFolders/options` | Options dossiers publics | - |
| GET | `/sws/exchange/{org}/{exchange}/publicFolders/{path}/accounts` | Comptes dossier public | count, offset |
| GET | `/sws/exchange/{org}/{exchange}/publicFolders/{path}/permissions` | Permissions dossier | - |
| PUT | `/sws/exchange/{org}/{exchange}/publicFolders/{path}/permissions-update` | Mise à jour permissions | data |
| GET | `/sws/exchange/{org}/{exchange}/aliasOptions` | Options alias disponibles | - |
| PUT | `/sws/exchange/{org}/{exchange}/deleteAtExpiration` | Configuration résiliation | renewType |
| GET | `/sws/exchange/{org}/{exchange}/{email}/license/options` | Options licence Outlook | - |

### 5.2 APIs v6 (apiv6) - API Standard OVH

**Base URL**: `/email/exchange/{organizationName}/service/{exchangeService}`

#### Service Exchange

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/email/exchange` | Liste des organisations |
| GET | `/email/exchange/{org}/service` | Liste des services (Iceberg) |
| GET | `/email/exchange/{org}/service/{exchange}` | Détails du service |
| PUT | `/email/exchange/{org}/service/{exchange}` | Modifier le service |
| GET | `/email/exchange/{org}/service/{exchange}/server` | Informations serveur Exchange |
| PUT | `/email/exchange/{org}/service/{exchange}/server` | Modifier serveur (owaMfa) |
| GET | `/email/exchange/{org}/service/{exchange}/dcvEmails` | Emails validation domaine |
| POST | `/email/exchange/{org}/service/{exchange}/renewSSL` | Renouveler certificat SSL |
| GET | `/email/exchange/{org}/service/{exchange}/log/kind` | Types de logs disponibles |

#### Comptes

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/email/exchange/{org}/service/{exchange}/account` | Liste IDs comptes |
| POST | `/email/exchange/{org}/service/{exchange}/account` | Créer un compte |
| GET | `/email/exchange/{org}/service/{exchange}/account/{email}` | Détails compte |
| PUT | `/email/exchange/{org}/service/{exchange}/account/{email}` | Modifier compte |
| DELETE | `/email/exchange/{org}/service/{exchange}/account/{email}` | Supprimer compte |
| POST | `/email/exchange/{org}/service/{exchange}/account/{email}/changePassword` | Changer mot de passe |
| GET | `/email/exchange/{org}/service/{exchange}/account/{email}/alias` | Liste alias |
| POST | `/email/exchange/{org}/service/{exchange}/account/{email}/alias` | Créer alias |
| DELETE | `/email/exchange/{org}/service/{exchange}/account/{email}/alias/{alias}` | Supprimer alias |
| GET | `/email/exchange/{org}/service/{exchange}/account/{email}/diagnostics` | Diagnostic compte |
| POST | `/email/exchange/{org}/service/{exchange}/account/{email}/diagnostics` | Lancer diagnostic |
| GET | `/email/exchange/{org}/service/{exchange}/account/{email}/tasks` | Tâches du compte |
| GET | `/email/exchange/{org}/service/{exchange}/account/{email}/tasks/{id}` | Détail tâche |

#### Domaines

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/email/exchange/{org}/service/{exchange}/domain` | Liste domaines |
| POST | `/email/exchange/{org}/service/{exchange}/domain` | Ajouter domaine |
| GET | `/email/exchange/{org}/service/{exchange}/domain/{domain}` | Détails domaine |
| PUT | `/email/exchange/{org}/service/{exchange}/domain/{domain}` | Modifier domaine |
| DELETE | `/email/exchange/{org}/service/{exchange}/domain/{domain}` | Supprimer domaine |
| GET | `/email/exchange/{org}/service/{exchange}/domain/{domain}/disclaimer` | Disclaimer du domaine |
| POST | `/email/exchange/{org}/service/{exchange}/domain/{domain}/disclaimer` | Créer disclaimer |
| PUT | `/email/exchange/{org}/service/{exchange}/domain/{domain}/disclaimer` | Modifier disclaimer |
| DELETE | `/email/exchange/{org}/service/{exchange}/domain/{domain}/disclaimer` | Supprimer disclaimer |
| GET | `/email/exchange/{org}/service/{exchange}/domain/{domain}/dkimSelector` | Sélecteurs DKIM |
| GET | `/email/exchange/{org}/service/{exchange}/domain/{domain}/dkim/{selector}` | Détail DKIM |
| POST | `/email/exchange/{org}/service/{exchange}/domain/{domain}/dkim` | Créer DKIM |
| POST | `/email/exchange/{org}/service/{exchange}/domain/{domain}/dkim/{selector}/enable` | Activer DKIM |
| POST | `/email/exchange/{org}/service/{exchange}/domain/{domain}/dkim/{selector}/disable` | Désactiver DKIM |

#### Mailing Lists (Groupes)

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/email/exchange/{org}/service/{exchange}/mailingList` | Liste mailing lists |
| GET | `/email/exchange/{org}/service/{exchange}/mailingList/{email}` | Détails mailing list |
| PUT | `/email/exchange/{org}/service/{exchange}/mailingList/{email}` | Modifier mailing list |
| DELETE | `/email/exchange/{org}/service/{exchange}/mailingList/{email}` | Supprimer mailing list |
| GET | `/email/exchange/{org}/service/{exchange}/mailingList/{email}/alias` | Alias mailing list |
| POST | `/email/exchange/{org}/service/{exchange}/mailingList/{email}/alias` | Créer alias |
| DELETE | `/email/exchange/{org}/service/{exchange}/mailingList/{email}/alias/{alias}` | Supprimer alias |
| GET | `/email/exchange/{org}/service/{exchange}/mailingList/{email}/manager/account` | Managers |
| DELETE | `/email/exchange/{org}/service/{exchange}/mailingList/{email}/manager/account/{id}` | Supprimer manager |
| GET | `/email/exchange/{org}/service/{exchange}/mailingList/{email}/member/account` | Membres (comptes) |
| GET | `/email/exchange/{org}/service/{exchange}/mailingList/{email}/member/contact` | Membres (contacts) |
| POST | `/email/exchange/{org}/service/{exchange}/mailingList/{email}/member` | Ajouter membre |

#### Contacts externes

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/email/exchange/{org}/service/{exchange}/externalContact` | Liste contacts |
| POST | `/email/exchange/{org}/service/{exchange}/externalContact` | Créer contact |
| GET | `/email/exchange/{org}/service/{exchange}/externalContact/{email}` | Détails contact |
| PUT | `/email/exchange/{org}/service/{exchange}/externalContact/{email}` | Modifier contact |
| DELETE | `/email/exchange/{org}/service/{exchange}/externalContact/{email}` | Supprimer contact |

#### Ressources

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/email/exchange/{org}/service/{exchange}/resourceAccount` | Liste ressources |
| POST | `/email/exchange/{org}/service/{exchange}/resourceAccount` | Créer ressource |
| GET | `/email/exchange/{org}/service/{exchange}/resourceAccount/{email}` | Détails ressource |
| PUT | `/email/exchange/{org}/service/{exchange}/resourceAccount/{email}` | Modifier ressource |
| DELETE | `/email/exchange/{org}/service/{exchange}/resourceAccount/{email}` | Supprimer ressource |

#### Comptes partagés

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/email/exchange/{org}/service/{exchange}/sharedAccount` | Liste comptes partagés |
| POST | `/email/exchange/{org}/service/{exchange}/sharedAccount` | Créer compte partagé |
| GET | `/email/exchange/{org}/service/{exchange}/sharedAccount/{email}` | Détails |
| PUT | `/email/exchange/{org}/service/{exchange}/sharedAccount/{email}` | Modifier |
| DELETE | `/email/exchange/{org}/service/{exchange}/sharedAccount/{email}` | Supprimer |
| GET | `/email/exchange/{org}/service/{exchange}/sharedAccountQuota` | Quota global |

#### Dossiers publics

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/email/exchange/{org}/service/{exchange}/publicFolder` | Liste dossiers |
| POST | `/email/exchange/{org}/service/{exchange}/publicFolder` | Créer dossier |
| GET | `/email/exchange/{org}/service/{exchange}/publicFolder/{path}` | Détails |
| PUT | `/email/exchange/{org}/service/{exchange}/publicFolder/{path}` | Modifier |
| DELETE | `/email/exchange/{org}/service/{exchange}/publicFolder/{path}` | Supprimer |
| DELETE | `/email/exchange/{org}/service/{exchange}/publicFolder/{path}/permission/{id}` | Supprimer permission |

### 5.3 APIs MS Services (MFA)

**Base URL**: `/msServices/{serviceName}`

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/msServices/{serviceName}` | Détails MS Services |
| GET | `/msServices/{serviceName}/sharepoint` | Sharepoint associé |
| POST | `/msServices/{serviceName}/account/{userPrincipalName}/mfa` | Créer MFA |
| DELETE | `/msServices/{serviceName}/account/{userPrincipalName}/mfa` | Supprimer MFA |
| POST | `/msServices/{serviceName}/account/{userPrincipalName}/mfa/enable` | Activer MFA |
| POST | `/msServices/{serviceName}/account/{userPrincipalName}/mfa/disable` | Désactiver MFA (période) |
| POST | `/msServices/{serviceName}/account/{userPrincipalName}/mfa/reset` | Réinitialiser MFA |
| POST | `/msServices/{serviceName}/createMfaOnAllUsers` | Activer MFA global |
| DELETE | `/msServices/{serviceName}/removeMfaOnAllUsers` | Supprimer MFA global |

### 5.4 APIs Order (Commandes)

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/order/email/exchange/{org}/service/{exchange}/diskSpace` | Prix espace disque |
| POST | `/order/email/exchange/{org}/service/{exchange}/diskSpace` | Commander espace |
| GET | `/order/email/exchange/{org}/service/{exchange}/accountUpgrade/{duration}` | Prix upgrade 300GB |
| POST | `/order/email/exchange/{org}/service/{exchange}/accountUpgrade/{duration}` | Commander upgrade |
| GET | `/order/email/exchange/{org}/service/{exchange}/upgrade` | Infos upgrade service |
| POST | `/order/email/exchange/{org}/service/{exchange}/upgrade` | Commander upgrade |

### 5.5 APIs Engine (v2)

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/engine/api/v2/zimbra/platform` | Liste plateformes Zimbra |
| GET | `/engine/api/v2/zimbra/platform/{id}/domain` | Domaines Zimbra (vérification) |

### 5.6 Séquencement des appels API

#### Chargement initial du dashboard
```javascript
// 1. Liste des services (page index)
GET /exchanges (2API) → Retourne liste des services

// 2. Détails du service sélectionné
GET /sws/exchange/{org}/{exchange} (2API) → Détails complets

// 3. En parallèle (Promise.all)
GET /email/exchange/{org}/service/{exchange}/server (v6) → Infos serveur
GET /sws/exchange/{org}/{exchange}/domains (2API) → Domaines
GET /sws/exchange/{org}/{exchange}/accounts (2API) → Comptes
```

#### Création d'un compte
```javascript
// 1. Récupérer les options
GET /sws/exchange/{org}/{exchange}/accounts/options (2API)

// 2. Créer le compte
POST /email/exchange/{org}/service/{exchange}/account (v6)
Body: { login, password, displayName, firstName, lastName, domain, ... }

// 3. Rafraîchir les caches
resetAccounts()
resetTasks()
```

#### Ajout d'un domaine
```javascript
// 1. Récupérer les options
GET /sws/exchange/{org}/{exchange}/domains/options (2API)

// 2. Vérifier si domaine existe chez OVH
GET /domain (v6)

// 3. Vérifier MXPlan existant
GET /email/domain/{domain} (v6)

// 4. Vérifier Zimbra
GET /engine/api/v2/zimbra/platform (v2)
GET /engine/api/v2/zimbra/platform/{id}/domain (v2)

// 5. Ajouter le domaine
POST /email/exchange/{org}/service/{exchange}/domain (v6)
Body: { name, type, configureMx, configureAutodiscover, mxRelay }

// 6. Rafraîchir
resetDomains()
resetAccounts()
resetTasks()
```

### 5.7 Types de données

#### Exchange Service
```typescript
interface ExchangeService {
  domain: string;
  displayName: string;
  organization: string;
  offer: 'hosted' | 'dedicated' | 'dedicatedCluster' | 'provider';
  maxReceiveSize: number;
  maxSendSize: number;
  spamAndVirusConfiguration: SpamVirusConfig;
  sslExpirationDate: string;
  webUrl: string;
  hostname: string;
  state: ServiceState;
  taskPendingId?: number;
  nicType: ('ADMIN' | 'TECH' | 'BILLING')[];
}
```

#### Account
```typescript
interface ExchangeAccount {
  primaryEmailAddress: string;
  primaryEmailDisplayName: string;
  displayName: string;
  firstName: string;
  lastName: string;
  login: string;
  domain: string;
  accountLicense: 'BASIC' | 'STANDARD' | 'ENTERPRISE';
  state: AccountState;
  taskPendingId?: number;
  currentUsage: number;
  quota: number;
  usedQuota: { value: number; unit: string };
  totalQuota: { value: number; unit: string };
  aliases: number;
  company?: string;
  spamDetected: boolean;
  spamTicketNumber?: number;
  outlookLicense: boolean;
  outlookStatus?: string;
  mfa: {
    status: 'NONE' | 'ENABLED' | 'DISABLED';
  };
}
```

#### Domain
```typescript
interface ExchangeDomain {
  name: string;
  displayName: string;
  state: DomainState;
  type: 'authoritative' | 'nonAuthoritative';
  mxIsValid: boolean;
  srvIsValid: boolean;
  cnameToCheck?: string;
  expectedMX: MXRecord[];
  expectedSRV: SRVRecord[];
  expectedSPF: string;
}
```

#### Group (Mailing List)
```typescript
interface ExchangeGroup {
  mailingListAddress: string;
  displayName: string;
  hiddenFromGAL: boolean;
  joinRestriction: 'open' | 'closed' | 'approvalRequired';
  departRestriction: 'open' | 'closed' | 'approvalRequired';
  senderAuthentication: boolean;
  state: GroupState;
  memberCount: number;
  managerCount: number;
}
```

#### Resource
```typescript
interface ExchangeResource {
  resourceEmailAddress: string;
  displayName: string;
  type: 'room' | 'equipment';
  capacity: number;
  location?: string;
  allowConflict: boolean;
  bookingWindow: number;
  deleteComments: boolean;
  deleteSubject: boolean;
  maximumDuration: number;
  state: ResourceState;
}
```

#### Shared Account
```typescript
interface ExchangeSharedAccount {
  sharedEmailAddress: string;
  displayName: string;
  firstName?: string;
  lastName?: string;
  quota: { value: number; unit: string };
  currentUsage: number;
  hiddenFromGAL: boolean;
  state: SharedAccountState;
}
```

---

## 6. RÈGLES MÉTIER

### 6.1 Types d'infrastructure Exchange

```javascript
// Détermine les fonctionnalités disponibles
const exchangeServiceInfrastructure = {
  isDedicated: () => offer === 'dedicated',
  isDedicatedCluster: () => offer === 'dedicatedCluster', 
  isHosted: () => offer === 'hosted',
  isProvider: () => offer === 'provider'
};
```

### 6.2 Méthodes de création/suppression de compte

```javascript
// Création de compte
CAN_DO.CREATION_METHOD = {
  // Ajout direct (sans commande)
  ADDING: () => 
    isDedicated() || 
    isDedicatedCluster() || 
    (isProvider() && version === 2010),
  
  // Commande requise
  ORDERING: () => 
    isHosted() || 
    (isProvider() && version !== 2010)
};

// Suppression de compte
CAN_DO.DESTRUCTION_METHOD = {
  // Suppression définitive
  DELETING: () => 
    isDedicated() || 
    isDedicatedCluster() || 
    (isProvider() && version === 2010),
  
  // Réinitialisation (compte placeholder)
  RESETTING: () => 
    isHosted() || 
    (isProvider() && version !== 2010)
};

// Upgrade vers 300 GB
CAN_DO.UPGRADE_TO_300_GB = () => 
  isHosted() || 
  (isProvider() && version > 2010);
```

### 6.3 États des entités

```javascript
// États des comptes/services
const STATES = {
  CREATING: 'CREATING',       // En cours de création
  DELETING: 'DELETING',       // En cours de suppression
  REOPENING: 'REOPENING',     // Réouverture en cours
  SUSPENDED: 'SUSPENDED',     // Suspendu
  SUSPENDING: 'SUSPENDING',   // Suspension en cours
  OK: 'OK',                   // Opérationnel
  TASK_ON_DOING: 'TASK_ON_DOING'  // Tâche en cours
};

// Vérifications d'état
const exchangeStates = {
  isOk: (entity) => entity.state === 'OK',
  isDoing: (entity) => entity.taskPendingId > 0,
  isDeleting: (entity) => entity.state === 'DELETING',
  isInError: (entity) => entity.state === 'ERROR'
};
```

### 6.4 Double authentification (MFA)

```javascript
// Disponibilité MFA
const isMfaAvailable = () => 
  coreConfig.isRegion('EU') && 
  exchangeSelectedService.isMfaAvailable();

// États MFA
const MFA_STATUS = {
  NONE: 'NONE',         // Non configuré
  ENABLED: 'ENABLED',   // Activé
  DISABLED: 'DISABLED'  // Désactivé temporairement
};

// Actions MFA par état
const MFA_ACTIONS = {
  NONE: ['CREATE'],
  ENABLED: ['DISABLE', 'RESET', 'DELETE'],
  DISABLED: ['ENABLE', 'DELETE']
};

// Paramètre de désactivation temporaire
const disableMfa = (period) => {
  // period: nombre d'heures de désactivation
};
```

### 6.5 Licences Outlook

```javascript
const exchangeAccountOutlook = {
  STATES: {
    TO_ORDER: 'TO_ORDER',                           // À commander
    TO_ACTIVATE: 'TO_ACTIVATE',                     // À activer
    ALREADY_ORDERED: 'ALREADY_ORDERED',             // Commandé
    ALREADY_ACTIVATED: 'ALREADY_ACTIVATED',         // Activé
    CANT_ORDER_OR_ACTIVATE_LICENSE: 'CANT_ORDER_OR_ACTIVATE_LICENSE'
  },
  
  // Vérifier si le compte peut avoir Outlook
  canHaveLicense: (account) => {
    return account.accountLicense !== 'BASIC' && 
           !isPlaceholder(account);
  },
  
  // Obtenir le statut Outlook
  getStatus: (account) => {
    if (account.outlookLicense) return 'ALREADY_ACTIVATED';
    if (account.outlookStatus === 'ordered') return 'ALREADY_ORDERED';
    // ...
  }
};
```

### 6.6 Quotas et limites

```javascript
// Quotas comptes partagés
const sharedAccountQuota = {
  minQuota: { value: 100, unit: 'MiB' },
  maxQuota: { value: singleMailboxQuotaLimit, unit: 'MiB' },
  reservedQuota: { value: quotaReserved, unit: 'MiB' },
  totalQuota: { value: quotaLimit, unit: 'MiB' }
};

// Limite alias
const ALIAS_MAX_LIMIT = 1000;

// Seuils visuels quota (barre de progression)
const QUOTA_THRESHOLDS = {
  SUCCESS: 50,    // < 51% = vert
  WARNING: 80,    // 51-80% = orange
  ERROR: 80       // > 80% = rouge
};
```

### 6.7 Validation des formulaires

```javascript
// Validation email
const isEmailValid = (email) => {
  const regex = /^[\w!#$%&'*+/=?^`{|}~-]+(?:\.[\w!#$%&'*+/=?^`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9]{2}(?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/;
  return email && regex.test(email);
};

// Compte placeholder (à configurer)
const PLACEHOLDER_DOMAIN_NAME = 'configureme.me';
const isPlaceholder = (account) => 
  account.domain.toUpperCase() === PLACEHOLDER_DOMAIN_NAME.toUpperCase();
```

### 6.8 Configuration DNS

```javascript
// Records MX par région
const EXCHANGE_MX_CONFIG = {
  EU: {
    spam: [
      { fieldType: 'MX', target: 'mx0.mail.ovh.net.', priority: 1 },
      { fieldType: 'MX', target: 'mx1.mail.ovh.net.', priority: 5 },
      { fieldType: 'MX', target: 'mx2.mail.ovh.net.', priority: 50 },
      { fieldType: 'MX', target: 'mx3.mail.ovh.net.', priority: 100 }
    ]
  },
  CA: {
    spam: [
      { fieldType: 'MX', target: 'mx1.mail.ovh.ca.', priority: 1 },
      { fieldType: 'MX', target: 'mx2.mail.ovh.ca.', priority: 5 },
      { fieldType: 'MX', target: 'mx3.mail.ovh.ca.', priority: 50 },
      { fieldType: 'MX', target: 'mx4.mail.ovh.ca.', priority: 100 }
    ]
  }
};
```

### 6.9 Types de domaine

```javascript
const DOMAIN_TYPES = {
  AUTHORITATIVE: 'authoritative',       // Uniquement Exchange
  NON_AUTHORITATIVE: 'nonAuthoritative' // Exchange + autre serveur (mxRelay)
};
```

---

## 7. TRADUCTIONS

### 7.1 Clés principales (FR)

```json
{
  "exchange_title": "Microsoft Exchange",
  "exchange_order": "Commander",
  
  "exchange_tab_INFORMATION": "Informations générales",
  "exchange_tab_DOMAIN": "Domaines associés",
  "exchange_tab_ACCOUNT": "Comptes e-mail",
  "exchange_tab_GROUP": "Groupes",
  "exchange_tab_EXTERNAL_CONTACT": "Contacts externes",
  "exchange_tab_SHARED_ACCOUNT": "Comptes partagés",
  "exchange_tab_DIAGNOSTIC": "Diagnostic",
  "exchange_tab_SECURITY": "Sécurité",
  "exchange_tab_RESOURCES": "Ressources",
  "exchange_tab_DISCLAIMER": "Pied de page",
  "exchange_tab_SHARED": "Dossiers partagés",
  "exchange_tab_TASKS": "Tâches récentes",
  "exchange_tab_LOGS": "Journaux",
  
  "exchange_offer_type_DEDICATED_CLUSTER": "Dedicated Exchange",
  "exchange_offer_type_DEDICATED": "Private Exchange",
  "exchange_offer_type_HOSTED": "Hosted Exchange",
  "exchange_offer_type_PROVIDER": "Exchange revendeur",
  
  "exchange_tab_ACCOUNTS_table_email": "Adresse e-mail",
  "exchange_tab_ACCOUNTS_table_type": "Type de compte",
  "exchange_tab_ACCOUNTS_table_company": "Société",
  "exchange_tab_ACCOUNTS_table_size": "Taille",
  "exchange_tab_ACCOUNTS_table_alias": "Alias",
  "exchange_tab_ACCOUNTS_table_outlook": "Outlook",
  "exchange_tab_ACCOUNTS_table_status": "Statut",
  "exchange_tab_ACCOUNTS_table_mfa": "Double authentification",
  
  "exchange_tab_ACCOUNTS_menu_edit": "Modifier",
  "exchange_tab_ACCOUNTS_menu_alias": "Gérer les alias",
  "exchange_tab_ACCOUNTS_menu_delegations": "Délégations",
  "exchange_tab_ACCOUNTS_menu_reset": "Réinitialiser",
  "exchange_tab_ACCOUNTS_menu_delete": "Supprimer",
  "exchange_tab_ACCOUNTS_menu_outlook_order": "Commander une licence Outlook",
  "exchange_tab_ACCOUNTS_menu_outlook_activate": "Activer la licence Outlook",
  "exchange_tab_ACCOUNTS_menu_migrate": "Migrer des comptes",
  
  "exchange_tab_ACCOUNTS_state_OK": "Actif",
  "exchange_tab_ACCOUNTS_state_CREATING": "Création en cours",
  "exchange_tab_ACCOUNTS_state_DELETING": "Suppression en cours",
  "exchange_tab_ACCOUNTS_state_RESETTING": "Réinitialisation en cours",
  "exchange_tab_ACCOUNTS_state_BLOCKED": "Bloqué (spam)",
  "exchange_tab_ACCOUNTS_state_TO_CONFIGURE": "À configurer",
  "exchange_tab_ACCOUNTS_state_TASK_ON_DOING": "Opération en cours",
  
  "exchange_ACTION_add_account_button": "Ajouter un compte",
  "exchange_ACTION_order_accounts_button": "Commander des comptes",
  "exchange_ACTION_export_accounts_button": "Exporter les comptes en CSV",
  
  "exchange_mfa_description_ENABLE": "Êtes-vous sûr de vouloir activer la double authentification pour le compte <strong>{{account}}</strong> ?",
  "exchange_mfa_description_DELETE": "Êtes-vous sûr de vouloir supprimer la double authentification pour le compte <strong>{{account}}</strong> ?",
  "exchange_mfa_description_DISABLE": "Êtes-vous sûr de vouloir désactiver la double authentification pour le compte <strong>{{account}}</strong> ?",
  "exchange_mfa_description_RESET": "Êtes-vous sûr de vouloir réinitialiser la double authentification pour le compte <strong>{{account}}</strong> ?",
  
  "exchange_dashboard_name": "Référence serveur",
  "exchange_dashboard_hostname": "Adresse serveur",
  "exchange_dashboard_renew": "Renouvellement du service",
  "exchange_dashboard_domains": "Domaines associés",
  "exchange_dashboard_accounts": "Comptes Exchange",
  "exchange_dashboard_tasks": "Tâches récentes",
  "exchange_dashboard_diag": "Diagnostic serveur",
  "exchange_dashboard_ssl_expiration": "Expiration SSL"
}
```

### 7.2 Messages d'erreur

```json
{
  "exchange_dashboard_loading_error": "Une erreur s'est produite lors du chargement des informations.",
  "exchange_accounts_fetchAccounts_error": "Erreur lors de la récupération des comptes.",
  "exchange_accounts_fetchAccountCreationOptions_error": "Erreur lors de la récupération des options de création.",
  "exchange_enable_mfa_error": "Une erreur est survenue lors de l'activation de la double authentification : {{error}}",
  "exchange_disable_mfa_error": "Une erreur est survenue lors de la désactivation de la double authentification : {{error}}",
  "exchange_reset_mfa_error": "Une erreur est survenue lors de la réinitialisation de la double authentification : {{error}}",
  "exchange_delete_mfa_error": "Une erreur est survenue lors de la suppression de la double authentification : {{error}}"
}
```

### 7.3 Messages de succès

```json
{
  "exchange_enable_mfa_success": "La double authentification a été activée avec succès.",
  "exchange_disable_mfa_success": "La double authentification a été désactivée avec succès.",
  "exchange_reset_mfa_success": "La double authentification a été réinitialisée avec succès.",
  "exchange_delete_mfa_success": "La double authentification a été supprimée avec succès."
}
```

---

## 8. CONSTANTES ET CONFIGURATION

### 8.1 URLs externes

```javascript
const OVH_MAIL_MIGRATOR_URL = 'https://omm.ovh.net/';

const TICKET_SUPPORT_URL = 'https://www.ovh.com/manager/dedicated/index.html#/support/tickets';
const TICKET_SUPPORT_PROPS_WITH_TICKET = '?filters={"ticketNumber":"';
const TICKET_SUPPORT_PROPS_WITHOUT_TICKET = '/new';

const DOMAIN_ORDER_URL = {
  FR: 'https://www.ovh.com/fr/order/webcloud/',
  GB: 'https://www.ovh.co.uk/order/webcloud',
  // ...
};

const EXCHANGE_CONFIG = {
  URLS: {
    GUIDES: {
      BACKUP: {
        FR: 'https://help.ovhcloud.com/csm/fr-exchange-veeam-backup',
        // ...
      },
      DIAGNOSTIC: {
        FR: 'https://www.ovh.com/fr/g2277.diagnostic_exchange',
        // ...
      }
    },
    OFFICE_365_ORDER: {
      FR: 'https://ovhcloud.com/fr/collaborative-tools/microsoft-365/',
      // ...
    }
  }
};
```

### 8.2 Préférences utilisateur

```javascript
const DATAGRID_COLUMN_PARAMETERS_PREFERENCE_NAME = 'EXCHANGE_ACCOUNT_DATAGRID_COLUMNS';
const WIZARD_HOSTED_CREATION_OPENING_PREFERENCE = 'WIZARD_HOSTED_CREATION_OPENING_PREFERENCE';
```

### 8.3 Container messaging

```javascript
const EXCHANGE_CONTAINER_MESSAGING = 'exchangeMessagingContainerId';
```

---

## 9. ÉVÉNEMENTS ET CACHE

### 9.1 Événements broadcast

```javascript
const events = {
  domainsChanged: 'exchange.domains.changed',
  accountsChanged: 'exchange.accounts.changed',
  sharedAccountsChanged: 'exchange.sharedAccounts.changed',
  tasksChanged: 'exchange.tasks.changed',
  delegationRightsChanged: 'exchange.delegationRights.changed',
  resourcesChanged: 'exchange.resources.changed',
  groupsChanged: 'exchange.groups.changed',
  disclaimersChanged: 'exchange.disclaimers.changed',
  externalcontactsChanged: 'exchange.tabs.externalcontacts.changed',
  publicFoldersChanged: 'exchange.tabs.publicFolders.changed',
  sslRenewAsked: 'exchange.sslRenew.asked'
};
```

### 9.2 Caches

```javascript
const caches = {
  tasksCache: 'UNIVERS_WEB_EXCHANGE_TASKS',
  delegationRightsCache: 'UNIVERS_WEB_EXCHANGE_DELEGATION_RIGHTS',
  disclaimersCache: 'UNIVERS_WEB_EXCHANGE_DISCLAIMERS',
  exchangeCache: 'UNIVERS_WEB_EXCHANGE',
  domainsCache: 'UNIVERS_WEB_EXCHANGE_DOMAINS',
  accountsCache: 'UNIVERS_WEB_EXCHANGE_ACCOUNTS',
  sharedAccountsCache: 'UNIVERS_WEB_EXCHANGE_SHARED_ACCOUNTS',
  resourcesCache: 'UNIVERS_WEB_EXCHANGE_RESOURCES',
  groupsCache: 'UNIVERS_WEB_EXCHANGE_GROUPS',
  publicFolderCache: 'UNIVERS_WEB_EXCHANGE_PUBLIC_FOLDERS'
};
```

---

## 10. NOTES DE MIGRATION

### 10.1 Patterns à moderniser

| AngularJS | React |
|-----------|-------|
| `$scope`, `$rootScope.$broadcast` | Context API / Zustand |
| `/* @ngInject */` | Hooks React |
| `OvhHttp.get()` | React Query `useQuery` |
| `OvhHttp.post()` | React Query `useMutation` |
| `$cacheFactory` | React Query cache |
| Templates `.html` | JSX / TSX |
| `ng-if`, `ng-repeat` | Conditional rendering, `.map()` |
| `oui-datagrid` | `@ovhcloud/ods-components` Datagrid |
| `$translate` | `react-i18next` |

### 10.2 Composants ODS équivalents

| OUI (AngularJS) | ODS (React) |
|-----------------|-------------|
| `oui-datagrid` | `OdsDatagrid` |
| `oui-spinner` | `OdsSpinner` |
| `oui-button` | `OdsButton` |
| `oui-message` | `OdsMessage` |
| `oui-modal` | `OdsModal` |
| `oui-select` | `OdsSelect` |
| `oui-checkbox` | `OdsCheckbox` |
| `oui-action-menu` | `OdsPopover` + custom |
| `oui-header-tabs` | `OdsTabs` |
| `oui-progress` | `OdsProgressBar` |

### 10.3 Structure React recommandée

```
src/pages/exchange/
├── Exchange.page.tsx           # Route principale
├── ExchangeList.page.tsx       # Liste des services
├── dashboard/
│   ├── Dashboard.page.tsx
│   ├── components/
│   │   ├── ExchangeHeader.tsx
│   │   ├── ExchangeTabs.tsx
│   │   └── MessagingContainer.tsx
│   └── hooks/
│       └── useExchange.ts
├── account/
│   ├── Account.page.tsx
│   ├── components/
│   │   ├── AccountDatagrid.tsx
│   │   ├── AccountActions.tsx
│   │   └── AccountModals/
│   ├── hooks/
│   │   ├── useAccounts.ts
│   │   └── useMfa.ts
│   └── api/
│       └── account.api.ts
├── domain/
├── group/
├── shared-account/
├── resource/
├── security/
├── disclaimer/
└── hooks/
    ├── useExchangeService.ts
    └── useExchangeInfrastructure.ts
```

---

## 11. CHECKLIST DE DÉVELOPPEMENT

### 11.1 Fonctionnalités critiques

- [ ] Liste des services Exchange avec pagination Iceberg
- [ ] Dashboard avec diagnostics serveur
- [ ] CRUD comptes avec tous les états
- [ ] Gestion MFA (région EU uniquement)
- [ ] Gestion domaines + configuration DNS automatique
- [ ] Groupes avec membres/managers
- [ ] Comptes partagés avec délégations
- [ ] Ressources calendrier
- [ ] Export CSV des comptes
- [ ] Wizard de création Hosted Exchange

### 11.2 Intégrations

- [ ] API 2API (AAPI) pour les listes paginées
- [ ] API v6 pour les opérations CRUD
- [ ] API MS Services pour MFA
- [ ] API Order pour commandes
- [ ] Gestion des tâches asynchrones
- [ ] Rafraîchissement automatique après mutations

### 11.3 UX/UI

- [ ] Datagrid avec colonnes personnalisables
- [ ] Filtres et recherche
- [ ] Tri multi-colonnes
- [ ] Barres de progression pour les quotas
- [ ] Messages de succès/erreur
- [ ] Modales de confirmation
- [ ] États de chargement
- [ ] Gestion des erreurs 401 (redirection auth)

---

# FIN DU CAHIER DES CHARGES
