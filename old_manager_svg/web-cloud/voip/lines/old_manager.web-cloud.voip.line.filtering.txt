# Cahier des Charges : web-cloud/voip/line - Filtering

## 1. VUE D'ENSEMBLE

**Type:** Page formulaire avec datagrid
**Fonction:** Configurer le filtrage des appels (liste noire/blanche)
**Contexte:** Gestion des appels de la ligne VoIP

## 2. NAVIGATION

### Retour
‹ Gestion des appels

## 3. HEADER

- Titre: "Filtrage des appels"

## 4. SECTION ACTIVATION (700x320px)

### Titre
"Activer le filtrage"

### Description
"Configurez le filtrage des appels entrants et sortants."

### Sélecteurs direction

#### Appels entrants
- Label: "Appels entrants"
- Select: 300x40px
- Valeur: "Liste noire"
- Options: Désactivé, Liste noire, Liste blanche

#### Appels sortants
- Label: "Appels sortants"
- Select: 300x40px
- Valeur: "Désactivé"
- Options: Désactivé, Liste noire, Liste blanche

### Checkboxes options

| Option | État | Description |
|--------|------|-------------|
| Rejeter les appels anonymes | ☑ Coché | Bloquer les numéros masqués |
| Ne pas déranger | ☐ Non coché | Rejeter tous les appels |
| Absent / Indisponible | ☐ Non coché | Signaler indisponibilité |

### Lien bulk
"Appliquer à plusieurs lignes" (text-link)

## 5. SECTION AJOUT FILTRE (700x120px)

### Titre
"Ajouter un filtre"

### Formulaire inline
- Input numéro: 250x40px, placeholder "Numéro ou plage..."
- Select type: 150x40px, valeur "Liste noire"
- Bouton: "Ajouter" (btn-primary, 100x40px)

## 6. DATAGRID FILTRES (1200x200px)

### Titre
"Configuration du filtrage"

### Colonnes

| Colonne | Largeur | Contenu |
|---------|---------|---------|
| Numéro / Plage | 350px | Numéro ou pattern |
| Type de liste | 250px | Liste noire/blanche |
| Direction | 250px | Entrant/Sortant |
| Actions | 200px | Menu ... |

### Exemples données

| Numéro / Plage | Type | Direction |
|----------------|------|-----------|
| 0033 6 12 34 56 78 | Liste noire | Entrant |
| 0033 1 XX XX XX XX | Liste blanche | Entrant |

### Menu actions
- "Modifier"
- "Supprimer" (text-danger)

## 7. TYPES DE FILTRAGE

| Type | Code | Description |
|------|------|-------------|
| Désactivé | disabled | Pas de filtrage |
| Liste noire | blacklist | Bloquer les numéros listés |
| Liste blanche | whitelist | Autoriser uniquement les numéros listés |

## 8. APIS & ENDPOINTS

```
# Configuration filtrage
GET /telephony/{billingAccount}/line/{serviceName}/options
→ incomingFilter, outgoingFilter, rejectAnonymous, doNotDisturb, unavailable

PUT /telephony/{billingAccount}/line/{serviceName}/options
Body: {
  incomingFilter: "blacklist",
  outgoingFilter: "disabled",
  rejectAnonymous: true,
  doNotDisturb: false,
  unavailable: false
}

# Lister les filtres
GET /telephony/{billingAccount}/line/{serviceName}/filtering
→ Liste des règles de filtrage

# Ajouter un filtre
POST /telephony/{billingAccount}/line/{serviceName}/filtering
Body: {
  number: "0033612345678",
  type: "blacklist",
  direction: "incoming"
}

# Modifier un filtre
PUT /telephony/{billingAccount}/line/{serviceName}/filtering/{id}

# Supprimer un filtre
DELETE /telephony/{billingAccount}/line/{serviceName}/filtering/{id}

# Appliquer à plusieurs lignes
POST /telephony/{billingAccount}/line/batchFiltering
Body: {
  serviceNames: ["line1", "line2"],
  incomingFilter: "blacklist"
}
```

## 9. TRADUCTIONS (i18n)

| Clé | FR |
|-----|-----|
| page_title | Filtrage des appels |
| back_link | Gestion des appels |
| section_enable | Activer le filtrage |
| section_enable_desc | Configurez le filtrage des appels entrants et sortants. |
| field_incoming | Appels entrants |
| field_outgoing | Appels sortants |
| filter_disabled | Désactivé |
| filter_blacklist | Liste noire |
| filter_whitelist | Liste blanche |
| checkbox_reject_anonymous | Rejeter les appels anonymes |
| checkbox_dnd | Ne pas déranger |
| checkbox_unavailable | Absent / Indisponible |
| link_bulk | Appliquer à plusieurs lignes |
| section_add | Ajouter un filtre |
| placeholder_number | Numéro ou plage... |
| btn_add | Ajouter |
| section_config | Configuration du filtrage |
| col_number | Numéro / Plage |
| col_type | Type de liste |
| col_direction | Direction |
| col_actions | Actions |
| direction_incoming | Entrant |
| direction_outgoing | Sortant |
| action_edit | Modifier |
| action_delete | Supprimer |
