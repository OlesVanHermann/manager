# old_manager.web-cloud.freefax.fax-config-edit.txt
# Cahier des charges - Configuration Fax (mode édition)
# Généré depuis : old_manager_web-cloud_telecom_fax.tar

---

## 1. RÉSUMÉ EXÉCUTIF

### Périmètre
Formulaire d'édition de la configuration d'un service FreeFax.

### Objectif fonctionnel
Permettre la modification des paramètres d'envoi de fax : expéditeur, qualité, tentatives, entête.

### Utilisateurs cibles
Clients OVHcloud disposant d'un service FreeFax actif.

---

## 2. ARCHITECTURE

### Fichiers sources
```
packages/manager/modules/freefax/src/freefax/faxConfiguration/
├── freefax-faxConfiguration.html        # Template
├── freefax-faxConfiguration.controller.js  # Controller
├── index.js                             # Module
```

### Dépendances
- OvhApiFreeFax : Service API
- TucToastError : Gestion erreurs
- tucValidator : Validation email

---

## 3. PAGES & NAVIGATION

### Intégration
Composant intégré dans la page dashboard FreeFax, affiché dans un oui-tile.

### Modes
| Mode | Affichage |
|------|-----------|
| Lecture | Liste des valeurs actuelles + bouton "Éditer" |
| Édition | Formulaire avec champs modifiables |

---

## 4. COMPOSANTS UI

### Tile Configuration Fax
```html
<div class="oui-tile mb-5">
    <h3 class="oui-tile__title oui-heading_3"
        data-translate="freefax_fax_configuration"></h3>
    <!-- Contenu dynamique selon editMode -->
</div>
```

### Mode Lecture

| Champ | Label | Binding |
|-------|-------|---------|
| Expéditeur | freefax_expeditor | freeFax.fromName |
| Mail expéditeur | freefax_expeditor_mail | freeFax.fromEmail |
| Qualité | freefax_quality | freeFax.faxQuality (traduit) |
| Tentatives max | freefax_max_try | freeFax.faxMaxCall |
| Entête | freefax_header | freeFax.faxTagLine |

### Mode Édition (Formulaire)

#### Champ Expéditeur
- Type: text, required, maxlength 50
- Erreur: freefax_expeditor_form_error

#### Champ Email
- Type: email, required, maxlength 50
- Validation: tucValidator.isEmail
- Erreur: freefax_expeditor_mail_form_error

#### Champ Qualité (Select)
| Valeur | Label |
|--------|-------|
| normal | "Normale" |
| high | "Élevée" |
| best | "Optimale" |

#### Champ Tentatives max (Select)
Options: [1, 2, 3, 4, 5, 6, 7, 8, 9]

#### Champ Entête
- Type: text, required, maxlength 50
- Erreur: freefax_header_form_error

### Tile Aide Entête
Variables disponibles pour l'entête fax:

| Variable | Description |
|----------|-------------|
| \| | Sépare le texte en colonnes |
| %%i | Identifiant de la tâche |
| %%j | Nom de la pièce jointe |
| %%l | Fax émission Id |
| %%m | Mail de l'expéditeur |
| %%n | Numéro de fax |
| %%p | Numéro de page (session) |
| %%P | Numéro de page (tâche) |
| %%r | Fax réception Id destinataire |
| %%t | Nombre pages total (session) |
| %%T | Nombre pages total (tâche) |
| %%d | Nom du destinataire |

---

## 5. APIs & DONNÉES

### Endpoints

| Méthode | Endpoint | Description |
|---------|----------|-------------|
| PUT | /freefax/{serviceName} | Sauvegarde configuration |
| POST | /freefax/{serviceName}/resetPassword | Génère nouveau mot de passe |

### Payload sauvegarde
```typescript
interface FreefaxConfiguration {
  faxMaxCall: number;     // 1-9
  faxQuality: 'normal' | 'high' | 'best';
  faxTagLine: string;     // max 50 chars
  fromEmail: string;      // email valide
  fromName: string;       // max 50 chars
}
```

---

## 6. TRADUCTIONS

### Clés i18n
| Clé | FR |
|-----|-----|
| freefax_fax_configuration | "Configuration du fax" |
| freefax_expeditor | "Expéditeur" |
| freefax_expeditor_form_error | "Le champ ne doit pas être vide" |
| freefax_expeditor_mail | "Mail de l'expéditeur" |
| freefax_expeditor_mail_form_error | "Le champ doit être une adresse email valide" |
| freefax_quality | "Qualité par défaut" |
| freefax_quality_normal | "Normale" |
| freefax_quality_high | "Élevée" |
| freefax_quality_best | "Optimale" |
| freefax_max_try | "Tentatives max. d'envoi" |
| freefax_header | "Entête des fax" |
| freefax_header_form_error | "Le champ doit contenir de 1 à 50 caractères" |
| freefax_header_help | "Aide entête des fax" |
| freefax_edit | "Éditer" |
| freefax_submit | "Valider" |
| freefax_cancel | "Annuler" |
| freefax_required_fields | "Les champs marqués d'un astérisque sont obligatoires." |

---

## 7. RÈGLES MÉTIER

### Gestion des modes
- enterEditMode(): Sauvegarde données actuelles, active mode édition
- cancelEditMode(): Restaure données sauvegardées, désactive mode édition

### Validations
| Champ | Règles |
|-------|--------|
| Expéditeur | Required, max 50 chars |
| Email | Required, format email valide |
| Qualité | Required (select) |
| Tentatives | Required (select 1-9) |
| Entête | Required, 1-50 chars |

### États
| État | Comportement |
|------|--------------|
| loading | Spinner affiché, boutons disabled |
| editMode=false | Affichage lecture seule |
| editMode=true | Formulaire éditable |
| Erreur | TucToastError affiché |
| Succès | Retour mode lecture |
