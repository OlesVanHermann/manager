# Cahier des Charges : web-cloud/domain - Zone History

## 1. VUE D'ENSEMBLE

**Type:** Page timeline
**Fonction:** Historique des modifications de la zone DNS
**Contexte:** Accessible depuis l'onglet Zone DNS

## 2. NAVIGATION

### NAV1
- Menu: Web Cloud (actif)

### NAV2
- Menu: Domaines et DNS (actif)

### NAV3
- Onglets: Infos générales | Zone DNS (actif) | Serveurs DNS | Redirections | DynHost | GLUE | DNSSEC | Contacts | Tâches | Alldom

### Breadcrumb
- Zone DNS > Historique

## 3. LAYOUT

### Panel gauche
- Largeur: 280px
- Liste des domaines avec recherche
- Domaine sélectionné: background #E8F0FE

### Panel droit
- Largeur: 1096px
- Timeline des modifications

## 4. HEADER

- Titre: "Historique des modifications"
- Description: "Consultez l'historique des modifications de votre zone DNS."

## 5. TOOLBAR

| Élément | Type | Dimensions | Action |
|---------|------|------------|--------|
| Rafraîchir | btn-outline | 32x32px | Recharge l'historique |
| Période | Dropdown | 120x32px | "30 jours" (par défaut) |
| ← Retour | btn-outline | 100x32px | Retour à la zone DNS |

### Options de période
- 7 jours
- 30 jours
- 90 jours
- 1 an

## 6. TIMELINE

### Structure d'une entrée

| Élément | Position | Style |
|---------|----------|-------|
| Point | Gauche | Cercle 16px (bleu récent, gris ancien) |
| Ligne | Gauche | Trait vertical 2px #E5E7EB |
| Carte | Droite | 1000x80px, background #F9FAFB ou blanc |

### Contenu de la carte

| Ligne | Contenu | Style |
|-------|---------|-------|
| Titre | Type d'action + type enregistrement | font-size 12px, font-weight 500 |
| Détails | Sous-domaine → valeur (TTL) | font-size 11px, text-muted |
| Auteur | "Par: {nichandle}" | font-size 10px, text-muted |
| Date | "DD/MM/YYYY HH:MM" | font-size 11px, text-muted, droite |
| Action | "Restaurer" | btn-outline, 80x24px |

### Types d'actions

| Action | Libellé |
|--------|---------|
| create | Ajout enregistrement {type} |
| update | Modification enregistrement {type} |
| delete | Suppression enregistrement {type} |
| reset | Réinitialisation zone |
| import | Import zone |

### Exemples d'entrées

1. **Ajout enregistrement A**
   - Détails: "www → 203.0.113.50 (TTL: 3600)"
   - Date: 30/12/2025 14:30

2. **Modification enregistrement MX**
   - Détails: "@ → 10 mx1.mail.ovh.net. (TTL: 3600)"
   - Date: 29/12/2025 10:15

3. **Suppression enregistrement TXT**
   - Détails: '_dmarc → "v=DMARC1; p=none"'
   - Date: 28/12/2025 16:45

4. **Réinitialisation zone**
   - Détails: "Zone DNS réinitialisée aux valeurs par défaut"
   - Date: 20/12/2025 09:00

## 7. LIEN D'AIDE

- Texte: "Guide : Restaurer une configuration DNS précédente"
- Style: text-primary, lien externe

## 8. APIS & ENDPOINTS

```
GET /domain/zone/{zoneName}/history
Query: {
  fieldType: "A" | "MX" | ...,  // optionnel
  date.from: "2025-01-01",
  date.to: "2025-12-31"
}
→ Liste l'historique des modifications

GET /domain/zone/{zoneName}/history/{id}
→ Détails d'une modification

POST /domain/zone/{zoneName}/history/{id}/restore
→ Restaure la zone à cet état

GET /domain/zone/{zoneName}/export
Query: { format: "bind" }
→ Exporte la zone actuelle

# Pour chaque entrée d'historique:
{
  id: 12345,
  date: "2025-12-30T14:30:00+01:00",
  action: "create" | "update" | "delete",
  fieldType: "A",
  subDomain: "www",
  target: "203.0.113.50",
  ttl: 3600,
  user: "ab12345-ovh"
}
```

## 9. TRADUCTIONS (i18n)

| Clé | FR |
|-----|-----|
| page_title | Historique des modifications |
| page_description | Consultez l'historique des modifications de votre zone DNS. |
| breadcrumb_zone | Zone DNS |
| breadcrumb_history | Historique |
| btn_refresh | Rafraîchir |
| btn_back | ← Retour |
| filter_period | Période |
| period_7d | 7 jours |
| period_30d | 30 jours |
| period_90d | 90 jours |
| period_1y | 1 an |
| action_create | Ajout enregistrement {type} |
| action_update | Modification enregistrement {type} |
| action_delete | Suppression enregistrement {type} |
| action_reset | Réinitialisation zone |
| by_user | Par: {nichandle} |
| btn_restore | Restaurer |
| guide_link | Guide : Restaurer une configuration DNS précédente |
