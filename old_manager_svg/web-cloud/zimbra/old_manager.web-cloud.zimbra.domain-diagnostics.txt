# Cahier des Charges : web-cloud/zimbra - Diagnostics domaine

## 1. RESUME EXECUTIF

### Perimetre
Page de diagnostic DNS d'un domaine Zimbra.

### Objectif fonctionnel
- Verifier la configuration DNS
- Afficher les enregistrements requis
- Permettre de copier les valeurs

---

## 2. LAYOUT

### Structure page avec onglets DNS + details enregistrements

---

## 3. COMPOSANTS UI

### Navigation
| Element | Description |
|---------|-------------|
| Lien retour | Retour aux domaines |
| Titre | Diagnostics du domaine exemple.com |

### Bouton action
| Element | Description |
|---------|-------------|
| Type | Outline |
| Texte | Rafraichir |

### Onglets DNS
| Onglet | Indicateur |
|--------|------------|
| MX | - |
| SRV | Warning (triangle) |
| SPF | - |
| DKIM | Warning (triangle) |

### Statut configuration
| Etat | Badge |
|------|-------|
| Configuration OK | Vert (#DEF7EC) |
| Configuration KO | Rouge (#FEE2E2) |

### Message succes
| Element | Description |
|---------|-------------|
| Type | Success (vert) |
| Texte | La configuration de votre compte Zimbra sur OVHcloud est fonctionnelle |

### Details enregistrement DNS
| Champ | Type | Description |
|-------|------|-------------|
| Type | Texte | MX / SRV / TXT |
| Nom/Hote | Clipboard | Avec bouton copie |
| Priorite | Texte | Valeur numerique |
| Cible | Clipboard | Avec bouton copie |

### Lien aide
| Element | Description |
|---------|-------------|
| Type | Link |
| Texte | Acceder au guide |

---

## 4. APIS & DONNEES

### Endpoints
```
GET /zimbra/platform/{platformId}/domain/{domainId}/diagnostic
POST /zimbra/platform/{platformId}/domain/{domainId}/diagnostic/refresh
```

### Modele
```typescript
interface DomainDiagnostic {
  domain: string;
  records: {
    mx: DnsRecordStatus;
    srv: DnsRecordStatus;
    spf: DnsRecordStatus;
    dkim: DnsRecordStatus;
  };
}

interface DnsRecordStatus {
  type: string;
  status: 'ok' | 'error' | 'warning';
  expected: {
    name: string;
    priority?: number;
    target: string;
  };
  current?: {
    name: string;
    priority?: number;
    target: string;
  };
}
```

---

## 5. TRADUCTIONS (i18n)

```json
{
  "zimbra_diag_title": "Diagnostics du domaine {domain}",
  "zimbra_diag_refresh": "Rafraichir",
  "zimbra_diag_tab_mx": "MX",
  "zimbra_diag_tab_srv": "SRV",
  "zimbra_diag_tab_spf": "SPF",
  "zimbra_diag_tab_dkim": "DKIM",
  "zimbra_diag_status_ok": "Configuration OK",
  "zimbra_diag_status_error": "Configuration KO",
  "zimbra_diag_success_message": "La configuration de votre compte Zimbra sur OVHcloud est fonctionnelle",
  "zimbra_diag_type": "Type",
  "zimbra_diag_name": "Nom/Hote",
  "zimbra_diag_priority": "Priorite",
  "zimbra_diag_target": "Cible",
  "zimbra_diag_guide": "Acceder au guide"
}
```

---

## 6. REGLES METIER

- MX = reception des emails
- SRV = autodiscover clients mail
- SPF = anti-spoofing
- DKIM = signature cryptographique
- Warning = configuration incomplete mais fonctionnelle
- Error = emails non recus
