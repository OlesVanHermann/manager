# CAHIER DES CHARGES - old_manager.telecom.telephony.billingAccount
# Page groupe de facturation VoIP

## 1. RESUME EXECUTIF

### Perimetre
Page de gestion d'un groupe de facturation telephonique (billingAccount).

### Objectif fonctionnel
Centraliser l'administration d'un groupe de services VoIP: lignes, numeros, fax.

### Users cibles
- Administrateurs de comptes VoIP
- Gestionnaires de flottes telephoniques

---

## 2. ARCHITECTURE

### Arborescence fichiers source
```
telecom/telephony/billingAccount/
├── billing-account.module.js
├── billingAccount.routing.js
├── billingAccount.constants.js
├── billingAccount.service.js
├── billing-account.controller.js
├── billing-account.html
├── index.js
├── abbreviatedNumbers/
├── administration/
├── billing/
├── convertToVoicefax/
├── dashboard/
├── guides/
├── manageContacts/
├── orderAlias/
├── phonebook/
├── services/
└── translations/
```

### Sous-modules
| Module | Description |
|--------|-------------|
| abbreviatedNumbers | Numeros abreges |
| administration | Administration groupe |
| billing | Facturation et consommation |
| convertToVoicefax | Conversion Ecofax |
| dashboard | Tableau de bord |
| guides | Guides d'aide |
| manageContacts | Gestion contacts |
| orderAlias | Commande alias |
| phonebook | Carnet d'adresses |
| services | Liste services |

---

## 3. PAGES & NAVIGATION

### Route
- State: `telecom.telephony.billingAccount`
- URL: `/telephony/{billingAccount}`
- Param: billingAccount (string)

### Breadcrumb
VoIP > {billingAccount}

### Onglets principaux
| Onglet | State | Description |
|--------|-------|-------------|
| Tableau de bord | .dashboard | Vue synthetique |
| Services | .services | Liste lignes/numeros |
| Facturation | .billing | Consommation, factures |
| Administration | .administration | Parametres groupe |

---

## 4. COMPOSANTS UI

### Header
- Nom du groupe (billingAccount)
- Description editable
- Statut (badge)

### Sidebar Services
- Liste des services du groupe
- Filtrage par type (ligne, numero, fax)
- Recherche

### Zone principale
- Contenu selon onglet actif
- ui-view pour sous-routes

---

## 5. APIs & DONNEES

### Endpoints

#### Information groupe
```
GET /telephony/{billingAccount}
Response: {
  billingAccount: string,
  description: string,
  status: string,
  currentOutplan: {
    text: string,
    value: number
  },
  securityDeposit: {
    text: string,
    value: number
  },
  creditThreshold: {
    text: string,
    value: number
  }
}
```

#### Liste services
```
GET /telephony/{billingAccount}/service
Response: Array<string>
```

#### Detail service
```
GET /telephony/{billingAccount}/service/{serviceName}
Response: {
  serviceName: string,
  serviceType: "alias" | "line",
  featureType: string,
  description: string
}
```

#### Mise a jour description
```
PUT /telephony/{billingAccount}
Body: { description: string }
```

#### Informations service
```
GET /telephony/{billingAccount}/serviceInfos
Response: ServiceInfos
```

### Sequencement
1. GET /telephony/{billingAccount}
2. GET /telephony/{billingAccount}/service
3. Pour chaque service: GET detail

---

## 6. TRADUCTIONS

### Cles i18n (FR)
| Cle | Valeur FR |
|-----|-----------|
| telephony_page_title | Ma Telephonie "{{name}}" |
| telephony_service_type_alias | Numero |
| telephony_service_type_line | Ligne |
| telephony_service_feature_type_sip | Ligne SIP |
| telephony_service_feature_type_mgcp | Ligne SIP |
| telephony_service_feature_type_fax | FAX |
| telephony_service_feature_type_freefax | FreeFax |
| telephony_service_feature_type_trunk | Trunk |
| telephony_service_feature_type_plugAndFax | Plug & Fax |
| telephony_service_feature_type_voicefax | Fax |

---

## 7. REGLES METIER

### Types de services
| featureType | Label | Categorie |
|-------------|-------|-----------|
| sip | Ligne SIP | line |
| mgcp | Ligne SIP | line |
| fax | FAX | fax |
| freefax | FreeFax | fax |
| trunk | Trunk | line |
| plugAndFax | Plug & Fax | fax |
| voicefax | Fax | fax |

### Permissions
- Modification description: Tous
- Administration: Selon droits contact

### Alertes
- Hors forfait > seuil -> Alerte
- Service expire -> Banniere
