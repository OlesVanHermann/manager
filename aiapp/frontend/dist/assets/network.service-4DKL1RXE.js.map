{"version":3,"file":"network.service-4DKL1RXE.js","sources":["../../src/services/network.service.ts"],"sourcesContent":["// ============================================================\n// SERVICE NETWORK - IP, vRack, CDN, Load Balancer\n// ============================================================\n\nimport { ovhApi } from './api.service';\n\n// ============================================================\n// TYPES - IP\n// ============================================================\n\nexport interface IpBlock {\n  ip: string;\n  canBeTerminated: boolean;\n  country: string | null;\n  description: string;\n  organisationId: string | null;\n  routedTo: { serviceName: string } | null;\n  type: 'cdn' | 'cloud' | 'dedicated' | 'failover' | 'hosted_ssl' | 'housing' | 'loadBalancing' | 'mail' | 'overthebox' | 'pcc' | 'pci' | 'private' | 'vpn' | 'vps' | 'vrack' | 'xdsl';\n}\n\nexport interface IpReverse {\n  ipReverse: string;\n  reverse: string;\n}\n\nexport interface IpFirewall {\n  enabled: boolean;\n  ipOnFirewall: string;\n  state: 'disableFirewallPending' | 'enableFirewallPending' | 'ok';\n}\n\nexport interface IpMitigation {\n  ipOnMitigation: string;\n  permanent: boolean;\n  state: 'creationPending' | 'ok' | 'removalPending';\n  auto: boolean;\n}\n\nexport interface IpTask {\n  taskId: number;\n  function: string;\n  status: 'cancelled' | 'customerError' | 'doing' | 'done' | 'init' | 'ovhError' | 'todo';\n  startDate: string;\n  doneDate: string | null;\n  lastUpdate: string;\n  comment: string | null;\n}\n\n// ============================================================\n// TYPES - VRACK\n// ============================================================\n\nexport interface Vrack {\n  name: string;\n  description: string;\n}\n\nexport interface VrackServiceInfos {\n  serviceId: number;\n  creation: string;\n  expiration: string;\n  contactAdmin: string;\n  contactTech: string;\n  contactBilling: string;\n  status: string;\n  renew: { automatic: boolean; deleteAtExpiration: boolean; period: number | null };\n}\n\nexport interface VrackAllowedService {\n  cloudProject: string[];\n  dedicatedCloud: string[];\n  dedicatedServer: string[];\n  dedicatedServerInterface: string[];\n  ip: string[];\n  ipLoadbalancing: string[];\n  legacyVrack: string[];\n  ovhCloudConnect: string[];\n}\n\nexport interface VrackTask {\n  id: number;\n  function: string;\n  status: 'cancelled' | 'doing' | 'done' | 'init' | 'todo';\n  targetDomain: string | null;\n  serviceName: string | null;\n  orderId: number | null;\n  lastUpdate: string;\n  todoDate: string;\n}\n\n// ============================================================\n// TYPES - LOAD BALANCER\n// ============================================================\n\nexport interface IpLoadBalancing {\n  serviceName: string;\n  displayName: string | null;\n  ipLoadbalancing: string;\n  zone: string[];\n  state: 'blacklisted' | 'deleted' | 'free' | 'ok' | 'quarantined' | 'suspended';\n  vrackEligibility: boolean;\n  vrackName: string | null;\n  sslConfiguration: 'intermediate' | 'modern' | null;\n  offer: string;\n  orderableZone: { name: string; planCode: string }[];\n}\n\nexport interface IpLoadBalancingServiceInfos {\n  serviceId: number;\n  creation: string;\n  expiration: string;\n  contactAdmin: string;\n  contactTech: string;\n  contactBilling: string;\n  status: string;\n  renew: { automatic: boolean; deleteAtExpiration: boolean; period: number | null };\n}\n\nexport interface IpLoadBalancingFarm {\n  farmId: number;\n  displayName: string | null;\n  zone: string;\n  port: number | null;\n  balance: 'first' | 'leastconn' | 'roundrobin' | 'source' | 'uri';\n  stickiness: 'cookie' | 'none' | 'sourceIp';\n  probe: { type: string; port: number | null; interval: number; url: string | null; method: string | null; match: string | null; pattern: string | null; forceSsl: boolean | null } | null;\n}\n\nexport interface IpLoadBalancingServer {\n  serverId: number;\n  farmId: number;\n  displayName: string | null;\n  address: string;\n  port: number | null;\n  status: 'active' | 'inactive';\n  proxyProtocolVersion: 'v1' | 'v2' | 'v2-ssl' | 'v2-ssl-cn' | null;\n  weight: number | null;\n  ssl: boolean;\n  backup: boolean;\n}\n\nexport interface IpLoadBalancingFrontend {\n  frontendId: number;\n  displayName: string | null;\n  zone: string;\n  port: string;\n  ssl: boolean;\n  defaultFarmId: number | null;\n  dedicatedIpfo: string[];\n  defaultSslId: number | null;\n  disabled: boolean;\n  hsts: boolean;\n  httpHeader: string[];\n  allowedSource: string[];\n  deniedSource: string[];\n}\n\n// ============================================================\n// SERVICE\n// ============================================================\n\nclass NetworkService {\n  // ==================== IP ====================\n  async listIps(): Promise<string[]> {\n    return ovhApi.get<string[]>('/ip');\n  }\n\n  async getIp(ip: string): Promise<IpBlock> {\n    return ovhApi.get<IpBlock>(`/ip/${encodeURIComponent(ip)}`);\n  }\n\n  async listReverses(ip: string): Promise<string[]> {\n    return ovhApi.get<string[]>(`/ip/${encodeURIComponent(ip)}/reverse`);\n  }\n\n  async getReverse(ip: string, ipReverse: string): Promise<IpReverse> {\n    return ovhApi.get<IpReverse>(`/ip/${encodeURIComponent(ip)}/reverse/${encodeURIComponent(ipReverse)}`);\n  }\n\n  async setReverse(ip: string, ipReverse: string, reverse: string): Promise<IpReverse> {\n    return ovhApi.post<IpReverse>(`/ip/${encodeURIComponent(ip)}/reverse`, { ipReverse, reverse });\n  }\n\n  async getFirewall(ip: string, ipOnFirewall: string): Promise<IpFirewall> {\n    return ovhApi.get<IpFirewall>(`/ip/${encodeURIComponent(ip)}/firewall/${encodeURIComponent(ipOnFirewall)}`);\n  }\n\n  async getMitigation(ip: string, ipOnMitigation: string): Promise<IpMitigation> {\n    return ovhApi.get<IpMitigation>(`/ip/${encodeURIComponent(ip)}/mitigation/${encodeURIComponent(ipOnMitigation)}`);\n  }\n\n  async listTasks(ip: string): Promise<number[]> {\n    return ovhApi.get<number[]>(`/ip/${encodeURIComponent(ip)}/task`);\n  }\n\n  async getTask(ip: string, taskId: number): Promise<IpTask> {\n    return ovhApi.get<IpTask>(`/ip/${encodeURIComponent(ip)}/task/${taskId}`);\n  }\n\n  // ==================== VRACK ====================\n  async listVracks(): Promise<string[]> {\n    return ovhApi.get<string[]>('/vrack');\n  }\n\n  async getVrack(serviceName: string): Promise<Vrack> {\n    return ovhApi.get<Vrack>(`/vrack/${serviceName}`);\n  }\n\n  async getVrackServiceInfos(serviceName: string): Promise<VrackServiceInfos> {\n    return ovhApi.get<VrackServiceInfos>(`/vrack/${serviceName}/serviceInfos`);\n  }\n\n  async getAllowedServices(serviceName: string): Promise<VrackAllowedService> {\n    return ovhApi.get<VrackAllowedService>(`/vrack/${serviceName}/allowedServices`);\n  }\n\n  async listVrackDedicatedServers(serviceName: string): Promise<string[]> {\n    return ovhApi.get<string[]>(`/vrack/${serviceName}/dedicatedServer`);\n  }\n\n  async listVrackCloudProjects(serviceName: string): Promise<string[]> {\n    return ovhApi.get<string[]>(`/vrack/${serviceName}/cloudProject`);\n  }\n\n  async listVrackIpLoadbalancing(serviceName: string): Promise<string[]> {\n    return ovhApi.get<string[]>(`/vrack/${serviceName}/ipLoadbalancing`);\n  }\n\n  async listVrackTasks(serviceName: string): Promise<number[]> {\n    return ovhApi.get<number[]>(`/vrack/${serviceName}/task`);\n  }\n\n  async getVrackTask(serviceName: string, taskId: number): Promise<VrackTask> {\n    return ovhApi.get<VrackTask>(`/vrack/${serviceName}/task/${taskId}`);\n  }\n\n  // ==================== LOAD BALANCER ====================\n  async listLoadBalancers(): Promise<string[]> {\n    return ovhApi.get<string[]>('/ipLoadbalancing');\n  }\n\n  async getLoadBalancer(serviceName: string): Promise<IpLoadBalancing> {\n    return ovhApi.get<IpLoadBalancing>(`/ipLoadbalancing/${serviceName}`);\n  }\n\n  async getLoadBalancerServiceInfos(serviceName: string): Promise<IpLoadBalancingServiceInfos> {\n    return ovhApi.get<IpLoadBalancingServiceInfos>(`/ipLoadbalancing/${serviceName}/serviceInfos`);\n  }\n\n  // Farms\n  async listFarms(serviceName: string, zone?: string): Promise<number[]> {\n    let path = `/ipLoadbalancing/${serviceName}/http/farm`;\n    if (zone) path += `?zone=${zone}`;\n    return ovhApi.get<number[]>(path);\n  }\n\n  async getFarm(serviceName: string, farmId: number): Promise<IpLoadBalancingFarm> {\n    return ovhApi.get<IpLoadBalancingFarm>(`/ipLoadbalancing/${serviceName}/http/farm/${farmId}`);\n  }\n\n  // Servers\n  async listServers(serviceName: string, farmId: number): Promise<number[]> {\n    return ovhApi.get<number[]>(`/ipLoadbalancing/${serviceName}/http/farm/${farmId}/server`);\n  }\n\n  async getServer(serviceName: string, farmId: number, serverId: number): Promise<IpLoadBalancingServer> {\n    return ovhApi.get<IpLoadBalancingServer>(`/ipLoadbalancing/${serviceName}/http/farm/${farmId}/server/${serverId}`);\n  }\n\n  // Frontends\n  async listFrontends(serviceName: string, zone?: string): Promise<number[]> {\n    let path = `/ipLoadbalancing/${serviceName}/http/frontend`;\n    if (zone) path += `?zone=${zone}`;\n    return ovhApi.get<number[]>(path);\n  }\n\n  async getFrontend(serviceName: string, frontendId: number): Promise<IpLoadBalancingFrontend> {\n    return ovhApi.get<IpLoadBalancingFrontend>(`/ipLoadbalancing/${serviceName}/http/frontend/${frontendId}`);\n  }\n\n  // Actions\n  async refreshLoadBalancer(serviceName: string, zone: string): Promise<void> {\n    return ovhApi.post<void>(`/ipLoadbalancing/${serviceName}/refresh`, { zone });\n  }\n}\n\nexport const networkService = new NetworkService();\n"],"names":["NetworkService","ovhApi","ip","ipReverse","reverse","ipOnFirewall","ipOnMitigation","taskId","serviceName","zone","path","farmId","serverId","frontendId","networkService"],"mappings":"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"}