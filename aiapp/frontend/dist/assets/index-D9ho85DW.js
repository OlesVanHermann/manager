import{u as y,r as d,j as s}from"./index-svQWOpff.js";import{n as h}from"./network.service-4DKL1RXE.js";import"./api.service-CIh7kdHI.js";function $({serviceName:l}){const{t:n}=y("network/load-balancer/index"),[c,m]=d.useState([]),[i,x]=d.useState(!0),[t,v]=d.useState(null);d.useEffect(()=>{(async()=>{try{x(!0);const r=await h.listFarms(l),b=await Promise.all(r.map(j=>h.getFarm(l,j)));m(b)}finally{x(!1)}})()},[l]);const g=async a=>{if(t===a){v(null);return}v(a);try{const r=await h.listServers(l,a),b=await Promise.all(r.map(j=>h.getServer(l,a,j)));m(j=>j.map(f=>f.farmId===a?{...f,servers:b}:f))}catch{}};return i?s.jsx("div",{className:"tab-loading",children:s.jsx("div",{className:"skeleton-block"})}):s.jsxs("div",{className:"farms-tab",children:[s.jsxs("div",{className:"tab-header",children:[s.jsx("h3",{children:n("farms.title")}),s.jsx("span",{className:"records-count",children:c.length})]}),c.length===0?s.jsx("div",{className:"empty-state",children:s.jsx("p",{children:n("farms.empty")})}):s.jsx("div",{className:"farms-list",children:c.map(a=>s.jsxs("div",{className:`farm-card ${t===a.farmId?"expanded":""}`,children:[s.jsxs("div",{className:"farm-header",onClick:()=>g(a.farmId),children:[s.jsxs("div",{className:"farm-info",children:[s.jsx("h4",{children:a.displayName||`Farm #${a.farmId}`}),s.jsxs("div",{className:"farm-meta",children:[s.jsx("span",{className:"badge info",children:a.zone}),s.jsx("span",{className:"badge secondary",children:a.balance}),a.port&&s.jsxs("span",{children:[":",a.port]})]})]}),s.jsx("svg",{className:"chevron",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})})]}),t===a.farmId&&a.servers&&s.jsx("div",{className:"farm-servers",children:a.servers.length===0?s.jsx("p",{className:"no-servers",children:n("farms.noServers")}):s.jsxs("table",{className:"servers-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:n("farms.address")}),s.jsx("th",{children:n("farms.port")}),s.jsx("th",{children:n("farms.weight")}),s.jsx("th",{children:n("farms.status")}),s.jsx("th",{children:n("farms.ssl")})]})}),s.jsx("tbody",{children:a.servers.map(r=>s.jsxs("tr",{children:[s.jsx("td",{className:"font-mono",children:r.address}),s.jsx("td",{children:r.port||"-"}),s.jsx("td",{children:r.weight||"-"}),s.jsx("td",{children:s.jsx("span",{className:`badge ${r.status==="active"?"success":"inactive"}`,children:r.status})}),s.jsx("td",{children:r.ssl?"✓":"✗"})]},r.serverId))})]})})]},a.farmId))})]})}function B({serviceName:l}){const{t:n}=y("network/load-balancer/index"),[c,m]=d.useState([]),[i,x]=d.useState(!0);return d.useEffect(()=>{(async()=>{try{x(!0);const v=await h.listFrontends(l),g=await Promise.all(v.map(a=>h.getFrontend(l,a)));m(g)}finally{x(!1)}})()},[l]),i?s.jsx("div",{className:"tab-loading",children:s.jsx("div",{className:"skeleton-block"})}):s.jsxs("div",{className:"frontends-tab",children:[s.jsxs("div",{className:"tab-header",children:[s.jsx("h3",{children:n("frontends.title")}),s.jsx("span",{className:"records-count",children:c.length})]}),c.length===0?s.jsx("div",{className:"empty-state",children:s.jsx("p",{children:n("frontends.empty")})}):s.jsxs("table",{className:"data-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:n("frontends.name")}),s.jsx("th",{children:n("frontends.zone")}),s.jsx("th",{children:n("frontends.port")}),s.jsx("th",{children:n("frontends.ssl")}),s.jsx("th",{children:n("frontends.farm")}),s.jsx("th",{children:n("frontends.status")})]})}),s.jsx("tbody",{children:c.map(t=>s.jsxs("tr",{children:[s.jsx("td",{children:t.displayName||`Frontend #${t.frontendId}`}),s.jsx("td",{children:s.jsx("span",{className:"badge info",children:t.zone})}),s.jsx("td",{className:"font-mono",children:t.port}),s.jsx("td",{children:t.ssl?s.jsx("span",{className:"badge success",children:"SSL"}):"-"}),s.jsx("td",{children:t.defaultFarmId||"-"}),s.jsx("td",{children:s.jsx("span",{className:`badge ${t.disabled?"inactive":"success"}`,children:t.disabled?n("frontends.disabled"):n("frontends.enabled")})})]},t.frontendId))})]})]})}function T(){var S,C;const{t:l}=y("network/load-balancer/index"),{t:n}=y("common"),[c,m]=d.useState([]),[i,x]=d.useState(null),[t,v]=d.useState("farms"),[g,a]=d.useState(!0),[r,b]=d.useState(""),j=[{id:"farms",labelKey:"tabs.farms"},{id:"frontends",labelKey:"tabs.frontends"}],f=d.useCallback(async()=>{try{a(!0);const e=await h.listLoadBalancers(),p=e.map(o=>({serviceName:o,loading:!0}));m(p),e.length>0&&!i&&x(e[0]);for(const o of e)try{const[N,w]=await Promise.all([h.getLoadBalancer(o),h.getLoadBalancerServiceInfos(o)]);m(I=>I.map(k=>k.serviceName===o?{...k,details:N,serviceInfos:w,loading:!1}:k))}catch{m(N=>N.map(w=>w.serviceName===o?{...w,loading:!1}:w))}}finally{a(!1)}},[i]);d.useEffect(()=>{f()},[]);const L=c.filter(e=>{var p,o;return e.serviceName.toLowerCase().includes(r.toLowerCase())||((o=(p=e.details)==null?void 0:p.displayName)==null?void 0:o.toLowerCase().includes(r.toLowerCase()))}),u=c.find(e=>e.serviceName===i),F=()=>{if(!i)return null;switch(t){case"farms":return s.jsx($,{serviceName:i});case"frontends":return s.jsx(B,{serviceName:i});default:return null}};return s.jsxs("div",{className:"lb-page",children:[s.jsxs("aside",{className:"lb-sidebar",children:[s.jsxs("div",{className:"sidebar-header",children:[s.jsx("h2",{children:l("title")}),s.jsx("span",{className:"count-badge",children:c.length})]}),s.jsx("div",{className:"sidebar-search",children:s.jsx("input",{type:"text",placeholder:l("searchPlaceholder"),value:r,onChange:e=>b(e.target.value)})}),s.jsx("div",{className:"lb-list",children:g&&c.length===0?s.jsx("div",{className:"loading-state",children:s.jsx("div",{className:"skeleton-item"})}):L.length===0?s.jsx("div",{className:"empty-state",children:n("empty.title")}):L.map(e=>{var p,o,N;return s.jsxs("button",{className:`lb-item ${i===e.serviceName?"active":""}`,onClick:()=>x(e.serviceName),children:[s.jsx("div",{className:`lb-status-dot ${((p=e.details)==null?void 0:p.state)==="ok"?"running":"warning"}`}),s.jsxs("div",{className:"lb-info",children:[s.jsx("span",{className:"lb-name",children:((o=e.details)==null?void 0:o.displayName)||e.serviceName}),e.details&&s.jsxs("span",{className:"lb-meta",children:[(N=e.details.zone)==null?void 0:N.join(", ")," | ",e.details.offer]})]})]},e.serviceName)})})]}),s.jsx("main",{className:"lb-main",children:i&&u?s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"page-header",children:[s.jsxs("div",{children:[s.jsx("h1",{children:((S=u.details)==null?void 0:S.displayName)||i}),u.details&&s.jsxs("p",{className:"page-description",children:["IP: ",u.details.ipLoadbalancing," | Zones: ",(C=u.details.zone)==null?void 0:C.join(", ")," | ",s.jsx("span",{className:`state-text ${u.details.state==="ok"?"running":"warning"}`,children:u.details.state})]})]}),s.jsxs("button",{className:"btn-refresh",onClick:f,children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})}),n("actions.refresh")]})]}),s.jsx("div",{className:"tabs-container",children:s.jsx("div",{className:"tabs-list",children:j.map(e=>s.jsx("button",{className:`tab-btn ${t===e.id?"active":""}`,onClick:()=>v(e.id),children:l(e.labelKey)},e.id))})}),s.jsx("div",{className:"tab-content",children:F()})]}):s.jsxs("div",{className:"no-selection",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21L3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"})}),s.jsx("p",{children:l("selectLb")})]})})]})}export{T as default};
//# sourceMappingURL=index-D9ho85DW.js.map
