import{u as v,j as e,r as l}from"./index-svQWOpff.js";import{o as h}from"./api.service-CIh7kdHI.js";/* empty css               */class P{async listDatabases(){return h.get("/hosting/privateDatabase")}async getDatabase(s){return h.get(`/hosting/privateDatabase/${s}`)}async getServiceInfos(s){return h.get(`/hosting/privateDatabase/${s}/serviceInfos`)}async listDbs(s){return h.get(`/hosting/privateDatabase/${s}/database`)}async getDb(s,a){return h.get(`/hosting/privateDatabase/${s}/database/${a}`)}async createDb(s,a){return h.post(`/hosting/privateDatabase/${s}/database`,{databaseName:a})}async deleteDb(s,a){return h.delete(`/hosting/privateDatabase/${s}/database/${a}`)}async listUsers(s){return h.get(`/hosting/privateDatabase/${s}/user`)}async getUser(s,a){return h.get(`/hosting/privateDatabase/${s}/user/${a}`)}async createUser(s,a,d){return h.post(`/hosting/privateDatabase/${s}/user`,{userName:a,password:d})}async deleteUser(s,a){return h.delete(`/hosting/privateDatabase/${s}/user/${a}`)}async listWhitelist(s){return h.get(`/hosting/privateDatabase/${s}/whitelist`)}async getWhitelist(s,a){return h.get(`/hosting/privateDatabase/${s}/whitelist/${a}`)}async addWhitelist(s,a,d,t,o){return h.post(`/hosting/privateDatabase/${s}/whitelist`,{ip:a,name:d,service:t,sftp:o})}async removeWhitelist(s,a){return h.delete(`/hosting/privateDatabase/${s}/whitelist/${a}`)}async listTasks(s,a){let d=`/hosting/privateDatabase/${s}/tasks`;return a&&(d+=`?status=${a}`),h.get(d)}async getTask(s,a){return h.get(`/hosting/privateDatabase/${s}/tasks/${a}`)}async restart(s){return h.post(`/hosting/privateDatabase/${s}/restart`,{})}async start(s){return h.post(`/hosting/privateDatabase/${s}/start`,{})}async stop(s){return h.post(`/hosting/privateDatabase/${s}/stop`,{})}}const b=new P;function W({serviceName:c,details:s,serviceInfos:a,loading:d}){var u,r;const{t}=v("web-cloud/private-database/index");if(d)return e.jsxs("div",{className:"tab-loading",children:[e.jsx("div",{className:"skeleton-block"}),e.jsx("div",{className:"skeleton-block"})]});const o=n=>n?`${n.value} ${n.unit}`:"-",x=s!=null&&s.quotaSize&&(s!=null&&s.quotaUsed)?Math.round(s.quotaUsed.value/s.quotaSize.value*100):0;return e.jsxs("div",{className:"general-tab",children:[e.jsxs("section",{className:"info-section",children:[e.jsx("h3",{children:t("general.title")}),e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.serviceName")}),e.jsx("span",{className:"font-mono",children:c})]}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.type")}),e.jsxs("span",{className:`badge db-${s.type}`,children:[s.type," ",s.version]})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.state")}),e.jsx("span",{className:`badge ${s.state==="started"?"success":"warning"}`,children:s.state})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.offer")}),e.jsx("span",{children:s.offer})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.datacenter")}),e.jsx("span",{children:s.datacenter})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.hostname")}),e.jsxs("span",{className:"font-mono",children:[s.hostname,":",s.port]})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.ram")}),e.jsx("span",{children:o(s.ram)})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.cpu")}),e.jsxs("span",{children:[s.cpu," vCPU"]})]})]})]})]}),s&&e.jsxs("section",{className:"info-section",children:[e.jsx("h3",{children:t("general.storage")}),e.jsxs("div",{className:"quota-display",children:[e.jsx("div",{className:"quota-bar",children:e.jsx("div",{className:"quota-fill",style:{width:`${Math.min(x,100)}%`}})}),e.jsxs("div",{className:"quota-text",children:[e.jsxs("span",{children:[o(s.quotaUsed)," / ",o(s.quotaSize)]}),e.jsxs("span",{className:x>90?"warning":"",children:[x,"%"]})]})]})]}),a&&e.jsxs("section",{className:"info-section",children:[e.jsx("h3",{children:t("general.service")}),e.jsxs("div",{className:"info-grid",children:[e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.creation")}),e.jsx("span",{children:new Date(a.creation).toLocaleDateString()})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.expiration")}),e.jsx("span",{children:new Date(a.expiration).toLocaleDateString()})]}),e.jsxs("div",{className:"info-item",children:[e.jsx("label",{children:t("general.autoRenew")}),e.jsx("span",{className:`badge ${(u=a.renew)!=null&&u.automatic?"success":"warning"}`,children:(r=a.renew)!=null&&r.automatic?"âœ“":"âœ—"})]})]})]})]})}function M({serviceName:c}){const{t:s}=v("web-cloud/private-database/index"),[a,d]=l.useState([]),[t,o]=l.useState(!0),[x,u]=l.useState(null);return l.useEffect(()=>{(async()=>{try{o(!0);const n=await b.listDbs(c),m=await Promise.all(n.map(j=>b.getDb(c,j)));d(m)}catch(n){u(String(n))}finally{o(!1)}})()},[c]),t?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):x?e.jsx("div",{className:"error-state",children:x}):e.jsxs("div",{className:"databases-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h3",{children:s("databases.title")}),e.jsx("p",{className:"tab-description",children:s("databases.description")})]}),a.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("databases.empty")})}):e.jsx("div",{className:"db-cards",children:a.map(r=>{var n,m,j;return e.jsxs("div",{className:"db-card",children:[e.jsx("h4",{className:"font-mono",children:r.databaseName}),e.jsxs("div",{className:"db-meta",children:[e.jsxs("span",{children:[((n=r.quotaUsed)==null?void 0:n.value)||0," ",((m=r.quotaUsed)==null?void 0:m.unit)||"MB"]}),e.jsx("span",{children:new Date(r.creationDate).toLocaleDateString()})]}),e.jsx("div",{className:"db-users",children:(j=r.users)==null?void 0:j.map(p=>e.jsxs("span",{className:"user-badge",children:[p.userName," (",p.grantType,")"]},p.userName))})]},r.databaseName)})})]})}function K({serviceName:c}){const{t:s}=v("web-cloud/private-database/index"),[a,d]=l.useState([]),[t,o]=l.useState(!0),[x,u]=l.useState(null);return l.useEffect(()=>{(async()=>{try{o(!0);const n=await b.listUsers(c),m=await Promise.all(n.map(j=>b.getUser(c,j)));d(m)}catch(n){u(String(n))}finally{o(!1)}})()},[c]),t?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):x?e.jsx("div",{className:"error-state",children:x}):e.jsxs("div",{className:"users-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h3",{children:s("users.title")}),e.jsx("p",{className:"tab-description",children:s("users.description")})]}),a.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("users.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("users.name")}),e.jsx("th",{children:s("users.created")}),e.jsx("th",{children:s("users.databases")})]})}),e.jsx("tbody",{children:a.map(r=>{var n;return e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:r.userName}),e.jsx("td",{children:new Date(r.creationDate).toLocaleDateString()}),e.jsx("td",{children:(n=r.databases)==null?void 0:n.map(m=>e.jsx("span",{className:"db-badge",children:m.databaseName},m.databaseName))})]},r.userName)})})]})]})}function z({serviceName:c}){const{t:s}=v("web-cloud/private-database/index"),[a,d]=l.useState([]),[t,o]=l.useState(!0),[x,u]=l.useState(null);return l.useEffect(()=>{(async()=>{try{o(!0);const n=await b.listWhitelist(c),m=await Promise.all(n.map(j=>b.getWhitelist(c,j)));d(m)}catch(n){u(String(n))}finally{o(!1)}})()},[c]),t?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):x?e.jsx("div",{className:"error-state",children:x}):e.jsxs("div",{className:"whitelist-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h3",{children:s("whitelist.title")}),e.jsx("p",{className:"tab-description",children:s("whitelist.description")})]}),a.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"})}),e.jsx("p",{children:s("whitelist.empty")})]}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("whitelist.ip")}),e.jsx("th",{children:s("whitelist.name")}),e.jsx("th",{children:s("whitelist.service")}),e.jsx("th",{children:s("whitelist.sftp")}),e.jsx("th",{children:s("whitelist.status")})]})}),e.jsx("tbody",{children:a.map(r=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:r.ip}),e.jsx("td",{children:r.name}),e.jsx("td",{children:e.jsx("span",{className:`badge ${r.service?"success":"inactive"}`,children:r.service?"âœ“":"âœ—"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${r.sftp?"success":"inactive"}`,children:r.sftp?"âœ“":"âœ—"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${r.status==="created"?"success":"warning"}`,children:r.status})})]},r.ip))})]})]})}function B({serviceName:c}){const{t:s}=v("web-cloud/private-database/index"),[a,d]=l.useState([]),[t,o]=l.useState(!0),[x,u]=l.useState(null);l.useEffect(()=>{(async()=>{try{o(!0);const m=await b.listTasks(c),j=await Promise.all(m.slice(0,50).map(p=>b.getTask(c,p)));j.sort((p,D)=>new Date(D.startDate).getTime()-new Date(p.startDate).getTime()),d(j)}catch(m){u(String(m))}finally{o(!1)}})()},[c]);const r=n=>{const j={todo:{class:"warning",icon:"â³"},init:{class:"info",icon:"ðŸ”„"},doing:{class:"info",icon:"ðŸ”„"},done:{class:"success",icon:"âœ“"},error:{class:"error",icon:"âœ—"},cancelled:{class:"inactive",icon:"âŠ˜"}}[n]||{class:"inactive",icon:"?"};return e.jsxs("span",{className:`badge ${j.class}`,children:[j.icon," ",n]})};return t?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):x?e.jsx("div",{className:"error-state",children:x}):e.jsxs("div",{className:"tasks-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h3",{children:s("tasks.title")}),e.jsx("p",{className:"tab-description",children:s("tasks.description")})]}),a.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("tasks.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("tasks.function")}),e.jsx("th",{children:s("tasks.status")}),e.jsx("th",{children:s("tasks.progress")}),e.jsx("th",{children:s("tasks.started")})]})}),e.jsx("tbody",{children:a.map(n=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:n.function}),e.jsx("td",{children:r(n.status)}),e.jsxs("td",{children:[n.progress,"%"]}),e.jsx("td",{children:new Date(n.startDate).toLocaleString()})]},n.id))})]})]})}function Q(){const{t:c}=v("web-cloud/private-database/index"),{t:s}=v("common"),[a,d]=l.useState([]),[t,o]=l.useState(null),[x,u]=l.useState("general"),[r,n]=l.useState(!0),[m,j]=l.useState(null),[p,D]=l.useState(""),U=[{id:"general",labelKey:"tabs.general"},{id:"databases",labelKey:"tabs.databases"},{id:"users",labelKey:"tabs.users"},{id:"whitelist",labelKey:"tabs.whitelist"},{id:"tasks",labelKey:"tabs.tasks"}],L=l.useCallback(async()=>{try{n(!0),j(null);const i=await b.listDatabases(),N=i.map(f=>({serviceName:f,loading:!0}));d(N),i.length>0&&!t&&o(i[0]);for(let f=0;f<i.length;f+=5){const E=i.slice(f,f+5);await Promise.all(E.map(async w=>{try{const[k,S]=await Promise.all([b.getDatabase(w),b.getServiceInfos(w)]);d(y=>y.map($=>$.serviceName===w?{...$,details:k,serviceInfos:S,loading:!1}:$))}catch(k){d(S=>S.map(y=>y.serviceName===w?{...y,loading:!1,error:String(k)}:y))}}))}}catch(i){j(String(i))}finally{n(!1)}},[t]);l.useEffect(()=>{L()},[]);const T=a.filter(i=>i.serviceName.toLowerCase().includes(p.toLowerCase())),g=a.find(i=>i.serviceName===t),q=()=>{if(!t||!g)return null;switch(x){case"general":return e.jsx(W,{serviceName:t,details:g.details,serviceInfos:g.serviceInfos,loading:g.loading});case"databases":return e.jsx(M,{serviceName:t});case"users":return e.jsx(K,{serviceName:t});case"whitelist":return e.jsx(z,{serviceName:t});case"tasks":return e.jsx(B,{serviceName:t});default:return null}},C=i=>{const N={mysql:"#00758f",postgresql:"#336791",redis:"#dc382d",mongodb:"#47a248"};return e.jsx("div",{className:"db-type-icon",style:{background:N[i||""]||"#6b7280"},children:(i==null?void 0:i.charAt(0).toUpperCase())||"D"})};return e.jsxs("div",{className:"private-db-page",children:[e.jsxs("aside",{className:"db-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h2",{children:c("title")}),e.jsx("span",{className:"db-count",children:a.length})]}),e.jsx("div",{className:"sidebar-search",children:e.jsx("input",{type:"text",placeholder:c("searchPlaceholder"),value:p,onChange:i=>D(i.target.value)})}),e.jsx("div",{className:"db-list",children:r&&a.length===0?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"skeleton-item"}),e.jsx("div",{className:"skeleton-item"})]}):m?e.jsx("div",{className:"error-state",children:m}):T.length===0?e.jsx("div",{className:"empty-state",children:s("empty.title")}):T.map(i=>{var N;return e.jsxs("button",{className:`db-item ${t===i.serviceName?"active":""}`,onClick:()=>o(i.serviceName),children:[C((N=i.details)==null?void 0:N.type),e.jsxs("div",{className:"db-info",children:[e.jsx("span",{className:"db-name",children:i.serviceName}),i.details&&e.jsxs("span",{className:"db-meta",children:[i.details.type," ",i.details.version," | ",i.details.state]})]})]},i.serviceName)})})]}),e.jsx("main",{className:"db-main",children:t&&g?e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:t}),g.details&&e.jsxs("p",{className:"page-description",children:[g.details.type," ",g.details.version," | ",g.details.datacenter," | ",g.details.state]})]}),e.jsxs("button",{className:"btn-refresh",onClick:L,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})}),s("actions.refresh")]})]}),e.jsx("div",{className:"tabs-container",children:e.jsx("div",{className:"tabs-list",children:U.map(i=>e.jsx("button",{className:`tab-btn ${x===i.id?"active":""}`,onClick:()=>u(i.id),children:c(i.labelKey)},i.id))})}),e.jsx("div",{className:"tab-content",children:q()})]}):e.jsxs("div",{className:"no-selection",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375"})}),e.jsx("p",{children:c("selectDatabase")})]})})]})}export{Q as default};
//# sourceMappingURL=index-iMG2xQfx.js.map
