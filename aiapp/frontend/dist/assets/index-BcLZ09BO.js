import{u as g,r as c,j as e}from"./index-svQWOpff.js";import{o as h}from"./api.service-CIh7kdHI.js";/* empty css               */class M{async listTenants(){return h.get("/license/office")}async getTenant(s){return h.get(`/license/office/${s}`)}async getServiceInfos(s){return h.get(`/license/office/${s}/serviceInfos`)}async listUsers(s){return h.get(`/license/office/${s}/user`)}async getUser(s,n){return h.get(`/license/office/${s}/user/${n}`)}async listDomains(s){return h.get(`/license/office/${s}/domain`)}async getDomain(s,n){return h.get(`/license/office/${s}/domain/${n}`)}async listTasks(s){return h.get(`/license/office/${s}/task`)}async getTask(s,n){return h.get(`/license/office/${s}/task/${n}`)}async getUsageStatistics(s){return h.get(`/license/office/${s}/usageStatistics`)}}const u=new M;function C({serviceName:i}){const{t:s}=g("web-cloud/office/index"),[n,m]=c.useState([]),[l,r]=c.useState(!0);return c.useEffect(()=>{(async()=>{try{r(!0);const d=await u.listUsers(i),x=await Promise.all(d.map(o=>u.getUser(i,o)));m(x)}finally{r(!1)}})()},[i]),l?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):e.jsxs("div",{className:"users-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h3",{children:s("users.title")}),e.jsx("span",{className:"records-count",children:n.length})]}),n.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("users.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("users.login")}),e.jsx("th",{children:s("users.name")}),e.jsx("th",{children:s("users.email")}),e.jsx("th",{children:s("users.licenses")}),e.jsx("th",{children:s("users.status")})]})}),e.jsx("tbody",{children:n.map(a=>{var d;return e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:a.login}),e.jsxs("td",{children:[a.firstName," ",a.lastName]}),e.jsx("td",{className:"font-mono",children:a.activationEmail}),e.jsx("td",{children:((d=a.licenses)==null?void 0:d.length)||0}),e.jsx("td",{children:e.jsx("span",{className:`badge ${a.status==="ok"?"success":"warning"}`,children:a.status})})]},a.id)})})]})]})}function E({serviceName:i}){const{t:s}=g("web-cloud/office/index"),[n,m]=c.useState([]),[l,r]=c.useState(!0);return c.useEffect(()=>{(async()=>{try{r(!0);const d=await u.listDomains(i),x=await Promise.all(d.map(o=>u.getDomain(i,o)));m(x)}finally{r(!1)}})()},[i]),l?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):e.jsxs("div",{className:"domains-tab",children:[e.jsx("div",{className:"tab-header",children:e.jsx("h3",{children:s("domains.title")})}),n.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("domains.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("domains.name")}),e.jsx("th",{children:s("domains.status")}),e.jsx("th",{children:s("domains.txtRecord")})]})}),e.jsx("tbody",{children:n.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:a.domainName}),e.jsx("td",{children:e.jsx("span",{className:`badge ${a.status==="ok"?"success":"warning"}`,children:a.status})}),e.jsx("td",{className:"font-mono",style:{maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis"},children:a.txtEntry||"-"})]},a.domainName))})]})]})}function U({serviceName:i}){const{t:s}=g("web-cloud/office/index"),[n,m]=c.useState([]),[l,r]=c.useState(!0);return c.useEffect(()=>{(async()=>{try{r(!0);const d=await u.listTasks(i),x=await Promise.all(d.slice(0,50).map(o=>u.getTask(i,o)));x.sort((o,v)=>new Date(v.todoDate).getTime()-new Date(o.todoDate).getTime()),m(x)}finally{r(!1)}})()},[i]),l?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):e.jsxs("div",{className:"tasks-tab",children:[e.jsx("div",{className:"tab-header",children:e.jsx("h3",{children:s("tasks.title")})}),n.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("tasks.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("tasks.function")}),e.jsx("th",{children:s("tasks.status")}),e.jsx("th",{children:s("tasks.date")})]})}),e.jsx("tbody",{children:n.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:a.function}),e.jsx("td",{children:e.jsx("span",{className:`badge ${a.status==="done"?"success":"warning"}`,children:a.status})}),e.jsx("td",{children:new Date(a.todoDate).toLocaleString()})]},a.id))})]})]})}function B(){var w,T;const{t:i}=g("web-cloud/office/index"),{t:s}=g("common"),[n,m]=c.useState([]),[l,r]=c.useState(null),[a,d]=c.useState("users"),[x,o]=c.useState(!0),[v,S]=c.useState(""),$=[{id:"users",labelKey:"tabs.users"},{id:"domains",labelKey:"tabs.domains"},{id:"tasks",labelKey:"tabs.tasks"}],y=c.useCallback(async()=>{try{o(!0);const t=await u.listTenants(),D=t.map(j=>({serviceName:j,loading:!0}));m(D),t.length>0&&!l&&r(t[0]);for(const j of t)try{const p=await u.getTenant(j);m(f=>f.map(b=>b.serviceName===j?{...b,details:p,loading:!1}:b))}catch{m(p=>p.map(f=>f.serviceName===j?{...f,loading:!1}:f))}}finally{o(!1)}},[l]);c.useEffect(()=>{y()},[]);const k=n.filter(t=>t.serviceName.toLowerCase().includes(v.toLowerCase())),N=n.find(t=>t.serviceName===l),L=()=>{if(!l)return null;switch(a){case"users":return e.jsx(C,{serviceName:l});case"domains":return e.jsx(E,{serviceName:l});case"tasks":return e.jsx(U,{serviceName:l});default:return null}};return e.jsxs("div",{className:"email-page",children:[e.jsxs("aside",{className:"email-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h2",{children:i("title")}),e.jsx("span",{className:"count-badge",children:n.length})]}),e.jsx("div",{className:"sidebar-search",children:e.jsx("input",{type:"text",placeholder:i("searchPlaceholder"),value:v,onChange:t=>S(t.target.value)})}),e.jsx("div",{className:"email-list",children:x&&n.length===0?e.jsx("div",{className:"loading-state",children:e.jsx("div",{className:"skeleton-item"})}):k.length===0?e.jsx("div",{className:"empty-state",children:s("empty.title")}):k.map(t=>e.jsxs("button",{className:`email-item ${l===t.serviceName?"active":""}`,onClick:()=>r(t.serviceName),children:[e.jsx("div",{className:"email-icon office",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"})})}),e.jsxs("div",{className:"email-info",children:[e.jsx("span",{className:"email-name",children:t.serviceName}),t.details&&e.jsx("span",{className:"email-meta",children:t.details.displayName})]})]},t.serviceName))})]}),e.jsx("main",{className:"email-main",children:l&&N?e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:((w=N.details)==null?void 0:w.displayName)||l}),e.jsxs("p",{className:"page-description",children:["Microsoft 365 | ",(T=N.details)==null?void 0:T.status]})]}),e.jsxs("button",{className:"btn-refresh",onClick:y,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})}),s("actions.refresh")]})]}),e.jsx("div",{className:"tabs-container",children:e.jsx("div",{className:"tabs-list",children:$.map(t=>e.jsx("button",{className:`tab-btn ${a===t.id?"active":""}`,onClick:()=>d(t.id),children:i(t.labelKey)},t.id))})}),e.jsx("div",{className:"tab-content",children:L()})]}):e.jsxs("div",{className:"no-selection",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18"})}),e.jsx("p",{children:i("selectTenant")})]})})]})}export{B as default};
//# sourceMappingURL=index-BcLZ09BO.js.map
