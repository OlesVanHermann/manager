import{u as f,r as l,j as e}from"./index-svQWOpff.js";import{n as x}from"./network.service-4DKL1RXE.js";import"./api.service-CIh7kdHI.js";function V({serviceName:i}){const{t:r}=f("network/vrack/index"),[o,j]=l.useState([]),[c,m]=l.useState(!0);l.useEffect(()=>{(async()=>{try{m(!0);const[n,d,p]=await Promise.all([x.listVrackDedicatedServers(i).catch(()=>[]),x.listVrackCloudProjects(i).catch(()=>[]),x.listVrackIpLoadbalancing(i).catch(()=>[])]),k=[];n.length&&k.push({type:"dedicatedServer",items:n}),d.length&&k.push({type:"cloudProject",items:d}),p.length&&k.push({type:"loadBalancer",items:p}),j(k)}finally{m(!1)}})()},[i]);const v=a=>({dedicatedServer:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m19.5 0a3 3 0 01-3 3H5.25a3 3 0 01-3-3m19.5 0a3 3 0 00-3-3H5.25a3 3 0 00-3 3"})}),cloudProject:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15a4.5 4.5 0 004.5 4.5H18a3.75 3.75 0 001.332-7.257 3 3 0 00-3.758-3.848 5.25 5.25 0 00-10.233 2.33A4.502 4.502 0 002.25 15z"})}),loadBalancer:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21L3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"})})})[a]||null;if(c)return e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})});const t=o.reduce((a,n)=>a+n.items.length,0);return e.jsxs("div",{className:"services-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h3",{children:r("services.title")}),e.jsx("span",{className:"records-count",children:t})]}),o.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:r("services.empty")})}):e.jsx("div",{className:"service-groups",children:o.map(a=>e.jsxs("div",{className:"service-group",children:[e.jsxs("div",{className:"group-header",children:[e.jsx("div",{className:"group-icon",children:v(a.type)}),e.jsx("h4",{children:r(`services.types.${a.type}`)}),e.jsx("span",{className:"badge info",children:a.items.length})]}),e.jsx("div",{className:"group-items",children:a.items.map(n=>e.jsx("div",{className:"service-item font-mono",children:n},n))})]},a.type))})]})}function M({serviceName:i}){const{t:r}=f("network/vrack/index"),[o,j]=l.useState([]),[c,m]=l.useState(!0);l.useEffect(()=>{(async()=>{try{m(!0);const a=await x.listVrackTasks(i),n=await Promise.all(a.slice(0,50).map(d=>x.getVrackTask(i,d)));n.sort((d,p)=>new Date(p.lastUpdate).getTime()-new Date(d.lastUpdate).getTime()),j(n)}finally{m(!1)}})()},[i]);const v=t=>{const a={done:"success",doing:"info",todo:"warning",init:"warning",cancelled:"inactive"};return e.jsx("span",{className:`badge ${a[t]||"inactive"}`,children:t})};return c?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):e.jsxs("div",{className:"tasks-tab",children:[e.jsx("div",{className:"tab-header",children:e.jsx("h3",{children:r("tasks.title")})}),o.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:r("tasks.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:r("tasks.function")}),e.jsx("th",{children:r("tasks.target")}),e.jsx("th",{children:r("tasks.status")}),e.jsx("th",{children:r("tasks.updated")})]})}),e.jsx("tbody",{children:o.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:t.function}),e.jsx("td",{className:"font-mono",children:t.targetDomain||t.serviceName||"-"}),e.jsx("td",{children:v(t.status)}),e.jsx("td",{children:new Date(t.lastUpdate).toLocaleString()})]},t.id))})]})]})}function D(){var S;const{t:i}=f("network/vrack/index"),{t:r}=f("common"),[o,j]=l.useState([]),[c,m]=l.useState(null),[v,t]=l.useState("services"),[a,n]=l.useState(!0),[d,p]=l.useState(""),k=[{id:"services",labelKey:"tabs.services"},{id:"tasks",labelKey:"tabs.tasks"}],y=l.useCallback(async()=>{try{n(!0);const s=await x.listVracks(),u=s.map(h=>({name:h,loading:!0}));j(u),s.length>0&&!c&&m(s[0]);for(const h of s)try{const[N,g]=await Promise.all([x.getVrack(h),x.getVrackServiceInfos(h)]);j(T=>T.map(b=>b.name===h?{...b,details:N,serviceInfos:g,loading:!1}:b))}catch{j(N=>N.map(g=>g.name===h?{...g,loading:!1}:g))}}finally{n(!1)}},[c]);l.useEffect(()=>{y()},[]);const L=o.filter(s=>{var u,h;return s.name.toLowerCase().includes(d.toLowerCase())||((h=(u=s.details)==null?void 0:u.description)==null?void 0:h.toLowerCase().includes(d.toLowerCase()))}),w=o.find(s=>s.name===c),C=()=>{if(!c)return null;switch(v){case"services":return e.jsx(V,{serviceName:c});case"tasks":return e.jsx(M,{serviceName:c});default:return null}};return e.jsxs("div",{className:"vrack-page",children:[e.jsxs("aside",{className:"vrack-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h2",{children:i("title")}),e.jsx("span",{className:"count-badge",children:o.length})]}),e.jsx("div",{className:"sidebar-search",children:e.jsx("input",{type:"text",placeholder:i("searchPlaceholder"),value:d,onChange:s=>p(s.target.value)})}),e.jsx("div",{className:"vrack-list",children:a&&o.length===0?e.jsx("div",{className:"loading-state",children:e.jsx("div",{className:"skeleton-item"})}):L.length===0?e.jsx("div",{className:"empty-state",children:r("empty.title")}):L.map(s=>{var u;return e.jsxs("button",{className:`vrack-item ${c===s.name?"active":""}`,onClick:()=>m(s.name),children:[e.jsx("div",{className:"vrack-icon",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"})})}),e.jsxs("div",{className:"vrack-info",children:[e.jsx("span",{className:"vrack-name",children:s.name}),((u=s.details)==null?void 0:u.description)&&e.jsx("span",{className:"vrack-desc",children:s.details.description})]})]},s.name)})})]}),e.jsx("main",{className:"vrack-main",children:c&&w?e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:c}),((S=w.details)==null?void 0:S.description)&&e.jsx("p",{className:"page-description",children:w.details.description})]}),e.jsxs("button",{className:"btn-refresh",onClick:y,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})}),r("actions.refresh")]})]}),e.jsx("div",{className:"tabs-container",children:e.jsx("div",{className:"tabs-list",children:k.map(s=>e.jsx("button",{className:`tab-btn ${v===s.id?"active":""}`,onClick:()=>t(s.id),children:i(s.labelKey)},s.id))})}),e.jsx("div",{className:"tab-content",children:C()})]}):e.jsxs("div",{className:"no-selection",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"})}),e.jsx("p",{children:i("selectVrack")})]})})]})}export{D as default};
//# sourceMappingURL=index-CJ4KClrn.js.map
