{"version":3,"file":"cloud.service-Cb_WGcWH.js","sources":["../../src/services/cloud.service.ts"],"sourcesContent":["// ============================================================\n// SERVICE CLOUD - Public Cloud OVHcloud (OpenStack)\n// ============================================================\n\nimport { ovhApi } from './api.service';\n\n// ============================================================\n// TYPES - PROJECT\n// ============================================================\n\nexport interface CloudProject {\n  projectId: string;\n  projectName: string;\n  description: string;\n  planCode: string;\n  unleash: boolean;\n  expiration: string | null;\n  creationDate: string;\n  orderType: string;\n  status: 'creating' | 'deleted' | 'deleting' | 'ok' | 'suspended';\n  access: 'full' | 'restricted';\n}\n\nexport interface CloudProjectServiceInfos {\n  serviceId: number;\n  creation: string;\n  expiration: string;\n  contactAdmin: string;\n  contactTech: string;\n  contactBilling: string;\n  status: string;\n  renew: { automatic: boolean; deleteAtExpiration: boolean; period: number | null };\n}\n\nexport interface CloudQuota {\n  region: string;\n  instance: { maxCores: number; maxInstances: number; maxRam: number; usedCores: number; usedInstances: number; usedRAM: number };\n  volume: { maxGigabytes: number; usedGigabytes: number; volumeCount: number; maxVolumeCount: number };\n  network: { maxNetworks: number; usedNetworks: number; maxSubnets: number; usedSubnets: number; maxFloatingIPs: number; usedFloatingIPs: number };\n}\n\n// ============================================================\n// TYPES - INSTANCE\n// ============================================================\n\nexport interface CloudInstance {\n  id: string;\n  name: string;\n  flavorId: string;\n  imageId: string;\n  sshKeyId: string | null;\n  created: string;\n  region: string;\n  monthlyBilling: { since: string; status: string } | null;\n  status: 'ACTIVE' | 'BUILD' | 'DELETED' | 'ERROR' | 'HARD_REBOOT' | 'MIGRATING' | 'PASSWORD' | 'PAUSED' | 'REBOOT' | 'REBUILD' | 'RESCUE' | 'RESIZE' | 'REVERT_RESIZE' | 'SHELVED' | 'SHELVED_OFFLOADED' | 'SHUTOFF' | 'SOFT_DELETED' | 'STOPPED' | 'SUSPENDED' | 'UNKNOWN' | 'VERIFY_RESIZE';\n  planCode: string;\n  operationIds: string[];\n  currentMonthOutgoingTraffic: number | null;\n  ipAddresses: { ip: string; type: 'private' | 'public'; version: number; networkId: string; gatewayIp: string | null }[];\n}\n\nexport interface CloudFlavor {\n  id: string;\n  name: string;\n  region: string;\n  ram: number;\n  disk: number;\n  vcpus: number;\n  type: string;\n  osType: string;\n  inboundBandwidth: number | null;\n  outboundBandwidth: number | null;\n  available: boolean;\n  planCodes: { hourly: string | null; monthly: string | null };\n}\n\nexport interface CloudImage {\n  id: string;\n  name: string;\n  region: string;\n  visibility: string;\n  type: string;\n  minDisk: number;\n  minRam: number;\n  size: number;\n  creationDate: string;\n  status: string;\n  user: string;\n  flavorType: string | null;\n  tags: string[];\n}\n\nexport interface CloudSshKey {\n  id: string;\n  name: string;\n  publicKey: string;\n  regions: string[];\n}\n\n// ============================================================\n// TYPES - STORAGE\n// ============================================================\n\nexport interface CloudVolume {\n  id: string;\n  name: string;\n  description: string;\n  size: number;\n  region: string;\n  status: 'attaching' | 'available' | 'awaiting-transfer' | 'backing-up' | 'creating' | 'deleting' | 'detaching' | 'downloading' | 'error' | 'error_backing-up' | 'error_deleting' | 'error_extending' | 'error_restoring' | 'extending' | 'in-use' | 'maintenance' | 'reserved' | 'restoring-backup' | 'retyping' | 'uploading';\n  type: 'classic' | 'high-speed' | 'high-speed-gen2';\n  bootable: boolean;\n  creationDate: string;\n  attachedTo: string[];\n  planCode: string | null;\n}\n\nexport interface CloudSnapshot {\n  id: string;\n  name: string;\n  description: string | null;\n  region: string;\n  size: number;\n  status: string;\n  creationDate: string;\n  volumeId: string | null;\n  instanceId: string | null;\n  planCode: string | null;\n}\n\nexport interface CloudContainer {\n  id: string;\n  name: string;\n  region: string;\n  storedBytes: number;\n  storedObjects: number;\n  archive: boolean;\n  containerType: 'private' | 'public' | 'static';\n}\n\n// ============================================================\n// TYPES - NETWORK\n// ============================================================\n\nexport interface CloudNetwork {\n  id: string;\n  name: string;\n  region: string;\n  status: 'ACTIVE' | 'BUILD' | 'BUILDING';\n  type: 'private' | 'public';\n  vlanId: number | null;\n  regions: { region: string; status: string; openstackId: string | null }[];\n}\n\nexport interface CloudSubnet {\n  id: string;\n  cidr: string;\n  dhcpEnabled: boolean;\n  gatewayIp: string | null;\n  ipPools: { dhcp: boolean; end: string; network: string; region: string; start: string }[];\n}\n\n// ============================================================\n// SERVICE\n// ============================================================\n\nclass CloudService {\n  // ---------- Projects ----------\n  async listProjects(): Promise<string[]> {\n    return ovhApi.get<string[]>('/cloud/project');\n  }\n\n  async getProject(projectId: string): Promise<CloudProject> {\n    return ovhApi.get<CloudProject>(`/cloud/project/${projectId}`);\n  }\n\n  async getServiceInfos(projectId: string): Promise<CloudProjectServiceInfos> {\n    return ovhApi.get<CloudProjectServiceInfos>(`/cloud/project/${projectId}/serviceInfos`);\n  }\n\n  async getQuota(projectId: string): Promise<CloudQuota[]> {\n    return ovhApi.get<CloudQuota[]>(`/cloud/project/${projectId}/quota`);\n  }\n\n  // ---------- Instances ----------\n  async listInstances(projectId: string, region?: string): Promise<CloudInstance[]> {\n    let path = `/cloud/project/${projectId}/instance`;\n    if (region) path += `?region=${region}`;\n    return ovhApi.get<CloudInstance[]>(path);\n  }\n\n  async getInstance(projectId: string, instanceId: string): Promise<CloudInstance> {\n    return ovhApi.get<CloudInstance>(`/cloud/project/${projectId}/instance/${instanceId}`);\n  }\n\n  async rebootInstance(projectId: string, instanceId: string, type: 'hard' | 'soft'): Promise<void> {\n    return ovhApi.post<void>(`/cloud/project/${projectId}/instance/${instanceId}/reboot`, { type });\n  }\n\n  async startInstance(projectId: string, instanceId: string): Promise<void> {\n    return ovhApi.post<void>(`/cloud/project/${projectId}/instance/${instanceId}/start`, {});\n  }\n\n  async stopInstance(projectId: string, instanceId: string): Promise<void> {\n    return ovhApi.post<void>(`/cloud/project/${projectId}/instance/${instanceId}/stop`, {});\n  }\n\n  async deleteInstance(projectId: string, instanceId: string): Promise<void> {\n    return ovhApi.delete<void>(`/cloud/project/${projectId}/instance/${instanceId}`);\n  }\n\n  async rescueInstance(projectId: string, instanceId: string, imageId: string): Promise<{ adminPassword: string }> {\n    return ovhApi.post(`/cloud/project/${projectId}/instance/${instanceId}/rescueMode`, { imageId, rescue: true });\n  }\n\n  // ---------- Flavors & Images ----------\n  async listFlavors(projectId: string, region?: string): Promise<CloudFlavor[]> {\n    let path = `/cloud/project/${projectId}/flavor`;\n    if (region) path += `?region=${region}`;\n    return ovhApi.get<CloudFlavor[]>(path);\n  }\n\n  async listImages(projectId: string, region?: string): Promise<CloudImage[]> {\n    let path = `/cloud/project/${projectId}/image`;\n    if (region) path += `?region=${region}`;\n    return ovhApi.get<CloudImage[]>(path);\n  }\n\n  // ---------- SSH Keys ----------\n  async listSshKeys(projectId: string): Promise<CloudSshKey[]> {\n    return ovhApi.get<CloudSshKey[]>(`/cloud/project/${projectId}/sshkey`);\n  }\n\n  async createSshKey(projectId: string, name: string, publicKey: string): Promise<CloudSshKey> {\n    return ovhApi.post<CloudSshKey>(`/cloud/project/${projectId}/sshkey`, { name, publicKey });\n  }\n\n  async deleteSshKey(projectId: string, keyId: string): Promise<void> {\n    return ovhApi.delete<void>(`/cloud/project/${projectId}/sshkey/${keyId}`);\n  }\n\n  // ---------- Volumes ----------\n  async listVolumes(projectId: string, region?: string): Promise<CloudVolume[]> {\n    let path = `/cloud/project/${projectId}/volume`;\n    if (region) path += `?region=${region}`;\n    return ovhApi.get<CloudVolume[]>(path);\n  }\n\n  async getVolume(projectId: string, volumeId: string): Promise<CloudVolume> {\n    return ovhApi.get<CloudVolume>(`/cloud/project/${projectId}/volume/${volumeId}`);\n  }\n\n  async attachVolume(projectId: string, volumeId: string, instanceId: string): Promise<CloudVolume> {\n    return ovhApi.post<CloudVolume>(`/cloud/project/${projectId}/volume/${volumeId}/attach`, { instanceId });\n  }\n\n  async detachVolume(projectId: string, volumeId: string, instanceId: string): Promise<CloudVolume> {\n    return ovhApi.post<CloudVolume>(`/cloud/project/${projectId}/volume/${volumeId}/detach`, { instanceId });\n  }\n\n  // ---------- Snapshots ----------\n  async listSnapshots(projectId: string, region?: string): Promise<CloudSnapshot[]> {\n    let path = `/cloud/project/${projectId}/snapshot`;\n    if (region) path += `?region=${region}`;\n    return ovhApi.get<CloudSnapshot[]>(path);\n  }\n\n  async createInstanceSnapshot(projectId: string, instanceId: string, snapshotName: string): Promise<void> {\n    return ovhApi.post<void>(`/cloud/project/${projectId}/instance/${instanceId}/snapshot`, { snapshotName });\n  }\n\n  async deleteSnapshot(projectId: string, snapshotId: string): Promise<void> {\n    return ovhApi.delete<void>(`/cloud/project/${projectId}/snapshot/${snapshotId}`);\n  }\n\n  // ---------- Object Storage ----------\n  async listContainers(projectId: string): Promise<CloudContainer[]> {\n    return ovhApi.get<CloudContainer[]>(`/cloud/project/${projectId}/storage`);\n  }\n\n  async getContainer(projectId: string, containerId: string): Promise<CloudContainer> {\n    return ovhApi.get<CloudContainer>(`/cloud/project/${projectId}/storage/${containerId}`);\n  }\n\n  // ---------- Networks ----------\n  async listNetworks(projectId: string): Promise<CloudNetwork[]> {\n    return ovhApi.get<CloudNetwork[]>(`/cloud/project/${projectId}/network/private`);\n  }\n\n  async getNetwork(projectId: string, networkId: string): Promise<CloudNetwork> {\n    return ovhApi.get<CloudNetwork>(`/cloud/project/${projectId}/network/private/${networkId}`);\n  }\n\n  async listSubnets(projectId: string, networkId: string): Promise<CloudSubnet[]> {\n    return ovhApi.get<CloudSubnet[]>(`/cloud/project/${projectId}/network/private/${networkId}/subnet`);\n  }\n\n  // ---------- Regions ----------\n  async listRegions(projectId: string): Promise<string[]> {\n    return ovhApi.get<string[]>(`/cloud/project/${projectId}/region`);\n  }\n}\n\nexport const cloudService = new CloudService();\n"],"names":["CloudService","ovhApi","projectId","region","path","instanceId","type","imageId","name","publicKey","keyId","volumeId","snapshotName","snapshotId","containerId","networkId","cloudService"],"mappings":"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"}