import{u as b,r,j as s}from"./index-svQWOpff.js";import{o as u}from"./api.service-CIh7kdHI.js";/* empty css               */class L{async listServices(){return u.get("/email/zimbra")}async getService(e){return u.get(`/email/zimbra/${e}`)}async getServiceInfos(e){return u.get(`/email/zimbra/${e}/serviceInfos`)}async listAccounts(e){return u.get(`/email/zimbra/${e}/account`)}async getAccount(e,t){return u.get(`/email/zimbra/${e}/account/${t}`)}async listDomains(e){return u.get(`/email/zimbra/${e}/domain`)}async getDomain(e,t){return u.get(`/email/zimbra/${e}/domain/${t}`)}async listAliases(e){return u.get(`/email/zimbra/${e}/alias`)}async getAlias(e,t){return u.get(`/email/zimbra/${e}/alias/${t}`)}async listTasks(e){return u.get(`/email/zimbra/${e}/task`)}async getTask(e,t){return u.get(`/email/zimbra/${e}/task/${t}`)}}const x=new L;function z({serviceId:l}){const{t:e}=b("web-cloud/zimbra/index"),[t,m]=r.useState([]),[c,d]=r.useState(!0);r.useEffect(()=>{(async()=>{try{d(!0);const h=await x.listAccounts(l),o=[];for(let j=0;j<h.length;j+=5){const N=h.slice(j,j+5),y=await Promise.all(N.map(v=>x.getAccount(l,v)));o.push(...y),m([...o])}}finally{d(!1)}})()},[l]);const a=i=>`${(i.used/1024/1024/1024).toFixed(2)} / ${(i.available/1024/1024/1024).toFixed(0)} GB`;return c&&t.length===0?s.jsx("div",{className:"tab-loading",children:s.jsx("div",{className:"skeleton-block"})}):s.jsxs("div",{className:"accounts-tab",children:[s.jsxs("div",{className:"tab-header",children:[s.jsx("h3",{children:e("accounts.title")}),s.jsx("span",{className:"records-count",children:t.length})]}),t.length===0?s.jsx("div",{className:"empty-state",children:s.jsx("p",{children:e("accounts.empty")})}):s.jsxs("table",{className:"data-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:e("accounts.email")}),s.jsx("th",{children:e("accounts.name")}),s.jsx("th",{children:e("accounts.offer")}),s.jsx("th",{children:e("accounts.quota")}),s.jsx("th",{children:e("accounts.lastLogin")}),s.jsx("th",{children:e("accounts.status")})]})}),s.jsx("tbody",{children:t.map(i=>s.jsxs("tr",{children:[s.jsx("td",{className:"font-mono",children:i.email}),s.jsx("td",{children:i.displayName||`${i.firstName} ${i.lastName}`}),s.jsx("td",{children:s.jsx("span",{className:"badge info",children:i.offer})}),s.jsx("td",{children:a(i.quota)}),s.jsx("td",{children:i.lastLogonDate?new Date(i.lastLogonDate).toLocaleDateString():"-"}),s.jsx("td",{children:s.jsx("span",{className:`badge ${i.status==="ok"?"success":"warning"}`,children:i.status})})]},i.id))})]})]})}function T({serviceId:l}){const{t:e}=b("web-cloud/zimbra/index"),[t,m]=r.useState([]),[c,d]=r.useState(!0);return r.useEffect(()=>{(async()=>{try{d(!0);const i=await x.listDomains(l),h=await Promise.all(i.map(o=>x.getDomain(l,o)));m(h)}finally{d(!1)}})()},[l]),c?s.jsx("div",{className:"tab-loading",children:s.jsx("div",{className:"skeleton-block"})}):s.jsxs("div",{className:"domains-tab",children:[s.jsx("div",{className:"tab-header",children:s.jsx("h3",{children:e("domains.title")})}),t.length===0?s.jsx("div",{className:"empty-state",children:s.jsx("p",{children:e("domains.empty")})}):s.jsxs("table",{className:"data-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:e("domains.name")}),s.jsx("th",{children:e("domains.type")}),s.jsx("th",{children:e("domains.status")})]})}),s.jsx("tbody",{children:t.map(a=>s.jsxs("tr",{children:[s.jsx("td",{className:"font-mono",children:a.name}),s.jsx("td",{children:a.type}),s.jsx("td",{children:s.jsx("span",{className:`badge ${a.status==="ok"?"success":"warning"}`,children:a.status})})]},a.id))})]})]})}function D({serviceId:l}){const{t:e}=b("web-cloud/zimbra/index"),[t,m]=r.useState([]),[c,d]=r.useState(!0);return r.useEffect(()=>{(async()=>{try{d(!0);const i=await x.listAliases(l),h=await Promise.all(i.map(o=>x.getAlias(l,o)));m(h)}finally{d(!1)}})()},[l]),c?s.jsx("div",{className:"tab-loading",children:s.jsx("div",{className:"skeleton-block"})}):s.jsxs("div",{className:"aliases-tab",children:[s.jsx("div",{className:"tab-header",children:s.jsx("h3",{children:e("aliases.title")})}),t.length===0?s.jsx("div",{className:"empty-state",children:s.jsx("p",{children:e("aliases.empty")})}):s.jsxs("table",{className:"data-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:e("aliases.alias")}),s.jsx("th",{children:e("aliases.target")}),s.jsx("th",{children:e("aliases.status")})]})}),s.jsx("tbody",{children:t.map(a=>s.jsxs("tr",{children:[s.jsx("td",{className:"font-mono",children:a.alias}),s.jsx("td",{className:"font-mono",children:a.targetAccountId}),s.jsx("td",{children:s.jsx("span",{className:`badge ${a.status==="ok"?"success":"warning"}`,children:a.status})})]},a.id))})]})]})}function C({serviceId:l}){const{t:e}=b("web-cloud/zimbra/index"),[t,m]=r.useState([]),[c,d]=r.useState(!0);return r.useEffect(()=>{(async()=>{try{d(!0);const i=await x.listTasks(l),h=await Promise.all(i.slice(0,50).map(o=>x.getTask(l,o)));h.sort((o,j)=>new Date(j.createdAt).getTime()-new Date(o.createdAt).getTime()),m(h)}finally{d(!1)}})()},[l]),c?s.jsx("div",{className:"tab-loading",children:s.jsx("div",{className:"skeleton-block"})}):s.jsxs("div",{className:"tasks-tab",children:[s.jsx("div",{className:"tab-header",children:s.jsx("h3",{children:e("tasks.title")})}),t.length===0?s.jsx("div",{className:"empty-state",children:s.jsx("p",{children:e("tasks.empty")})}):s.jsxs("table",{className:"data-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:e("tasks.type")}),s.jsx("th",{children:e("tasks.status")}),s.jsx("th",{children:e("tasks.created")}),s.jsx("th",{children:e("tasks.message")})]})}),s.jsx("tbody",{children:t.map(a=>s.jsxs("tr",{children:[s.jsx("td",{className:"font-mono",children:a.type}),s.jsx("td",{children:s.jsx("span",{className:`badge ${a.status==="done"?"success":a.status==="error"?"error":"warning"}`,children:a.status})}),s.jsx("td",{children:new Date(a.createdAt).toLocaleString()}),s.jsx("td",{children:a.message||"-"})]},a.id))})]})]})}function M(){const{t:l}=b("web-cloud/zimbra/index"),{t:e}=b("common"),[t,m]=r.useState([]),[c,d]=r.useState(null),[a,i]=r.useState("accounts"),[h,o]=r.useState(!0),[j,N]=r.useState(""),y=[{id:"accounts",labelKey:"tabs.accounts"},{id:"domains",labelKey:"tabs.domains"},{id:"aliases",labelKey:"tabs.aliases"},{id:"tasks",labelKey:"tabs.tasks"}],v=r.useCallback(async()=>{try{o(!0);const n=await x.listServices(),A=n.map(f=>({id:f,loading:!0}));m(A),n.length>0&&!c&&d(n[0]);for(const f of n)try{const w=await x.getService(f);m(p=>p.map(k=>k.id===f?{...k,details:w,loading:!1}:k))}catch{m(w=>w.map(p=>p.id===f?{...p,loading:!1}:p))}}finally{o(!1)}},[c]);r.useEffect(()=>{v()},[]);const S=t.filter(n=>n.id.toLowerCase().includes(j.toLowerCase())),g=t.find(n=>n.id===c),$=()=>{if(!c)return null;switch(a){case"accounts":return s.jsx(z,{serviceId:c});case"domains":return s.jsx(T,{serviceId:c});case"aliases":return s.jsx(D,{serviceId:c});case"tasks":return s.jsx(C,{serviceId:c});default:return null}};return s.jsxs("div",{className:"email-page",children:[s.jsxs("aside",{className:"email-sidebar",children:[s.jsxs("div",{className:"sidebar-header",children:[s.jsx("h2",{children:l("title")}),s.jsx("span",{className:"count-badge",children:t.length})]}),s.jsx("div",{className:"sidebar-search",children:s.jsx("input",{type:"text",placeholder:l("searchPlaceholder"),value:j,onChange:n=>N(n.target.value)})}),s.jsx("div",{className:"email-list",children:h&&t.length===0?s.jsx("div",{className:"loading-state",children:s.jsx("div",{className:"skeleton-item"})}):S.length===0?s.jsx("div",{className:"empty-state",children:e("empty.title")}):S.map(n=>s.jsxs("button",{className:`email-item ${c===n.id?"active":""}`,onClick:()=>d(n.id),children:[s.jsx("div",{className:"email-icon zimbra",children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"})})}),s.jsxs("div",{className:"email-info",children:[s.jsx("span",{className:"email-name",children:n.id}),n.details&&s.jsxs("span",{className:"email-meta",children:[n.details.offer," | ",n.details.numberOfAccounts," comptes"]})]})]},n.id))})]}),s.jsx("main",{className:"email-main",children:c&&g?s.jsxs(s.Fragment,{children:[s.jsxs("header",{className:"page-header",children:[s.jsxs("div",{children:[s.jsx("h1",{children:c}),g.details&&s.jsxs("p",{className:"page-description",children:["Zimbra ",g.details.offer," | ",g.details.numberOfAccounts," comptes | ",g.details.status]})]}),s.jsxs("button",{className:"btn-refresh",onClick:v,children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})}),e("actions.refresh")]})]}),s.jsx("div",{className:"tabs-container",children:s.jsx("div",{className:"tabs-list",children:y.map(n=>s.jsx("button",{className:`tab-btn ${a===n.id?"active":""}`,onClick:()=>i(n.id),children:l(n.labelKey)},n.id))})}),s.jsx("div",{className:"tab-content",children:$()})]}):s.jsxs("div",{className:"no-selection",children:[s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75"})}),s.jsx("p",{children:l("selectService")})]})})]})}export{M as default};
//# sourceMappingURL=index-slwtuJBC.js.map
