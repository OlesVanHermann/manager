{"version":3,"file":"dedicated.service-B72KBYll.js","sources":["../../src/services/dedicated.service.ts"],"sourcesContent":["// ============================================================\n// SERVICE DEDICATED - Serveurs dedies OVHcloud\n// ============================================================\n\nimport { ovhApi } from './api.service';\n\n// ============================================================\n// TYPES\n// ============================================================\n\nexport interface DedicatedServer {\n  name: string;\n  commercialRange: string;\n  datacenter: string;\n  ip: string;\n  linkSpeed: number;\n  os: string;\n  professionalUse: boolean;\n  rack: string;\n  region: string;\n  rescueMail: string | null;\n  reverse: string;\n  rootDevice: string | null;\n  serverId: number;\n  state: 'error' | 'hacked' | 'hackedBlocked' | 'ok';\n  supportLevel: 'critical' | 'fastpath' | 'gs' | 'pro' | 'technic';\n  bootId: number | null;\n  monitoring: boolean;\n  newUpgradeSystem: boolean;\n  noIntervention: boolean;\n  powerState: 'poweroff' | 'poweron';\n}\n\nexport interface DedicatedServerServiceInfos {\n  serviceId: number;\n  creation: string;\n  expiration: string;\n  contactAdmin: string;\n  contactTech: string;\n  contactBilling: string;\n  status: string;\n  renew: { automatic: boolean; deleteAtExpiration: boolean; period: number | null };\n}\n\nexport interface DedicatedServerHardware {\n  bootMode: 'legacy' | 'uefi' | 'uefiLegacy';\n  coresPerProcessor: number;\n  defaultHardwareRaidSize: { unit: string; value: number } | null;\n  defaultHardwareRaidType: string | null;\n  description: string | null;\n  diskGroups: { defaultHardwareRaidSize: { unit: string; value: number } | null; defaultHardwareRaidType: string | null; description: string; diskGroupId: number; diskSize: { unit: string; value: number }; diskType: string; numberOfDisks: number; raidController: string | null }[];\n  expansionCards: { description: string; type: string }[] | null;\n  formFactor: string;\n  memorySize: { unit: string; value: number };\n  motherboard: string;\n  numberOfProcessors: number;\n  processorArchitecture: string;\n  processorName: string;\n  threadsPerProcessor: number;\n  usbKeys: { unit: string; value: number }[] | null;\n}\n\nexport interface DedicatedServerIp {\n  ip: string;\n  ipBlock: string;\n  version: 'v4' | 'v6';\n  reverse: string | null;\n  type: 'primary' | 'secondary' | 'failover';\n  virtualMac: string | null;\n}\n\nexport interface DedicatedServerTask {\n  taskId: number;\n  function: string;\n  status: 'cancelled' | 'customerError' | 'doing' | 'done' | 'init' | 'ovhError' | 'todo';\n  startDate: string;\n  doneDate: string | null;\n  lastUpdate: string;\n  comment: string | null;\n}\n\nexport interface DedicatedServerIntervention {\n  interventionId: number;\n  date: string;\n  type: string;\n}\n\nexport interface DedicatedServerNetboot {\n  bootId: number;\n  bootType: 'harddisk' | 'internal' | 'ipxeCustomerScript' | 'network' | 'rescue';\n  description: string;\n  kernel: string;\n}\n\nexport interface DedicatedServerIpmi {\n  activated: boolean;\n  supportedFeatures: { kvmoverip: boolean; serialOverLanSshKey: boolean; serialOverLanUrl: boolean };\n}\n\nexport interface DedicatedServerVrack {\n  vrack: string;\n  state: 'activating' | 'inMaintenance' | 'ok';\n}\n\nexport interface DedicatedServerBackupFtp {\n  ftpBackupName: string;\n  quota: { unit: string; value: number };\n  readOnlyDate: string | null;\n  type: string;\n  usage: { unit: string; value: number };\n}\n\n// ============================================================\n// SERVICE\n// ============================================================\n\nclass DedicatedService {\n  async listServers(): Promise<string[]> {\n    return ovhApi.get<string[]>('/dedicated/server');\n  }\n\n  async getServer(serviceName: string): Promise<DedicatedServer> {\n    return ovhApi.get<DedicatedServer>(`/dedicated/server/${serviceName}`);\n  }\n\n  async getServiceInfos(serviceName: string): Promise<DedicatedServerServiceInfos> {\n    return ovhApi.get<DedicatedServerServiceInfos>(`/dedicated/server/${serviceName}/serviceInfos`);\n  }\n\n  // ---------- Hardware ----------\n  async getHardware(serviceName: string): Promise<DedicatedServerHardware> {\n    return ovhApi.get<DedicatedServerHardware>(`/dedicated/server/${serviceName}/specifications/hardware`);\n  }\n\n  // ---------- IPs ----------\n  async listIps(serviceName: string): Promise<string[]> {\n    return ovhApi.get<string[]>(`/dedicated/server/${serviceName}/ips`);\n  }\n\n  // ---------- Network ----------\n  async listVracks(serviceName: string): Promise<string[]> {\n    return ovhApi.get<string[]>(`/dedicated/server/${serviceName}/vrack`);\n  }\n\n  async getVrack(serviceName: string, vrack: string): Promise<DedicatedServerVrack> {\n    return ovhApi.get<DedicatedServerVrack>(`/dedicated/server/${serviceName}/vrack/${vrack}`);\n  }\n\n  // ---------- IPMI ----------\n  async getIpmi(serviceName: string): Promise<DedicatedServerIpmi> {\n    return ovhApi.get<DedicatedServerIpmi>(`/dedicated/server/${serviceName}/features/ipmi`);\n  }\n\n  async startIpmiSession(serviceName: string, type: 'kvmipJnlp' | 'kvmipHtml5URL' | 'serialOverLanURL'): Promise<{ value: string }> {\n    return ovhApi.post<{ value: string }>(`/dedicated/server/${serviceName}/features/ipmi/access`, { type });\n  }\n\n  async rebootIpmi(serviceName: string): Promise<DedicatedServerTask> {\n    return ovhApi.post<DedicatedServerTask>(`/dedicated/server/${serviceName}/features/ipmi/resetInterface`, {});\n  }\n\n  // ---------- Netboot ----------\n  async listNetboots(serviceName: string): Promise<number[]> {\n    return ovhApi.get<number[]>(`/dedicated/server/${serviceName}/boot`);\n  }\n\n  async getNetboot(serviceName: string, bootId: number): Promise<DedicatedServerNetboot> {\n    return ovhApi.get<DedicatedServerNetboot>(`/dedicated/server/${serviceName}/boot/${bootId}`);\n  }\n\n  // ---------- Backup FTP ----------\n  async getBackupFtp(serviceName: string): Promise<DedicatedServerBackupFtp | null> {\n    try {\n      return await ovhApi.get<DedicatedServerBackupFtp>(`/dedicated/server/${serviceName}/features/backupFTP`);\n    } catch { return null; }\n  }\n\n  async createBackupFtp(serviceName: string): Promise<DedicatedServerTask> {\n    return ovhApi.post<DedicatedServerTask>(`/dedicated/server/${serviceName}/features/backupFTP`, {});\n  }\n\n  async getBackupFtpPassword(serviceName: string): Promise<DedicatedServerTask> {\n    return ovhApi.post<DedicatedServerTask>(`/dedicated/server/${serviceName}/features/backupFTP/password`, {});\n  }\n\n  // ---------- Actions ----------\n  async reboot(serviceName: string): Promise<DedicatedServerTask> {\n    return ovhApi.post<DedicatedServerTask>(`/dedicated/server/${serviceName}/reboot`, {});\n  }\n\n  async reinstall(serviceName: string, templateName: string): Promise<DedicatedServerTask> {\n    return ovhApi.post<DedicatedServerTask>(`/dedicated/server/${serviceName}/install/start`, { templateName });\n  }\n\n  // ---------- Tasks ----------\n  async listTasks(serviceName: string): Promise<number[]> {\n    return ovhApi.get<number[]>(`/dedicated/server/${serviceName}/task`);\n  }\n\n  async getTask(serviceName: string, taskId: number): Promise<DedicatedServerTask> {\n    return ovhApi.get<DedicatedServerTask>(`/dedicated/server/${serviceName}/task/${taskId}`);\n  }\n\n  // ---------- Interventions ----------\n  async listInterventions(serviceName: string): Promise<number[]> {\n    return ovhApi.get<number[]>(`/dedicated/server/${serviceName}/intervention`);\n  }\n\n  async getIntervention(serviceName: string, interventionId: number): Promise<DedicatedServerIntervention> {\n    return ovhApi.get<DedicatedServerIntervention>(`/dedicated/server/${serviceName}/intervention/${interventionId}`);\n  }\n}\n\nexport const dedicatedService = new DedicatedService();\n"],"names":["DedicatedService","ovhApi","serviceName","vrack","type","bootId","templateName","taskId","interventionId","dedicatedService"],"mappings":"8CAoHA,MAAMA,CAAiB,CACrB,MAAM,aAAiC,CACrC,OAAOC,EAAO,IAAc,mBAAmB,CACjD,CAEA,MAAM,UAAUC,EAA+C,CAC7D,OAAOD,EAAO,IAAqB,qBAAqBC,CAAW,EAAE,CACvE,CAEA,MAAM,gBAAgBA,EAA2D,CAC/E,OAAOD,EAAO,IAAiC,qBAAqBC,CAAW,eAAe,CAChG,CAGA,MAAM,YAAYA,EAAuD,CACvE,OAAOD,EAAO,IAA6B,qBAAqBC,CAAW,0BAA0B,CACvG,CAGA,MAAM,QAAQA,EAAwC,CACpD,OAAOD,EAAO,IAAc,qBAAqBC,CAAW,MAAM,CACpE,CAGA,MAAM,WAAWA,EAAwC,CACvD,OAAOD,EAAO,IAAc,qBAAqBC,CAAW,QAAQ,CACtE,CAEA,MAAM,SAASA,EAAqBC,EAA8C,CAChF,OAAOF,EAAO,IAA0B,qBAAqBC,CAAW,UAAUC,CAAK,EAAE,CAC3F,CAGA,MAAM,QAAQD,EAAmD,CAC/D,OAAOD,EAAO,IAAyB,qBAAqBC,CAAW,gBAAgB,CACzF,CAEA,MAAM,iBAAiBA,EAAqBE,EAAsF,CAChI,OAAOH,EAAO,KAAwB,qBAAqBC,CAAW,wBAAyB,CAAE,KAAAE,EAAM,CACzG,CAEA,MAAM,WAAWF,EAAmD,CAClE,OAAOD,EAAO,KAA0B,qBAAqBC,CAAW,gCAAiC,EAAE,CAC7G,CAGA,MAAM,aAAaA,EAAwC,CACzD,OAAOD,EAAO,IAAc,qBAAqBC,CAAW,OAAO,CACrE,CAEA,MAAM,WAAWA,EAAqBG,EAAiD,CACrF,OAAOJ,EAAO,IAA4B,qBAAqBC,CAAW,SAASG,CAAM,EAAE,CAC7F,CAGA,MAAM,aAAaH,EAA+D,CAChF,GAAI,CACF,OAAO,MAAMD,EAAO,IAA8B,qBAAqBC,CAAW,qBAAqB,CACzG,MAAQ,CAAE,OAAO,IAAM,CACzB,CAEA,MAAM,gBAAgBA,EAAmD,CACvE,OAAOD,EAAO,KAA0B,qBAAqBC,CAAW,sBAAuB,EAAE,CACnG,CAEA,MAAM,qBAAqBA,EAAmD,CAC5E,OAAOD,EAAO,KAA0B,qBAAqBC,CAAW,+BAAgC,EAAE,CAC5G,CAGA,MAAM,OAAOA,EAAmD,CAC9D,OAAOD,EAAO,KAA0B,qBAAqBC,CAAW,UAAW,EAAE,CACvF,CAEA,MAAM,UAAUA,EAAqBI,EAAoD,CACvF,OAAOL,EAAO,KAA0B,qBAAqBC,CAAW,iBAAkB,CAAE,aAAAI,EAAc,CAC5G,CAGA,MAAM,UAAUJ,EAAwC,CACtD,OAAOD,EAAO,IAAc,qBAAqBC,CAAW,OAAO,CACrE,CAEA,MAAM,QAAQA,EAAqBK,EAA8C,CAC/E,OAAON,EAAO,IAAyB,qBAAqBC,CAAW,SAASK,CAAM,EAAE,CAC1F,CAGA,MAAM,kBAAkBL,EAAwC,CAC9D,OAAOD,EAAO,IAAc,qBAAqBC,CAAW,eAAe,CAC7E,CAEA,MAAM,gBAAgBA,EAAqBM,EAA8D,CACvG,OAAOP,EAAO,IAAiC,qBAAqBC,CAAW,iBAAiBM,CAAc,EAAE,CAClH,CACF,CAEO,MAAMC,EAAmB,IAAIT"}