import{u as b,r,j as e}from"./index-svQWOpff.js";import{o as u}from"./api.service-CIh7kdHI.js";/* empty css               */class A{async listServices(){return u.get("/email/exchange")}async getService(a,s){return u.get(`/email/exchange/${a}/service/${s}`)}async getServiceInfos(a,s){return u.get(`/email/exchange/${a}/service/${s}/serviceInfos`)}async listAccounts(a,s){return u.get(`/email/exchange/${a}/service/${s}/account`)}async getAccount(a,s,n){return u.get(`/email/exchange/${a}/service/${s}/account/${n}`)}async listSharedAccounts(a,s){return u.get(`/email/exchange/${a}/service/${s}/sharedAccount`)}async getSharedAccount(a,s,n){return u.get(`/email/exchange/${a}/service/${s}/sharedAccount/${n}`)}async listGroups(a,s){return u.get(`/email/exchange/${a}/service/${s}/mailingList`)}async getGroup(a,s,n){return u.get(`/email/exchange/${a}/service/${s}/mailingList/${n}`)}async listResources(a,s){return u.get(`/email/exchange/${a}/service/${s}/resourceAccount`)}async getResource(a,s,n){return u.get(`/email/exchange/${a}/service/${s}/resourceAccount/${n}`)}async listDomains(a,s){return u.get(`/email/exchange/${a}/service/${s}/domain`)}async getDomain(a,s,n){return u.get(`/email/exchange/${a}/service/${s}/domain/${n}`)}async listTasks(a,s){return u.get(`/email/exchange/${a}/service/${s}/task`)}async getTask(a,s,n){return u.get(`/email/exchange/${a}/service/${s}/task/${n}`)}}const g=new A;function I({org:c,service:a}){const{t:s}=b("web-cloud/exchange/index"),[n,o]=r.useState([]),[j,d]=r.useState(!0);r.useEffect(()=>{(async()=>{try{d(!0);const m=await g.listAccounts(c,a),x=[];for(let f=0;f<m.length;f+=5){const $=m.slice(f,f+5),N=await Promise.all($.map(k=>g.getAccount(c,a,k)));x.push(...N),o([...x])}}finally{d(!1)}})()},[c,a]);const t=l=>`${(l/(1024*1024*1024)).toFixed(2)} GB`;return j&&n.length===0?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):e.jsxs("div",{className:"accounts-tab",children:[e.jsxs("div",{className:"tab-header",children:[e.jsx("h3",{children:s("accounts.title")}),e.jsx("span",{className:"records-count",children:n.length})]}),n.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("accounts.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("accounts.email")}),e.jsx("th",{children:s("accounts.name")}),e.jsx("th",{children:s("accounts.usage")}),e.jsx("th",{children:"Outlook"}),e.jsx("th",{children:s("accounts.status")})]})}),e.jsx("tbody",{children:n.map(l=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:l.primaryEmailAddress}),e.jsx("td",{children:l.displayName}),e.jsxs("td",{children:[t(l.currentUsage)," / ",t(l.quota)]}),e.jsx("td",{children:e.jsx("span",{className:`badge ${l.outlookLicense?"success":"inactive"}`,children:l.outlookLicense?"✓":"✗"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${l.state==="ok"?"success":"warning"}`,children:l.state})})]},l.primaryEmailAddress))})]})]})}function E({org:c,service:a}){const{t:s}=b("web-cloud/exchange/index"),[n,o]=r.useState([]),[j,d]=r.useState(!0);return r.useEffect(()=>{(async()=>{try{d(!0);const l=await g.listGroups(c,a),m=await Promise.all(l.map(x=>g.getGroup(c,a,x)));o(m)}finally{d(!1)}})()},[c,a]),j?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):e.jsxs("div",{className:"groups-tab",children:[e.jsx("div",{className:"tab-header",children:e.jsx("h3",{children:s("groups.title")})}),n.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("groups.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("groups.address")}),e.jsx("th",{children:s("groups.name")}),e.jsx("th",{children:s("groups.members")}),e.jsx("th",{children:s("groups.status")})]})}),e.jsx("tbody",{children:n.map(t=>{var l;return e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:t.mailingListAddress}),e.jsx("td",{children:t.displayName}),e.jsx("td",{children:((l=t.members)==null?void 0:l.length)||0}),e.jsx("td",{children:e.jsx("span",{className:`badge ${t.state==="ok"?"success":"warning"}`,children:t.state})})]},t.mailingListAddress)})})]})]})}function T({org:c,service:a}){const{t:s}=b("web-cloud/exchange/index"),[n,o]=r.useState([]),[j,d]=r.useState(!0);return r.useEffect(()=>{(async()=>{try{d(!0);const l=await g.listResources(c,a),m=await Promise.all(l.map(x=>g.getResource(c,a,x)));o(m)}finally{d(!1)}})()},[c,a]),j?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):e.jsxs("div",{className:"resources-tab",children:[e.jsx("div",{className:"tab-header",children:e.jsx("h3",{children:s("resources.title")})}),n.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("resources.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("resources.email")}),e.jsx("th",{children:s("resources.name")}),e.jsx("th",{children:s("resources.type")}),e.jsx("th",{children:s("resources.capacity")}),e.jsx("th",{children:s("resources.status")})]})}),e.jsx("tbody",{children:n.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:t.resourceEmailAddress}),e.jsx("td",{children:t.displayName}),e.jsx("td",{children:e.jsx("span",{className:`badge ${t.type==="room"?"info":"warning"}`,children:t.type})}),e.jsx("td",{children:t.capacity||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${t.state==="ok"?"success":"warning"}`,children:t.state})})]},t.resourceEmailAddress))})]})]})}function C({org:c,service:a}){const{t:s}=b("web-cloud/exchange/index"),[n,o]=r.useState([]),[j,d]=r.useState(!0);return r.useEffect(()=>{(async()=>{try{d(!0);const l=await g.listDomains(c,a),m=await Promise.all(l.map(x=>g.getDomain(c,a,x)));o(m)}finally{d(!1)}})()},[c,a]),j?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):e.jsxs("div",{className:"domains-tab",children:[e.jsx("div",{className:"tab-header",children:e.jsx("h3",{children:s("domains.title")})}),n.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("domains.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("domains.name")}),e.jsx("th",{children:s("domains.type")}),e.jsx("th",{children:"MX"}),e.jsx("th",{children:"SRV"}),e.jsx("th",{children:s("domains.main")}),e.jsx("th",{children:s("domains.status")})]})}),e.jsx("tbody",{children:n.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:t.name}),e.jsx("td",{children:t.type}),e.jsx("td",{children:e.jsx("span",{className:`badge ${t.mxIsValid?"success":"error"}`,children:t.mxIsValid?"✓":"✗"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${t.srvIsValid?"success":"error"}`,children:t.srvIsValid?"✓":"✗"})}),e.jsx("td",{children:t.main?"★":""}),e.jsx("td",{children:e.jsx("span",{className:`badge ${t.state==="ok"?"success":"warning"}`,children:t.state})})]},t.name))})]})]})}function D({org:c,service:a}){const{t:s}=b("web-cloud/exchange/index"),[n,o]=r.useState([]),[j,d]=r.useState(!0);return r.useEffect(()=>{(async()=>{try{d(!0);const l=await g.listTasks(c,a),m=await Promise.all(l.slice(0,50).map(x=>g.getTask(c,a,x)));o(m)}finally{d(!1)}})()},[c,a]),j?e.jsx("div",{className:"tab-loading",children:e.jsx("div",{className:"skeleton-block"})}):e.jsxs("div",{className:"tasks-tab",children:[e.jsx("div",{className:"tab-header",children:e.jsx("h3",{children:s("tasks.title")})}),n.length===0?e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:s("tasks.empty")})}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("tasks.function")}),e.jsx("th",{children:s("tasks.status")}),e.jsx("th",{children:s("tasks.date")})]})}),e.jsx("tbody",{children:n.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-mono",children:t.function}),e.jsx("td",{children:e.jsx("span",{className:`badge ${t.status==="done"?"success":"warning"}`,children:t.status})}),e.jsx("td",{children:new Date(t.todoDate).toLocaleString()})]},t.id))})]})]})}function P(){const{t:c}=b("web-cloud/exchange/index"),{t:a}=b("common"),[s,n]=r.useState([]),[o,j]=r.useState(null),[d,t]=r.useState("accounts"),[l,m]=r.useState(!0),[x,f]=r.useState(""),$=[{id:"accounts",labelKey:"tabs.accounts"},{id:"groups",labelKey:"tabs.groups"},{id:"resources",labelKey:"tabs.resources"},{id:"domains",labelKey:"tabs.domains"},{id:"tasks",labelKey:"tabs.tasks"}],N=r.useCallback(async()=>{try{m(!0);const i=await g.listServices(),S=i.map(p=>{const[y,v]=p.includes("/")?p.split("/"):[p,p];return{fullId:p,org:y,service:v,loading:!0}});n(S),i.length>0&&!o&&j(i[0]);for(const p of S)try{const y=await g.getService(p.org,p.service);n(v=>v.map(w=>w.fullId===p.fullId?{...w,details:y,loading:!1}:w))}catch{n(y=>y.map(v=>v.fullId===p.fullId?{...v,loading:!1}:v))}}finally{m(!1)}},[o]);r.useEffect(()=>{N()},[]);const k=s.filter(i=>i.fullId.toLowerCase().includes(x.toLowerCase())),h=s.find(i=>i.fullId===o),L=()=>{if(!o||!h)return null;switch(d){case"accounts":return e.jsx(I,{org:h.org,service:h.service});case"groups":return e.jsx(E,{org:h.org,service:h.service});case"resources":return e.jsx(T,{org:h.org,service:h.service});case"domains":return e.jsx(C,{org:h.org,service:h.service});case"tasks":return e.jsx(D,{org:h.org,service:h.service});default:return null}};return e.jsxs("div",{className:"email-page",children:[e.jsxs("aside",{className:"email-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h2",{children:c("title")}),e.jsx("span",{className:"count-badge",children:s.length})]}),e.jsx("div",{className:"sidebar-search",children:e.jsx("input",{type:"text",placeholder:c("searchPlaceholder"),value:x,onChange:i=>f(i.target.value)})}),e.jsx("div",{className:"email-list",children:l&&s.length===0?e.jsx("div",{className:"loading-state",children:e.jsx("div",{className:"skeleton-item"})}):k.length===0?e.jsx("div",{className:"empty-state",children:a("empty.title")}):k.map(i=>e.jsxs("button",{className:`email-item ${o===i.fullId?"active":""}`,onClick:()=>j(i.fullId),children:[e.jsx("div",{className:"email-icon exchange",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"})})}),e.jsxs("div",{className:"email-info",children:[e.jsx("span",{className:"email-name",children:i.service}),i.details&&e.jsxs("span",{className:"email-meta",children:[i.details.offer," | ",i.details.state]})]})]},i.fullId))})]}),e.jsx("main",{className:"email-main",children:o&&h?e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{children:h.service}),h.details&&e.jsxs("p",{className:"page-description",children:["Exchange ",h.details.offer," | ",h.details.state]})]}),e.jsxs("button",{className:"btn-refresh",onClick:N,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"})}),a("actions.refresh")]})]}),e.jsx("div",{className:"tabs-container",children:e.jsx("div",{className:"tabs-list",children:$.map(i=>e.jsx("button",{className:`tab-btn ${d===i.id?"active":""}`,onClick:()=>t(i.id),children:c(i.labelKey)},i.id))})}),e.jsx("div",{className:"tab-content",children:L()})]}):e.jsxs("div",{className:"no-selection",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75"})}),e.jsx("p",{children:c("selectService")})]})})]})}export{P as default};
//# sourceMappingURL=index-B1ZaQf1Y.js.map
