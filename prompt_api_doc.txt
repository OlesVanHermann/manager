# PROMPT API DOC - Documentation des APIs OVHcloud

## 1. Objectif

GÃ©nÃ©rer une **documentation statique HTML** des APIs OVHcloud organisÃ©e par navigation (NAV1.NAV2.NAV3).

Pour chaque page du Manager (NAV3), lister tous les appels API utilisÃ©s avec leurs paramÃ¨tres, exemples et rÃ©ponses.

---

## 2. Sources et destinations

| Ã‰lÃ©ment | Chemin |
|---------|--------|
| **Old Manager (source)** | `/home/ubuntu/manager/` |
| **New Manager (rÃ©fÃ©rence)** | `/home/ubuntu/aiapp/frontend/src/` |
| **Documentation (destination)** | `/var/www/aiapp/doc/` |
| **URL publique** | `https://manager.di2amp.com/doc/` |

---

## 3. Les 8 NAV1 (ordre d'affichage)

| # | NAV1 | Dossier frontend | Description |
|---|------|------------------|-------------|
| 1 | **home** | `pages/home/` | Compte, Facturation, Support, Carbon, API |
| 2 | **public-cloud** | `pages/public-cloud/` | Project, Instances, Storage, K8s, AI, Databases, Registry, LB |
| 3 | **private-cloud** | `pages/private-cloud/` | VMware, Nutanix, SAP, Veeam, Managed Bare Metal |
| 4 | **bare-metal** | `pages/bare-metal/` | Dedicated, VPS, Housing, NAS-HA, NetApp |
| 5 | **web-cloud** | `pages/web-cloud/` | Domains, Hosting, Emails, VoIP, SMS, Fax, Access, WordPress |
| 6 | **network** | `pages/network/` | IP, vRack, CDN, Cloud Connect, vRack Services, Load Balancer |
| 7 | **iam** | `pages/iam/` | IdentitÃ©s, Policies, Logs, Secret, OKMS, DBaaS-Logs |
| 8 | **licenses** | `pages/license/` | Windows, cPanel, Plesk, SQL Server, Virtuozzo, DirectAdmin |

---

## 3.1 Types d'API

| Type | Base URL | Description |
|------|----------|-------------|
| **apiv6** | `/1.0/...` | API REST classique OVHcloud |
| **2API** | `/v2/...` | Nouvelle API (IAM, services modernes) |
| **Engin** | `/engine/...` | API interne (baremetal, PCI) |

## 3.2 RÃ©gions

| RÃ©gion | Base URL | Subsidiaires |
|--------|----------|--------------|
| **EU** | `eu.api.ovh.com` | FR, DE, ES, IT, PL, PT, UK, IE, NL, BE, CZ |
| **CA** | `ca.api.ovh.com` | CA, QC, WE, WS |
| **US** | `us.api.ovh.com` | US |

---

## 4. Arborescence de la documentation

### 4.1 Structure des fichiers

```
/var/www/aiapp/doc/
â”œâ”€â”€ index.html                          # Application SPA (3 panneaux)
â”œâ”€â”€ style.css                           # Styles avec Design System OVH
â”‚
â”œâ”€â”€ data/                               # JSON des endpoints par NAV1
â”‚   â”œâ”€â”€ A-home.json                     # Endpoints home
â”‚   â”œâ”€â”€ B-iam.json                      # Endpoints IAM
â”‚   â”œâ”€â”€ C-license.json                  # Endpoints licenses
â”‚   â”œâ”€â”€ D-public-cloud.json             # Endpoints public-cloud
â”‚   â”œâ”€â”€ E-private-cloud.json            # Endpoints private-cloud
â”‚   â”œâ”€â”€ F-bare-metal.json               # Endpoints bare-metal
â”‚   â”œâ”€â”€ G-web-cloud.json                # Endpoints web-cloud
â”‚   â”œâ”€â”€ H-network.json                  # Endpoints network
â”‚   â””â”€â”€ I-unused.json                   # Endpoints orphelins
â”‚   â”‚
â”‚   â”œâ”€â”€ home/                           # DÃ©tails par NAV2
â”‚   â”‚   â”œâ”€â”€ account.json
â”‚   â”‚   â”œâ”€â”€ billing.json
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ web-cloud/
â”‚   â”‚   â”œâ”€â”€ domains.json
â”‚   â”‚   â”œâ”€â”€ hosting.json
â”‚   â”‚   â”œâ”€â”€ emails.json
â”‚   â”‚   â”œâ”€â”€ voip.json
â”‚   â”‚   â”œâ”€â”€ access.json
â”‚   â”‚   â””â”€â”€ wordpress.json
â”‚   â””â”€â”€ ...
```

### 4.2 RÃ©sumÃ© des 9 NAV1

| ID | NAV1 | PrÃ©fixes API principaux |
|----|------|-------------------------|
| A | home | `/me/*`, `/services`, `/support/*` |
| B | iam | `/iam/*`, `/me/identity/*`, `/me/logs`, `/okms/*`, `/secret/*` |
| C | license | `/license/*` |
| D | public-cloud | `/cloud/project/*` |
| E | private-cloud | `/dedicatedCloud/*`, `/nutanix/*`, `/veeam/*` |
| F | bare-metal | `/dedicated/server/*`, `/vps/*`, `/dedicated/nasha/*` |
| G | web-cloud | `/domain/*`, `/hosting/*`, `/email/*`, `/telephony/*`, `/sms/*` |
| H | network | `/ip/*`, `/vrack/*`, `/cdn/*`, `/ipLoadbalancing/*` |
| I | unused | Endpoints non rattachÃ©s |

---

## 5. Layout de la documentation (4 barres + 2 colonnes)

### 5.1 Structure visuelle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  API Docs â”‚ Home â”‚ Public Cloud â”‚ Private Cloud â”‚ Bare Metal â”‚ Web Cloud â”‚ ... â”‚ [EU â–¼]
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  domains â”‚ emails â”‚ hosting â”‚ wordpress â”‚ voip â”‚ access                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [General] [DNS] [Expert]  â”‚                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  GET /domain/{serviceName}                 [apiv6]  â”‚
â”‚  ğŸ” Rechercher...         â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                     â”‚
â”‚                           â”‚  Description                                        â”‚
â”‚  /domain                  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  /domain/{serviceName}    â”‚  RÃ©cupÃ¨re les dÃ©tails du domaine.                   â”‚
â”‚  /domain/{}/serviceInfos  â”‚                                                     â”‚
â”‚  /domain/{}/contact       â”‚  Type d'API: apiv6                                  â”‚
â”‚  /domain/{}/task          â”‚  RÃ©gions: EU, CA, US                                â”‚
â”‚                           â”‚  Page: General                                      â”‚
â”‚                           â”‚                                                     â”‚
â”‚                           â”‚  Base URL                                           â”‚
â”‚                           â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                           â”‚  https://eu.api.ovh.com/1.0/domain/{serviceName}    â”‚
â”‚                           â”‚                                                     â”‚
â”‚  SIDEBAR 30%              â”‚  CONTENU 70%                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Documentation OVHcloud â”‚ Console API â”‚ GitHub Manager â”‚ Status API             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Les 4 barres horizontales

| Barre | Hauteur | Contenu |
|-------|---------|---------|
| **NAV1** | 50px | 8 onglets (Home â†’ Licenses) + Switch rÃ©gion [EU/CA/US] |
| **NAV2** | 40px | Sous-sections du NAV1 actif (account, billing, support...) |
| **NAV3** | 36px | Pages/onglets au sein du NAV2 (General, DNS, Expert...) |
| **Footer** | 50px | Liens externes |

### 5.3 Comportement

| Zone | Contenu | Interaction |
|------|---------|-------------|
| **Barre NAV1** | 8 onglets + [EUâ–¼] | Clic â†’ charge NAV2, met Ã  jour sidebar |
| **Barre NAV2** | Sous-sections | Clic â†’ charge NAV3, filtre endpoints |
| **Barre NAV3** | Pages/onglets | Clic â†’ filtre endpoints par catÃ©gorie |
| **Switch rÃ©gion** | EU / CA / US | Change la base URL dans les exemples |
| **Sidebar (30%)** | Liste endpoints filtrÃ©s par NAV3 | Clic â†’ affiche doc dÃ©taillÃ©e |
| **Contenu (70%)** | Doc endpoint + badge type API | Scroll indÃ©pendant |
| **Footer** | Liens externes | Navigation externe |

### 5.4 Badge type API

| Badge | Couleur | Signification |
|-------|---------|---------------|
| `[apiv6]` | Vert | API REST classique `/1.0/` |
| `[2API]` | Bleu | Nouvelle API `/v2/` |
| `[Engin]` | Orange | API interne `/engine/` |

### 5.5 Footer - Liens externes

| Lien | URL |
|------|-----|
| Documentation OVHcloud | https://docs.ovh.com/ |
| Console API | https://api.ovh.com/console/ |
| GitHub Manager | https://github.com/ovh/manager |
| Status API | https://status.ovh.com/ |

---

## 6. Format JSON des endpoints

Structure JSON par NAV1.NAV2 avec type d'API et rÃ©gion.

### 6.1 Emplacement

```
/var/www/aiapp/doc/data/
â”œâ”€â”€ A-home.json              # Liste simple tous endpoints home
â”œâ”€â”€ home/
â”‚   â”œâ”€â”€ account.json         # DÃ©tails endpoints account
â”‚   â”œâ”€â”€ billing.json         # DÃ©tails endpoints billing
â”‚   â””â”€â”€ ...
â”œâ”€â”€ G-web-cloud.json         # Liste simple tous endpoints web-cloud
â”œâ”€â”€ web-cloud/
â”‚   â”œâ”€â”€ domains.json         # DÃ©tails endpoints domains
â”‚   â”œâ”€â”€ hosting.json
â”‚   â”œâ”€â”€ emails.json
â”‚   â”œâ”€â”€ voip.json
â”‚   â”œâ”€â”€ access.json
â”‚   â””â”€â”€ wordpress.json
â””â”€â”€ ...
```

### 6.2 Format JSON simple (fichiers principaux X-nav1.json)

```json
[
  {"path": "/domain", "method": "GET"},
  {"path": "/domain/{}", "method": "GET"},
  {"path": "/domain/{}", "method": "PUT"}
]
```

### 6.3 Format JSON enrichi (fichiers nav1/nav2.json)

```json
[
  {
    "path": "/domain",
    "method": "GET",
    "api_type": "apiv6",
    "nav3": "General",
    "description": "List registered domains"
  },
  {
    "path": "/domain/{serviceName}",
    "method": "GET",
    "api_type": "apiv6",
    "nav3": "General",
    "description": "Get domain details"
  },
  {
    "path": "/domain/zone/{zoneName}/record",
    "method": "GET",
    "api_type": "apiv6",
    "nav3": "DNS",
    "description": "List DNS zone records"
  }
]
```

---

## 7. MÃ©thodologie d'extraction

### 7.1 Sources Ã  analyser

| Source | Chemin | Contenu |
|--------|--------|---------|
| **New Manager services** | `/home/ubuntu/aiapp/frontend/src/services/*.ts` | Appels API actuels |
| **New Manager pages** | `/home/ubuntu/aiapp/frontend/src/pages/**/*.tsx` | Utilisation des services |
| **Old Manager modules** | `/home/ubuntu/manager/packages/manager/modules/` | Appels API legacy |
| **Old Manager apps** | `/home/ubuntu/manager/packages/manager/apps/` | Apps complÃ¨tes |

### 7.2 Commandes d'extraction

```bash
# Chercher les appels API dans new_manager
cd /home/ubuntu/aiapp/frontend/src
grep -rn "fetch\|api\." services/

# Chercher les appels API dans old_manager
cd /home/ubuntu/manager
grep -rn "api\.get\|api\.post\|api\.put\|api\.delete" packages/manager/

# Chercher les endpoints spÃ©cifiques
grep -rn '"/me/' packages/manager/
grep -rn '"/domain/' packages/manager/
grep -rn '"/hosting/' packages/manager/

# Chercher les interfaces TypeScript
grep -rn "export interface" packages/manager/modules/billing/src/
```

### 7.3 Fichiers clÃ©s par NAV1

| NAV1 | Chemins old_manager |
|------|---------------------|
| A-home | `modules/account/`, `modules/billing/`, `apps/hub/` |
| B-iam | `apps/iam/`, `modules/iam/` |
| C-license | `apps/dedicated/`, `modules/license/` |
| D-public-cloud | `apps/pci/`, `modules/pci/` |
| E-private-cloud | `apps/dedicated/`, `modules/dedicatedCloud/` |
| F-bare-metal | `apps/dedicated/`, `apps/vps/`, `modules/nasha/` |
| G-web-cloud | `apps/web/`, `modules/hosting/`, `modules/email-domain/`, `apps/telecom/` |
| H-network | `apps/dedicated/`, `modules/ip/`, `modules/vrack/` |

---

## 8. Workflow

### 8.1 Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   old_manager   â”‚â”€â”€â”€â”€â–¶â”‚    DISCOVER     â”‚â”€â”€â”€â”€â–¶â”‚     EXTRACT     â”‚â”€â”€â”€â”€â–¶â”‚    GENERATE     â”‚
â”‚   new_manager   â”‚     â”‚  (list calls)   â”‚     â”‚   (JSON data)   â”‚     â”‚  (HTML pages)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     SOURCE                 ENDPOINTS              METADATA              DOCUMENTATION
   grep + read            liste brute            JSON enrichi            HTML navigable
```

### 8.2 Commandes

```
----------+----------------------------+------------------------------------------
action    | params                     | description
----------+----------------------------+------------------------------------------
init      |                            | reload prompt_api_doc.txt
menu      |                            | afficher ce menu
----------+----------------------------+------------------------------------------
discover  | <NAV1>                     | lister tous les endpoints d'un NAV1
discover  | <NAV1>.<NAV2>              | lister endpoints d'un NAV2
discover  | <NAV1>.<NAV2>.<NAV3>       | lister endpoints d'une page
discover  | all                        | lister TOUS les endpoints
----------+----------------------------+------------------------------------------
extract   | <NAV1>.<NAV2>.<NAV3>       | crÃ©er JSON pour une page
extract   | <NAV1>.<NAV2>              | crÃ©er JSON pour une section
extract   | <NAV1>                     | crÃ©er JSON pour un univers
----------+----------------------------+------------------------------------------
generate  | <NAV1>.<NAV2>.<NAV3>       | gÃ©nÃ©rer HTML d'une page
generate  | <NAV1>.<NAV2>              | gÃ©nÃ©rer HTML d'une section
generate  | <NAV1>                     | gÃ©nÃ©rer HTML d'un univers
generate  | all                        | gÃ©nÃ©rer toute la documentation
----------+----------------------------+------------------------------------------
qualify   | <endpoint>                 | rattacher un endpoint orphelin Ã  un NAV
----------+----------------------------+------------------------------------------
status    |                            | Ã©tat de la documentation
status    | <NAV1>                     | Ã©tat d'un univers
orphans   |                            | lister les endpoints non rattachÃ©s
----------+----------------------------+------------------------------------------
deploy    |                            | dÃ©ployer vers /var/www/aiapp/doc/
----------+----------------------------+------------------------------------------
```

---

## 9. RÃ¨gles critiques

### 9.1 Extraction

- **TOUJOURS** vÃ©rifier les types TypeScript pour input/output
- **TOUJOURS** inclure un exemple de rÃ©ponse rÃ©aliste
- **JAMAIS** inventer des champs non prÃ©sents dans le code
- **TOUJOURS** rattacher chaque endpoint Ã  un NAV2

### 9.2 Qualification

- Chaque endpoint DOIT Ãªtre rattachÃ© Ã  exactement UN NAV2
- Si un endpoint est utilisÃ© par plusieurs NAV2, le documenter dans chaque
- Le type d'API (apiv6, 2API, Engin) doit Ãªtre spÃ©cifiÃ©

### 9.3 GÃ©nÃ©ration

- **Un fichier JSON par NAV1.NAV2**
- **Nommage** : `{nav1}/{nav2}.json`
- Inclure le champ `api_type` pour chaque endpoint

### 9.4 Organisation

- Index par NAV1 listant tous les NAV2
- Chaque NAV2 contient ses endpoints
- Switch rÃ©gion (EU/CA/US) dans le header

---

## 10. RÃ©fÃ©rence des endpoints

Les endpoints sont maintenant stockÃ©s dans les fichiers JSON :

| NAV1 | Fichier principal | Fichiers dÃ©taillÃ©s |
|------|-------------------|-------------------|
| A-home | `data/A-home.json` | `data/home/*.json` |
| B-iam | `data/B-iam.json` | `data/iam/*.json` |
| C-license | `data/C-license.json` | `data/licenses/*.json` |
| D-public-cloud | `data/D-public-cloud.json` | `data/public-cloud/*.json` |
| E-private-cloud | `data/E-private-cloud.json` | `data/private-cloud/*.json` |
| F-bare-metal | `data/F-bare-metal.json` | `data/bare-metal/*.json` |
| G-web-cloud | `data/G-web-cloud.json` | `data/web-cloud/*.json` |
| H-network | `data/H-network.json` | `data/network/*.json` |
| I-unused | `data/I-unused.json` | - |

Pour consulter les endpoints, utiliser :
```bash
cat /var/www/aiapp/doc/data/G-web-cloud.json | jq '.'
cat /var/www/aiapp/doc/data/web-cloud/domains.json | jq '.'
```

---

## 11. NAV2 par NAV1

| NAV1 | NAV2 (ordre d'affichage) |
|------|--------------------------|
| **home** | account, billing, support, carbon, api |
| **public-cloud** | project, instances, block-storage, object-storage, databases, kubernetes, ai, registry, load-balancer |
| **private-cloud** | vmware, nutanix, sap, veeam |
| **bare-metal** | dedicated, vps, housing, nasha, netapp |
| **web-cloud** | domains, emails, hosting, wordpress, voip, access |
| **network** | ip, vrack, vrack-services, cdn, cloud-connect, load-balancer, security |
| **iam** | identities, policies, logs, secret, okms, dbaas-logs |
| **licenses** | windows, cpanel, plesk, sqlserver, virtuozzo, directadmin, cloudlinux, office |
