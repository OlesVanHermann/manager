# PROMPT: Réorganisation des SVG et TXT old_manager vers structure new_manager

## CONTEXTE
Tu dois réorganiser les fichiers SVG et TXT de `old_manager_svg/` vers `old2new_manager_svg/` en suivant la structure NAV1/NAV2/NAV3 du new_manager.

## TYPES DE FICHIERS TRAITÉS

| Type | Renommage | Description |
|------|-----------|-------------|
| `.svg` | **OUI** | Retirer préfixe `old_manager.` + segments NAV redondants |
| `.txt` | **NON** | Conserver le nom original complet (avec `old_manager.`) |

Les fichiers `.svg` et `.txt` partageant le même chemin logique se retrouvent dans le **même répertoire de destination**.

## STRUCTURE CIBLE (basée sur src/pages/ du new_manager)

```
old2new_manager_svg/
├── public-cloud/
│   ├── ai/
│   ├── block-storage/
│   ├── databases/
│   ├── instances/
│   ├── kubernetes/
│   ├── load-balancer/
│   ├── object-storage/
│   ├── project/
│   └── registry/
├── bare-metal/
│   ├── dedicated/
│   ├── housing/
│   ├── nasha/
│   ├── netapp/
│   └── vps/
├── web-cloud/
│   ├── access/
│   ├── domains/
│   ├── emails/
│   ├── hebergement/
│   ├── hosting/
│   └── telecom/
├── network/
│   ├── cdn/
│   ├── cloud-connect/
│   ├── ip/
│   ├── load-balancer/
│   ├── security/
│   ├── vrack/
│   └── vrack-services/
├── iam/
│   ├── dbaas-logs/
│   ├── general/
│   ├── hsm/
│   ├── logs/
│   ├── metrics/
│   ├── okms/
│   └── secret/
├── general/
│   ├── account/
│   ├── api/
│   ├── billing/
│   ├── carbon/
│   └── support/
├── license/
│   ├── cloudlinux/
│   ├── cpanel/
│   ├── directadmin/
│   ├── plesk/
│   ├── sqlserver/
│   ├── virtuozzo/
│   └── windows/
├── private-cloud/
│   ├── managed-baremetal/
│   ├── nutanix/
│   ├── sap/
│   ├── veeam/
│   └── vmware/
└── _unmapped/
```

## RÈGLES DE MAPPING (old → new)

### Renommages de NAV1
| old_manager NAV1 | new_manager NAV1 | Notes |
|------------------|------------------|-------|
| `billing` | `general/billing` | |
| `account` | `general/account` | |
| `support` | `general/support` | |
| `home.account` | `general/account` | |
| `home.billing` | `general/billing` | |
| `home.support` | `general/support` | |
| `home.hub` | `general` | Dashboard |
| `home.catalog` | `_unmapped` | Obsolète |
| `home.procedures` | `_unmapped` | Obsolète |
| `home.iam` | `iam/general` | |
| `web` | `web-cloud` | |
| `web.hosting` | `web-cloud/hosting` | |
| `web.email` | `web-cloud/emails` | |
| `web.domain` | `web-cloud/domains` | |
| `telecom` | `web-cloud/telecom` | |
| `telecom.pack` | `web-cloud/access` | Pack xDSL |
| `telecom.xdsl` | `web-cloud/access` | |
| `telecom.telephony` | `web-cloud/telecom` | |
| `telecom.fax` | `web-cloud/telecom` | |
| `signup` | `_unmapped` | Obsolète |
| `catalog` | `_unmapped` | Obsolète |
| `changelog` | `_unmapped` | Obsolète |
| `procedures` | `_unmapped` | Obsolète |
| `hub` | `general` | |
| `dedicated` | `bare-metal/dedicated` | |
| `vps` | `bare-metal/vps` | |

### Mappings spéciaux IAM
| old_manager | new_manager |
|-------------|-------------|
| `iam.policies` | `iam/general` |
| `iam.identities` | `iam/general` |
| `iam.users` | `iam/general` |
| `iam.groups` | `iam/general` |
| `iam.service-accounts` | `iam/general` |
| `iam.sso` | `iam/general` |
| `iam.api-keys` | `iam/general` |
| `iam.conditions` | `iam/general` |
| `iam.dashboard` | `iam/general` |
| `iam.tag-manager` | `iam/general` |
| `iam.components` | `iam/general` |
| `iam.kms` | `iam/okms` |
| `iam.secret-manager` | `iam/secret` |
| `iam.logs` | `iam/logs` |

### Mappings bare-metal
| old_manager | new_manager |
|-------------|-------------|
| `bare-metal.dedicated` | `bare-metal/dedicated` |
| `bare-metal.vps` | `bare-metal/vps` |
| `bare-metal.housing` | `bare-metal/housing` |
| `bare-metal.nasha` | `bare-metal/nasha` |
| `bare-metal.nas-ha` | `bare-metal/nasha` |
| `bare-metal.netapp` | `bare-metal/netapp` |
| `bare-metal.cda` | `_unmapped` |
| `bare-metal.cdn` | `network/cdn` |
| `bare-metal.ip` | `network/ip` |
| `bare-metal.vrack` | `network/vrack` |
| `bare-metal.license` | `license` |
| `bare-metal.dedicated-cloud` | `private-cloud/vmware` |
| `bare-metal.nutanix` | `private-cloud/nutanix` |
| `bare-metal.load-balancer` | `network/load-balancer` |
| `bare-metal.network-security` | `network/security` |

## STRATÉGIE DE NOMMAGE DES FICHIERS

### Pour les fichiers SVG (renommage)

Utiliser la **Stratégie 2 (nom adapté)** :
- Retirer le préfixe `old_manager.`
- Retirer les segments NAV1.NAV2 redondants avec le chemin
- Conserver le reste du nom

#### Algorithme de renommage SVG
```
Fichier: old_manager.{nav1}.{nav2}.{rest}.svg
Destination: {mapped_nav1}/{mapped_nav2}/
Nouveau nom: {rest}.svg

Si rest est vide → utiliser "index.svg"
Si rest contient des sous-niveaux → les garder avec des points
```

#### Exemples SVG
| Fichier original | Destination | Nouveau nom |
|------------------|-------------|-------------|
| `old_manager.public-cloud.instances.tab-network.svg` | `public-cloud/instances/` | `tab-network.svg` |
| `old_manager.public-cloud.instances.svg` | `public-cloud/instances/` | `index.svg` |
| `old_manager.billing.invoices.svg` | `general/billing/` | `invoices.svg` |
| `old_manager.telecom.telephony.line.calls.svg` | `web-cloud/telecom/` | `telephony.line.calls.svg` |
| `old_manager.home.account.tab-security.svg` | `general/account/` | `tab-security.svg` |
| `old_manager.iam.policies.tab-my-policies.svg` | `iam/general/` | `policies.tab-my-policies.svg` |

### Pour les fichiers TXT (pas de renommage)

- Conserver le nom **complet et original** (y compris le préfixe `old_manager.`)
- Seul le répertoire de destination change selon les règles de mapping

#### Algorithme pour TXT
```
Fichier: old_manager.{nav1}.{nav2}.{rest}.txt
Destination: {mapped_nav1}/{mapped_nav2}/
Nouveau nom: old_manager.{nav1}.{nav2}.{rest}.txt (IDENTIQUE)
```

#### Exemples TXT
| Fichier original | Destination | Nouveau nom |
|------------------|-------------|-------------|
| `old_manager.public-cloud.instances.tab-network.txt` | `public-cloud/instances/` | `old_manager.public-cloud.instances.tab-network.txt` |
| `old_manager.billing.invoices.txt` | `general/billing/` | `old_manager.billing.invoices.txt` |
| `old_manager.iam.policies.tab-my-policies.txt` | `iam/general/` | `old_manager.iam.policies.tab-my-policies.txt` |
| `old_manager.home.catalog.svg.txt` | `_unmapped/` | `old_manager.home.catalog.svg.txt` |

## SCRIPT À GÉNÉRER

Le script doit :
1. Créer l'arborescence `old2new_manager_svg/` avec tous les répertoires
2. Parcourir tous les fichiers `.svg` ET `.txt` de `old_manager_svg/`
3. Appliquer les règles de mapping pour déterminer le répertoire destination
4. Pour les SVG : copier avec le nouveau nom (renommage)
5. Pour les TXT : copier avec le nom original (pas de renommage)
6. Générer un log `old2new_mapping.log` avec le format :
   ```
   [SVG] SOURCE → DESTINATION
   [TXT] SOURCE → DESTINATION
   ```
7. Lister les fichiers non mappés dans `_unmapped/`
8. Afficher des statistiques séparées pour SVG et TXT

## COMMANDE D'EXÉCUTION

```bash
# Depuis le répertoire contenant old_manager_svg/
bash old2new_svg_generate.sh
```

## VÉRIFICATION POST-EXÉCUTION

```bash
# Compter les fichiers SVG (via index pré-générés)
echo "=== SVG ==="
grep "\.svg$" /home/ubuntu/old_manager_svg_files.txt | wc -l
grep "\.svg$" /home/ubuntu/old2new_manager_svg_files.txt | wc -l

# Compter les fichiers TXT (via index pré-générés)
echo "=== TXT ==="
grep "\.txt$" /home/ubuntu/old_manager_svg_files.txt | wc -l
grep "\.txt$" /home/ubuntu/old2new_manager_svg_files.txt | wc -l

# Vérifier les non mappés
ls -la old2new_manager_svg/_unmapped/

# Voir le log
cat old2new_mapping.log | head -50

# Vérifier qu'un SVG et TXT associés sont dans le même dossier
ls -la old2new_manager_svg/public-cloud/instances/
```

## EXEMPLE DE SORTIE ATTENDUE

```
========================================
 SVG & TXT Reorganization: old → new manager
========================================

[1/4] Création de l'arborescence cible...
   ✓ Arborescence créée

[2/4] Recherche des fichiers...
   ✓ 1320 fichiers SVG trouvés
   ✓ 245 fichiers TXT trouvés

[3/4] Traitement des fichiers...
   Traité: 200 / 1565
   Traité: 400 / 1565
   ...
   ✓ Traitement terminé

[4/4] Résumé

========================================
 RÉSULTAT
========================================
 --- SVG ---
 Total source:     1320
 Mappés:           1250
 Non mappés:         70

 --- TXT ---
 Total source:      245
 Mappés:            230
 Non mappés:         15

 --- TOTAL ---
 Total traités:    1565

 Log: old2new_mapping.log
 Destination: old2new_manager_svg/
```
