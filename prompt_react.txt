# CONSIGNES REACT - NEW MANAGER OVHcloud

## 1. Contexte du projet

Interface **New Manager** pour la gestion des services OVHcloud : Cloud, Hébergement Web, Email, DNS, Domaines, VPS, Serveurs dédiés.

Ce projet est une **réécriture progressive** du "old manager" existant (monorepo Angular + React OVHcloud).

---

## 2. Règles de travail

1. **Lire et analyser** le code fourni. Ne pas partager l'analyse sauf demande explicite.
2. **Ne rien faire** sans autorisation.
3. **Attendre les consignes** avant toute action.
4. **Générer le code** dans le chat en utilisant **un seul bloc de code** avec copier-coller.
5. **Encapsuler** les commandes `tee` dans un bloc markdown.
6. **Migration** : utiliser "la méthode" → `grep` → localiser → extraire → générer.
7. **Conserver** le design system existant, ne pas réinventer les composants UI.
8. **Erreur 401 API** : rediriger vers l'auth OVH, pas d'erreur affichée.

---

## 3. Structure des répertoires

| Élément | Chemin |
|---------|--------|
| **New Manager (Frontend React)** | `/home/ubuntu/aiapp/frontend/src/` |
| **Old Manager (Référence)** | `/home/ubuntu/manager/` |

---

## 4. New Manager

### 4.1 Archive

```bash
cd /home/ubuntu/
tar -cvf new_manager.tar --exclude='*2025*' aiapp/frontend/src/
```

### 4.2 Build

**Développement :**
```bash
cd /home/ubuntu/aiapp/frontend
npm run build:dev
/home/ubuntu/aiapp/scripts/D1-build_frontend_dev.sh
```

**Production :**
```bash
cd /home/ubuntu/aiapp/frontend
npm run build:prod
/home/ubuntu/aiapp/scripts/D2-promote_dev_to_prod.sh
# ou
/home/ubuntu/aiapp/scripts/D2-promote_dev_to_prod.sh --from-dist
```

### 4.3 Arborescence du framework

```
/home/ubuntu/aiapp/frontend/src/
├── App.tsx                    # App principale + routing
├── main.tsx                   # Bootstrap React
├── index.css                  # Styles globaux
│
├── components/                # Composants réutilisables
│   ├── Sidebar/               # Navigation principale
│   └── AccountSidebar/        # Sidebar compte utilisateur
│
├── pages/                     # Pages/Routes
│   ├── Home.tsx
│   ├── Login.tsx
│   ├── Account/               # Mon compte
│   ├── Billing/               # Factures
│   ├── Services/              # Services
│   └── Placeholder/           # Pages placeholder
│
├── contexts/                  # React Contexts
│   └── AuthContext.tsx
│
├── services/                  # Services API
│   ├── auth.service.ts
│   ├── account.service.ts
│   ├── billing.service.ts
│   ├── services.service.ts
│   └── security.service.ts
│
├── types/                     # TypeScript types
│   ├── auth.types.ts
│   └── services.types.ts
│
└── design-system/             # Design System
    ├── index.ts               # Constantes TypeScript
    ├── globals.css
    ├── tokens.css
    ├── tokens/index.ts
    ├── PATTERNS.md            # Couleurs, typo, spacing
    ├── COMPONENTS.md          # Catalogue composants
    ├── DESIGN_TOKENS.md       # Patterns d'usage
    └── ICONS.md               # Icônes disponibles
```

---

## 5. Design System (OVH Classic Blue)

### 5.1 Couleurs primaires (tokens.css)

| Token | Valeur | Usage |
|-------|--------|-------|
| `--color-primary-500` | `#0050D7` | Bleu OVH principal |
| `--color-primary-600` | `#003DA8` | Hover/Active |
| `--color-primary-700` | `#002B7A` | Pressed |
| `--color-primary-800` | `#122844` | Dark |
| `--color-primary-300` | `#85A5FF` | Light |
| `--color-primary-100` | `#D6E4FF` | Background |

### 5.2 Règle d'utilisation

Utiliser **uniquement** les variables CSS **sans fallback** :

```css
/* ✅ BON */
color: var(--color-primary-500);

/* ❌ MAUVAIS */
color: var(--color-primary-500, #0050D7);
```

### 5.3 Stack technique

| Composant | Source |
|-----------|--------|
| Design System | `@ovh-ux/muk` (Manager UI Kit) |
| Base ODS | `@ovhcloud/ods-react` v19.2.1 |
| Thèmes | `@ovhcloud/ods-themes` v19.2.1 |
| CSS | Tailwind CSS |

---

## 6. Old Manager (Référence)

### 6.1 Structure principale

```
/home/ubuntu/manager/packages/manager/
├── core/          # Utilitaires fondamentaux
├── modules/       # Modules métier réutilisables
└── apps/          # Applications complètes
```

### 6.2 Core (`packages/manager/core/`)

```
api, application, ovh-product-icons, request-tagger,
shell-client, sso, url-builder, utils
```

### 6.3 Modules (`packages/manager/modules/`)

```
account, billing, billing-components, iam, support, order,
exchange, emailpro, email-domain, nasha, netapp, pci,
vps, vrack, carbon-calculator, mfa-enrollment, ...
```

### 6.4 Apps (`packages/manager/apps/`)

```
account, billing, dedicated, dedicated-servers, hub,
iam, pci, public-cloud, vps, vrack, web, web-hosting,
support, sms, telecom, exchange, email-pro, ...
```

---

## 7. Conventions de code

| Règle | Application |
|-------|-------------|
| **TypeScript** | Mode strict |
| **Composants** | Fonctionnels avec hooks |
| **Nommage composants** | PascalCase |
| **Nommage fonctions/variables** | camelCase |
| **Structure fichiers** | Un composant = un fichier |
| **Exports** | Nommés (préférés aux exports default) |
| **Appels API** | Dans `services/`, jamais dans les composants |

---

## 8. Référence rapide

```bash
# Localiser dans l'ancien manager
cd /home/ubuntu/manager && grep -r "pattern" packages/

# Créer archive new manager
cd /home/ubuntu && tar -cvf new_manager.tar --exclude='*2025*' aiapp/frontend/src/

# Build dev (compile + déploie en dev)
cd /home/ubuntu/aiapp/frontend && npm run build:dev
/home/ubuntu/aiapp/scripts/D1-build_frontend_dev.sh

# Build prod (compile + promeut en prod)
cd /home/ubuntu/aiapp/frontend && npm run build:prod
/home/ubuntu/aiapp/scripts/D2-promote_dev_to_prod.sh
# ou directement depuis dist :
/home/ubuntu/aiapp/scripts/D2-promote_dev_to_prod.sh --from-dist
```
