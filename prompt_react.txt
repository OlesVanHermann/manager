# CONSIGNES REACT - NEW MANAGER OVHcloud

## 1. Contexte du projet

Interface **New Manager** pour la gestion des services OVHcloud : Cloud, HÃ©bergement Web, Email, DNS, Domaines, VPS, Serveurs dÃ©diÃ©s.

Ce projet est une **rÃ©Ã©criture progressive** du "old manager" existant (monorepo Angular + React OVHcloud).

### 1.1 Objectif de migration

Le **Old Manager** est accessible en production sur : `https://manager.eu.ovhcloud.com`

**StratÃ©gie de migration :**
- âŒ **NE PAS** faire de redirections vers `manager.eu.ovhcloud.com`
- âœ… **RÃ‰Ã‰CRIRE** les fonctionnalitÃ©s en identifiant les appels API dans le code source du old manager
- âœ… **UTILISER** les APIs OVH directement dans le New Manager

**MÃ©thodologie "la mÃ©thode" :**
1. **Localiser** la fonctionnalitÃ© dans le old manager (`/home/ubuntu/manager/`)
2. **Identifier** les appels API (endpoints `/me/*`, `/services/*`, etc.)
3. **Extraire** la logique mÃ©tier et les types TypeScript
4. **GÃ©nÃ©rer** le composant React Ã©quivalent pour le new manager

---

## 2. RÃ¨gles de travail

1. **Lire et analyser** le code fourni. Ne pas partager l'analyse sauf demande explicite.
2. **Ne rien faire** sans autorisation.
3. **Attendre les consignes** avant toute action.
4. **GÃ©nÃ©rer le code** dans le chat en utilisant **un seul bloc de code** avec copier-coller.
5. **Encapsuler** les commandes `cp` et `tee` dans un bloc markdown.
6. **Migration** : utiliser "la mÃ©thode" â†’ `grep` dans old manager â†’ localiser les appels API â†’ extraire types â†’ gÃ©nÃ©rer composant React (âš ï¸ pas de redirection vers manager.eu.ovhcloud.com)
7. **Conserver** le design system existant, ne pas rÃ©inventer les composants UI.
8. **Erreur 401 API** : rediriger vers l'auth OVH, pas d'erreur affichÃ©e.

---

## 3. Structure des rÃ©pertoires

| Ã‰lÃ©ment | Chemin |
|---------|--------|
| **New Manager (Frontend React)** | `/home/ubuntu/aiapp/frontend/src/` |
| **Old Manager (RÃ©fÃ©rence)** | `/home/ubuntu/manager/` |

---

## 4. New Manager

### 4.1 Archive
```bash
cd /home/ubuntu/
tar -cvf new_manager.tar --exclude='*2025*' aiapp/frontend/src/
```

### 4.2 Build

**DÃ©veloppement :**
```bash
cd /home/ubuntu/aiapp/frontend
npm run build:dev
/home/ubuntu/aiapp/scripts/D1-build_frontend_dev.sh
```

**Production :**
```bash
cd /home/ubuntu/aiapp/frontend
npm run build:prod
/home/ubuntu/aiapp/scripts/D2-promote_dev_to_prod.sh
# ou
/home/ubuntu/aiapp/scripts/D2-promote_dev_to_prod.sh --from-dist
```

### 4.3 Arborescence du framework
```
/home/ubuntu/aiapp/frontend/src/
â”œâ”€â”€ App.tsx                    # App principale + routing (NAV1 + NAV2)
â”œâ”€â”€ main.tsx                   # Bootstrap React
â”œâ”€â”€ index.css                  # Styles globaux + layout
â”‚
â”œâ”€â”€ components/                # Composants rÃ©utilisables
â”‚   â”œâ”€â”€ Sidebar/               # Sidebar gauche (header, search, liste, pagination)
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx        # Composant principal
â”‚   â”‚   â”œâ”€â”€ navigationTree.ts  # DÃ©finition des univers et sections
â”‚   â”‚   â”œâ”€â”€ styles.css         # Styles sidebar
â”‚   â”‚   â””â”€â”€ index.ts           # Exports
â”‚   â””â”€â”€ AccountSidebar/        # Sidebar droite (menu utilisateur)
â”‚       â”œâ”€â”€ AccountSidebar.tsx # Composant principal
â”‚       â”œâ”€â”€ UserInfos.tsx      # Infos profil
â”‚       â”œâ”€â”€ UsefulLinks.tsx    # Liens utiles
â”‚       â”œâ”€â”€ Shortcuts.tsx      # Raccourcis
â”‚       â”œâ”€â”€ styles.css         # Styles
â”‚       â””â”€â”€ index.ts           # Exports
â”‚
â”œâ”€â”€ pages/                     # Pages/Routes (chaque page gÃ¨re son NAV3)
â”‚   â”œâ”€â”€ Home.tsx               # Dashboard accueil
â”‚   â”œâ”€â”€ Login.tsx              # Page connexion OAuth OVH
â”‚   â”œâ”€â”€ Dev.tsx                # Playground API / debug
â”‚   â”œâ”€â”€ Account/               # Mon compte (7 sous-sections)
â”‚   â”œâ”€â”€ Billing/               # Facturation (11 sous-sections)
â”‚   â”œâ”€â”€ Support/               # Assistance (5 sous-sections)
â”‚   â”œâ”€â”€ Carbon/                # Empreinte carbone
â”‚   â”œâ”€â”€ Iam/                   # Identity & Access Management (univers sÃ©parÃ©)
â”‚   â””â”€â”€ Placeholder/           # Pages placeholder (univers non implÃ©mentÃ©s)
â”‚
â”œâ”€â”€ contexts/                  # React Contexts
â”‚   â””â”€â”€ AuthContext.tsx
â”‚
â”œâ”€â”€ services/                  # Services API
â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”œâ”€â”€ account.service.ts
â”‚   â”œâ”€â”€ billing.service.ts
â”‚   â”œâ”€â”€ services.service.ts
â”‚   â”œâ”€â”€ support.service.ts
â”‚   â”œâ”€â”€ iam.service.ts
â”‚   â””â”€â”€ security.service.ts
â”‚
â”œâ”€â”€ types/                     # TypeScript types
â”‚   â”œâ”€â”€ auth.types.ts
â”‚   â””â”€â”€ services.types.ts
â”‚
â”œâ”€â”€ lib/                       # Utilitaires
â”‚   â”œâ”€â”€ useTabs.ts             # Hook gestion onglets
â”‚   â”œâ”€â”€ constants.ts
â”‚   â”œâ”€â”€ types.ts
â”‚   â””â”€â”€ ResetSlot.tsx
â”‚
â””â”€â”€ design-system/             # Design System
    â”œâ”€â”€ index.ts               # Constantes TypeScript
    â”œâ”€â”€ globals.css
    â”œâ”€â”€ tokens.css             # Variables CSS (couleurs, typo, spacing)
    â”œâ”€â”€ tokens/index.ts
    â”œâ”€â”€ PATTERNS.md            # Couleurs, typo, spacing
    â”œâ”€â”€ COMPONENTS.md          # Catalogue composants
    â”œâ”€â”€ DESIGN_TOKENS.md       # Patterns d'usage
    â””â”€â”€ ICONS.md               # IcÃ´nes disponibles
```

---

## 5. Design System (OVH Classic Blue)

### 5.1 Couleurs primaires (tokens.css)

| Token | Valeur | Usage |
|-------|--------|-------|
| `--color-primary-500` | `#0050D7` | Bleu OVH principal |
| `--color-primary-600` | `#003DA8` | Hover/Active |
| `--color-primary-700` | `#002B7A` | Pressed |
| `--color-primary-800` | `#122844` | Dark |
| `--color-primary-300` | `#85A5FF` | Light |
| `--color-primary-100` | `#D6E4FF` | Background |

### 5.2 RÃ¨gle d'utilisation

Utiliser **uniquement** les variables CSS **sans fallback** :
```css
/* âœ… BON */
color: var(--color-primary-500);

/* âŒ MAUVAIS */
color: var(--color-primary-500, #0050D7);
```

### 5.3 Stack technique

| Composant | Source |
|-----------|--------|
| Design System | `@ovh-ux/muk` (Manager UI Kit) |
| Base ODS | `@ovhcloud/ods-react` v19.2.1 |
| ThÃ¨mes | `@ovhcloud/ods-themes` v19.2.1 |
| CSS | Tailwind CSS |

### 5.4 Classes CSS disponibles
```css
/* Boutons */
.btn  .btn-primary  .btn-secondary  .btn-outline

/* Cartes/Tiles */
.tile  .tile-header  .tile-content

/* Onglets */
.tab-btn  .tabs-list

/* Badges */
.status-badge  .badge-success  .badge-warning  .badge-error

/* Formulaires */
.toggle-switch  .toggle-slider

/* SÃ©curitÃ© */
.security-card  .two-factor-method

/* Tableaux */
.bills-table  .method-table
```

---

## 6. Architecture technique

### 6.1 Proxy Nginx

Le frontend communique avec l'API OVH via un proxy Nginx :
```
/api/ovh/*  â†’  https://eu.api.ovh.com/1.0/*
```

La signature des requÃªtes est gÃ©rÃ©e automatiquement cÃ´tÃ© serveur.

### 6.2 Layout principal (App.tsx)
```
+-------------------------------------------------------------------------------------------+
| +-----------------+ +-------------------------------------------------------+ +-------+ |
| | [H] [â–¡] [â–¡] [â–¡] | | HOME | PUBLIC CLOUD | PRIVATE CLOUD | BARE METAL |    | | OK    | |
| +-----------------+ |      | WEB CLOUD | NETWORK | IAM                      | | nic   | |
| | [ğŸ” Search    ] | +-------------------------------------------------------+ +-------+ |
| +-----------------+ | [Accueil] [Compte] [Facturation] [Support] [...]       | <- NAV2  |
| | Liste:          | +-------------------------------------------------------+          |
| | - TOUS          | |                                                       |          |
| | - ressource 1   | |    PAGE AVEC SES PROPRES ONGLETS NAV3 INTERNES        |          |
| | - ressource 2   | |    (AccountPage, BillingPage, etc.)                   |          |
| | - ressource 3   | |                                                       |          |
| | - ...           | |    +-----------------------------------------------+  |          |
| |                 | |    | [Tab1] [Tab2] [Tab3] ...    <- NAV3 dans page |  |          |
| |                 | |    +-----------------------------------------------+  |          |
| |                 | |    |                                               |  |          |
| |                 | |    |            CONTENU DE LA PAGE                 |  |          |
| |                 | |    |                                               |  |          |
| +-----------------+ |    +-----------------------------------------------+  |          |
| |  [â—„]  10  [â–º]   | |                                                       |          |
| +-----------------+ +-------------------------------------------------------+          |
+-------------------------------------------------------------------------------------------+
```

**Composants du layout :**

| Zone | Composant | Description |
|------|-----------|-------------|
| Sidebar Header | `SidebarHeader` | IcÃ´ne home + boutons vue (liste/grille) |
| Sidebar Search | `SearchInput` | Recherche (EN HAUT, aprÃ¨s header) |
| Sidebar Liste | `ResourceList` | Liste : TOUS (premier) + ressources |
| Sidebar Pagination | `Pagination` | Navigation â—„ page â–º |
| Niveau 1 (NAV1) | `UniversTabs` | Onglets univers OVH (HOME, PUBLIC CLOUD, etc.) |
| Niveau 2 (NAV2) | `SectionTabs` | Sections de l'univers sÃ©lectionnÃ© |
| Niveau 3 (NAV3) | `PageTabs` | **DANS chaque page** (pas dans le header global) |
| Contenu | `ContentArea` | Zone de contenu dynamique |
| User Menu | `UserMenu` | Avatar + NIC handle, ouvre AccountSidebar |
| AccountSidebar | `AccountSidebar` | Sidebar droite avec profil et actions |

### 6.3 Navigation Niveau 1 (Univers) - NAV1

| ID | Onglet | Description |
|----|--------|-------------|
| A | **HOME** | FonctionnalitÃ©s non-produit (compte, facturation, support, carbone, API) |
| B | **PUBLIC CLOUD** | Instances, Storage, Network, AI/ML, Databases |
| C | **PRIVATE CLOUD** | VMware, Nutanix, SAP HANA |
| D | **BARE METAL** | Serveurs dÃ©diÃ©s, VPS, Managed Bare Metal |
| E | **WEB CLOUD** | Domaines, HÃ©bergement, Emails, DNS |
| F | **NETWORK** | IP, vRack, Load Balancer, CDN |
| G | **IAM** | Identity & Access Management (univers sÃ©parÃ©) |

### 6.4 Sidebar gauche (Liste des ressources)

| Ã‰lÃ©ment | Position | Fonction |
|---------|----------|----------|
| **Header** | Haut | IcÃ´ne home + boutons vue (liste/grille) |
| **Search** | AprÃ¨s header | Filtre de recherche |
| **Liste** | Centre | TOUS (premier) + ressources de l'univers |
| **Pagination** | Bas | Navigation â—„ page â–º |

**Comportement :**
- La liste se met Ã  jour selon l'univers sÃ©lectionnÃ© (NAV1)
- **TOUS** est toujours le premier Ã©lÃ©ment
- Cliquer sur une ressource affiche ses dÃ©tails dans le contenu
- La recherche filtre en temps rÃ©el
- Pagination avec numÃ©ro de page courant

---

## 7. Univers HOME - Structure complÃ¨te (A)

L'univers **HOME** regroupe toutes les fonctionnalitÃ©s non-produit.

### 7.1 Sections HOME (NAV2)

| # | Section (NAV2) | Page | Route |
|---|----------------|------|-------|
| 1 | **Accueil** | `Home.tsx` | `/home` |
| 2 | **Compte** | `AccountPage` | `/home/account/*` |
| 3 | **Facturation** | `BillingPage` | `/home/billing/*` |
| 4 | **Support** | `SupportPage` | `/home/support/*` |
| 5 | **Carbone** | `CarbonPage` | `/home/carbon` |
| 6 | **Playground API** | `Dev.tsx` | `/home/api/*` |

### 7.2 Compte - Sous-sections (NAV3)

| # | Onglet (NAV3) | Description | Endpoint API principal |
|---|---------------|-------------|------------------------|
| a | **Informations GÃ©nÃ©rales** | Profil utilisateur (nom, adresse, sociÃ©tÃ©) | `GET /me` |
| b | **Ã‰diter mon compte** | Modification profil | `PUT /me` |
| c | **SÃ©curitÃ©** | 2FA, sessions, mot de passe | `GET /me/accessRestriction/*` |
| d | **DonnÃ©es personnelles** | RGPD, export/suppression donnÃ©es | `GET /me/privacy/*` |
| e | **ParamÃ¨tres avancÃ©s** | Configuration avancÃ©e compte | `GET /me/preferences` |
| f | **Mes services** | Gestion des contacts sur services | `GET /me/contact` |
| g | **Mes demandes** | Demandes de gestion de contacts | `GET /me/task/contactChange` |

### 7.3 Facturation - Sous-sections (NAV3)

| # | Onglet (NAV3) | Description | Endpoint API principal |
|---|---------------|-------------|------------------------|
| a | **Mes services** | Liste services actifs, renouvellement | `GET /services` |
| b | **Factures** | Historique factures | `GET /me/bill` |
| c | **Avoirs** | Notes de crÃ©dit | `GET /me/refund` |
| d | **Paiement** | Historique paiements (deposits) | `GET /me/deposit` |
| e | **Commandes** | Historique commandes | `GET /me/order` |
| f | **Mes rÃ©fÃ©rences internes** | PO numbers, rÃ©fÃ©rences | `GET /me/billing/invoicesByPostalMail` |
| g | **Moyens de paiement** | CB, SEPA, PayPal | `GET /me/payment/method` |
| h | **Compte prÃ©payÃ©** | Solde OVH Account | `GET /me/ovhAccount` |
| i | **Bon d'achat** | Vouchers, codes promo | `GET /me/voucherAccount` |
| j | **Points de fidÃ©litÃ©** | Programme fidÃ©litÃ© | `GET /me/fidelityAccount` |
| k | **Contrats** | Contrats actifs, CGV | `GET /me/agreements` |

### 7.4 Support - Sous-sections (NAV3)

| # | Onglet (NAV3) | Description | Endpoint API principal |
|---|---------------|-------------|------------------------|
| a | **Mes tickets** | Liste des tickets support | `GET /support/tickets` |
| b | **CrÃ©er un nouveau ticket** | Formulaire crÃ©ation ticket | `POST /support/tickets` |
| c | **Mon niveau de support** | Standard, Business, Enterprise | `GET /me/supportLevel` |
| d | **Mes communications** | Messages OVH reÃ§us | `GET /me/notification` |
| e | **ParamÃ¨tres de diffusion** | PrÃ©fÃ©rences notifications | `GET /me/notification/preferences` |

### 7.5 Carbone

| Page | Description | Endpoint API principal |
|------|-------------|------------------------|
| **Dashboard carbone** | Empreinte carbone des services | `GET /me/carbonCalculator/*` |

### 7.6 Playground API - Sous-sections (NAV3)

| # | Onglet (NAV3) | Description | Endpoint API principal |
|---|---------------|-------------|------------------------|
| a | **API** | Console interactive, test endpoints | `GET /me/api/application` |
| b | **ParamÃ¨tres avancÃ©s** | Credentials, tokens, apps | `GET /me/api/credential` |

---

## 8. Univers IAM - Structure complÃ¨te (G)

L'univers **IAM** est un univers sÃ©parÃ© dÃ©diÃ© Ã  la gestion des accÃ¨s.

### 8.1 Sections IAM (NAV2)

| # | Section (NAV2) | Page | Route |
|---|----------------|------|-------|
| 1 | **Accueil** | `IamHome.tsx` | `/iam` |

### 8.2 Accueil IAM - Sous-sections (NAV3)

| # | Onglet (NAV3) | Description | Endpoint API principal |
|---|---------------|-------------|------------------------|
| a | **IdentitÃ©s** | Utilisateurs, comptes service | `GET /me/identity/user` |
| b | **Politiques** | RÃ¨gles d'accÃ¨s, permissions | `GET /iam/policy` |
| c | **Groupes** | Groupes d'utilisateurs | `GET /me/identity/group` |
| d | **Logs** | Audit trail, historique accÃ¨s | `GET /me/logs` |

---

## 9. Univers Produits (B-F)

### 9.1 PUBLIC CLOUD (B)

| Section | Subsections |
|---------|-------------|
| Accueil | Dashboard |
| Instances | Liste, CrÃ©er |
| Storage | Block, Object, Archive |
| Network | Private Network, Load Balancer |
| Databases | Managed DB |
| AI & ML | Services IA |

### 9.2 PRIVATE CLOUD (C)

| Section | Subsections |
|---------|-------------|
| Accueil | Dashboard |
| VMware | vSphere, NSX |
| Nutanix | Clusters |
| SAP HANA | Instances SAP |

### 9.3 BARE METAL (D)

| Section | Subsections |
|---------|-------------|
| Accueil | Dashboard |
| Serveurs dÃ©diÃ©s | Mes serveurs, Commander |
| VPS | Mes VPS, Commander |
| Managed Bare Metal | Services managÃ©s |

### 9.4 WEB CLOUD (E)

| Section | Subsections |
|---------|-------------|
| Accueil | Dashboard |
| Domaines | Mes domaines, Zones DNS |
| HÃ©bergements | Mes hÃ©bergements, Bases de donnÃ©es |
| Emails | Email domain, Email Pro, Exchange |

### 9.5 NETWORK (F)

| Section | Subsections |
|---------|-------------|
| Accueil | Dashboard |
| IP | Gestion IP |
| vRack | Private network |
| Load Balancer | LB |
| CDN | Content Delivery |

---

## 10. APIs OVH

### 10.1 Authentification

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| POST | `/auth/credential` | Demande de consumer key |
| GET | `/me` | Informations utilisateur |

### 10.2 Compte

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/me` | Informations gÃ©nÃ©rales |
| PUT | `/me` | Ã‰diter mon compte |
| GET | `/me/contact` | Mes services (contacts) |
| GET | `/me/task/contactChange` | Mes demandes (contact change) |
| GET | `/me/preferences` | ParamÃ¨tres avancÃ©s |

### 10.3 SÃ©curitÃ© (2FA)

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/me/accessRestriction/sms` | Liste SMS 2FA |
| GET | `/me/accessRestriction/totp` | Liste TOTP (app mobile) |
| GET | `/me/accessRestriction/u2f` | Liste clÃ©s U2F |
| GET | `/me/accessRestriction/backupCode` | Codes de secours |

### 10.4 DonnÃ©es personnelles (RGPD)

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/me/privacy/requests` | Demandes RGPD |
| POST | `/me/privacy/requests/erasure` | Demande suppression |
| POST | `/me/privacy/requests/export` | Demande export |

### 10.5 Facturation

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/services` | Mes services |
| GET | `/me/bill` | Factures |
| GET | `/me/bill/{billId}` | DÃ©tails facture |
| GET | `/me/refund` | Avoirs |
| GET | `/me/deposit` | Paiements |
| GET | `/me/deposit/{depositId}` | DÃ©tails paiement |
| GET | `/me/order` | Commandes |
| GET | `/me/payment/method` | Moyens de paiement |
| GET | `/me/debtAccount` | Encours/dette |
| GET | `/me/ovhAccount` | Compte prÃ©payÃ© |
| GET | `/me/voucherAccount` | Bons d'achat |
| GET | `/me/fidelityAccount` | Points fidÃ©litÃ© |
| GET | `/me/agreements` | Contrats |

### 10.6 Support

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/support/tickets` | Mes tickets |
| POST | `/support/tickets` | CrÃ©er ticket |
| GET | `/support/tickets/{ticketId}` | DÃ©tails ticket |
| GET | `/me/supportLevel` | Niveau de support |
| GET | `/me/notification` | Mes communications |
| GET/PUT | `/me/notification/preferences` | ParamÃ¨tres de diffusion |

### 10.7 IAM

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/me/identity/user` | Liste identitÃ©s |
| GET | `/iam/policy` | Liste politiques |
| GET | `/me/identity/group` | Liste groupes |
| GET | `/me/logs` | Logs audit |

### 10.8 Playground API

| MÃ©thode | Endpoint | Description |
|---------|----------|-------------|
| GET | `/me/api/application` | Mes applications API |
| GET | `/me/api/credential` | Mes credentials |
| POST | `/me/api/application` | CrÃ©er application |

---

## 11. Old Manager (RÃ©fÃ©rence)

**Production** : `https://manager.eu.ovhcloud.com`
**Code source** : `/home/ubuntu/manager/`

### 11.1 Structure principale
```
/home/ubuntu/manager/packages/manager/
â”œâ”€â”€ core/          # Utilitaires fondamentaux
â”œâ”€â”€ modules/       # Modules mÃ©tier rÃ©utilisables
â””â”€â”€ apps/          # Applications complÃ¨tes
```

### 11.2 Core (`packages/manager/core/`)
```
api, application, ovh-product-icons, request-tagger,
shell-client, sso, url-builder, utils
```

### 11.3 Modules (`packages/manager/modules/`)
```
account, billing, billing-components, iam, support, order,
exchange, emailpro, email-domain, nasha, netapp, pci,
vps, vrack, carbon-calculator, mfa-enrollment, ...
```

### 11.4 Apps (`packages/manager/apps/`)
```
account, billing, dedicated, dedicated-servers, hub,
iam, pci, public-cloud, vps, vrack, web, web-hosting,
support, sms, telecom, exchange, email-pro, ...
```

### 11.5 MÃ©thodologie : Trouver les appels API

**âš ï¸ IMPORTANT : Ne jamais rediriger vers manager.eu.ovhcloud.com**

Pour chaque fonctionnalitÃ© Ã  migrer, identifier les appels API dans le old manager :

```bash
# 1. Chercher les endpoints API dans un module
cd /home/ubuntu/manager
grep -r "api.get\|api.post\|api.put\|api.delete" packages/manager/modules/billing/

# 2. Chercher les appels /me/* (compte utilisateur)
grep -rn "/me/" packages/manager/apps/account/

# 3. Chercher les services API d'un module
find packages/manager/modules/billing -name "*.service.ts" -o -name "*api*.ts"

# 4. Chercher une fonctionnalitÃ© spÃ©cifique
grep -rn "refund\|avoir" packages/manager/modules/billing/

# 5. Voir les types/interfaces d'un endpoint
grep -rn "interface.*Bill\|type.*Bill" packages/manager/modules/billing/
```

**Exemple de migration - Support (Tickets) :**
```bash
# Ã‰tape 1 : Localiser
grep -rn "ticket" packages/manager/modules/support/
# â†’ Trouve : support-ticket.service.ts

# Ã‰tape 2 : Identifier l'API
cat packages/manager/modules/support/src/services/support-ticket.service.ts
# â†’ Trouve : GET /support/tickets, POST /support/tickets

# Ã‰tape 3 : Extraire les types
grep -rn "interface.*Ticket" packages/manager/modules/support/
# â†’ Trouve les interfaces TypeScript

# Ã‰tape 4 : GÃ©nÃ©rer dans new_manager
# â†’ CrÃ©er support.service.ts avec getTickets(), createTicket()
# â†’ CrÃ©er TicketsTab.tsx dans pages/Support/
```

---

## 12. Conventions de code

| RÃ¨gle | Application |
|-------|-------------|
| **TypeScript** | Mode strict |
| **Composants** | Fonctionnels avec hooks |
| **Nommage composants** | PascalCase |
| **Nommage fonctions/variables** | camelCase |
| **Structure fichiers** | Un composant = un fichier |
| **Exports** | NommÃ©s (prÃ©fÃ©rÃ©s aux exports default) |
| **Appels API** | Dans `services/`, jamais dans les composants |
| **NAV3 (onglets internes)** | GÃ©rÃ©s par chaque page, pas dans App.tsx |

### âš ï¸ SÃ©curitÃ©

**JAMAIS de secrets dans le code frontend :**
- Pas de clÃ©s API, tokens, mots de passe ou credentials en dur
- Pas de secrets dans les variables d'environnement exposÃ©es au client (`VITE_*`)
- L'authentification passe par le flow OAuth OVH (cookies httpOnly cÃ´tÃ© serveur)
- Les appels API utilisent les credentials de session, pas de tokens hardcodÃ©s

---

## 13. RÃ©fÃ©rence rapide

### 13.1 Recherche dans le Old Manager
```bash
# Chercher une fonctionnalitÃ©
cd /home/ubuntu/manager && grep -rn "pattern" packages/

# Chercher les appels API d'un module
grep -r "api.get\|api.post" packages/manager/modules/MODULE_NAME/

# Chercher les endpoints /me/*
grep -rn '"/me/' packages/manager/apps/APP_NAME/

# Chercher les services d'un module
find packages/manager/modules/MODULE_NAME -name "*.service.ts"

# Chercher les types/interfaces
grep -rn "interface\|type" packages/manager/modules/MODULE_NAME/src/types/
```

### 13.2 Build New Manager
```bash
# CrÃ©er archive new manager
cd /home/ubuntu && tar -cvf new_manager.tar --exclude='*2025*' aiapp/frontend/src/

# Build dev (compile + dÃ©ploie en dev)
cd /home/ubuntu/aiapp/frontend && npm run build:dev
/home/ubuntu/aiapp/scripts/D1-build_frontend_dev.sh

# Build prod (compile + promeut en prod)
cd /home/ubuntu/aiapp/frontend && npm run build:prod
/home/ubuntu/aiapp/scripts/D2-promote_dev_to_prod.sh
# ou directement depuis dist :
/home/ubuntu/aiapp/scripts/D2-promote_dev_to_prod.sh --from-dist
```

---

## 14. Structure navigationTree.ts

DÃ©finition des univers dans `/src/components/Sidebar/navigationTree.ts` :

```typescript
interface Universe {
  id: string;           // "home", "public-cloud", "iam", etc.
  label: string;        // "HOME", "PUBLIC CLOUD", "IAM", etc.
  shortLabel?: string;  // Label court pour affichage compact
  sections: UniverseSection[];
}

interface UniverseSection {
  id: string;           // "home-account", "iam-identities", etc.
  label: string;        // "Compte", "IdentitÃ©s", etc.
  subsections?: NavNode[];  // Sous-sections (onglets NAV3)
}

interface NavNode {
  id: string;
  label: string;
  url?: string;         // URL pour liens externes
  external?: boolean;   // true = ouvre dans nouvel onglet
}
```

**Univers dÃ©finis :**
```typescript
export const universes: Universe[] = [
  { id: 'home', label: 'HOME', sections: [...] },           // A
  { id: 'public-cloud', label: 'PUBLIC CLOUD', sections: [...] },  // B
  { id: 'private-cloud', label: 'PRIVATE CLOUD', sections: [...] }, // C
  { id: 'bare-metal', label: 'BARE METAL', sections: [...] },      // D
  { id: 'web-cloud', label: 'WEB CLOUD', sections: [...] },        // E
  { id: 'network', label: 'NETWORK', sections: [...] },            // F
  { id: 'iam', label: 'IAM', sections: [...] },                    // G
];
```

---

## 15. Mapping Routes â†” Navigation

### 15.1 Routes HOME (A)

| Route | NAV2 | NAV3 | Composant |
|-------|------|------|-----------|
| `/home` | Accueil | - | `Home.tsx` |
| `/home/account` | Compte | Info gÃ©nÃ©rales | `AccountPage/GeneralInfo.tsx` |
| `/home/account/edit` | Compte | Ã‰diter | `AccountPage/EditAccount.tsx` |
| `/home/account/security` | Compte | SÃ©curitÃ© | `AccountPage/Security.tsx` |
| `/home/account/privacy` | Compte | DonnÃ©es perso | `AccountPage/Privacy.tsx` |
| `/home/account/advanced` | Compte | ParamÃ¨tres avancÃ©s | `AccountPage/Advanced.tsx` |
| `/home/account/services` | Compte | Mes services | `AccountPage/Services.tsx` |
| `/home/account/requests` | Compte | Mes demandes | `AccountPage/Requests.tsx` |
| `/home/billing` | Facturation | Mes services | `BillingPage/Services.tsx` |
| `/home/billing/bills` | Facturation | Factures | `BillingPage/Bills.tsx` |
| `/home/billing/refunds` | Facturation | Avoirs | `BillingPage/Refunds.tsx` |
| `/home/billing/payments` | Facturation | Paiement | `BillingPage/Payments.tsx` |
| `/home/billing/orders` | Facturation | Commandes | `BillingPage/Orders.tsx` |
| `/home/billing/references` | Facturation | RÃ©fÃ©rences | `BillingPage/References.tsx` |
| `/home/billing/methods` | Facturation | Moyens paiement | `BillingPage/Methods.tsx` |
| `/home/billing/prepaid` | Facturation | PrÃ©payÃ© | `BillingPage/Prepaid.tsx` |
| `/home/billing/vouchers` | Facturation | Bons d'achat | `BillingPage/Vouchers.tsx` |
| `/home/billing/fidelity` | Facturation | FidÃ©litÃ© | `BillingPage/Fidelity.tsx` |
| `/home/billing/contracts` | Facturation | Contrats | `BillingPage/Contracts.tsx` |
| `/home/support` | Support | Mes tickets | `SupportPage/Tickets.tsx` |
| `/home/support/new` | Support | CrÃ©er ticket | `SupportPage/NewTicket.tsx` |
| `/home/support/level` | Support | Niveau support | `SupportPage/Level.tsx` |
| `/home/support/communications` | Support | Communications | `SupportPage/Communications.tsx` |
| `/home/support/preferences` | Support | ParamÃ¨tres | `SupportPage/Preferences.tsx` |
| `/home/carbon` | Carbone | - | `CarbonPage.tsx` |
| `/home/api` | Playground | API | `Dev.tsx` |
| `/home/api/advanced` | Playground | ParamÃ¨tres avancÃ©s | `Dev/Advanced.tsx` |

### 15.2 Routes IAM (G)

| Route | NAV2 | NAV3 | Composant |
|-------|------|------|-----------|
| `/iam` | Accueil | IdentitÃ©s | `IamPage/Identities.tsx` |
| `/iam/policies` | Accueil | Politiques | `IamPage/Policies.tsx` |
| `/iam/groups` | Accueil | Groupes | `IamPage/Groups.tsx` |
| `/iam/logs` | Accueil | Logs | `IamPage/Logs.tsx` |

---

## 16. AccountSidebar (Menu utilisateur)

Accessible via l'avatar/NIC en haut Ã  droite :
```
+---------------------------+
|        [Avatar]           |
|           OK              |
|       [Standard]          |  <- Niveau de support
|      Octave Klaba         |  <- Nom
|    [Administrateur]       |  <- RÃ´le
|         Jezby             |  <- SociÃ©tÃ©
|                           |
|  octave.klaba@ovh.com     |  <- Email
|     ko51027-ovh           |  <- NIC handle
+---------------------------+
|    Voir mes factures  >   |
|  Suivre mes paiements >   |
|    GÃ©rer mes services >   |
+---------------------------+
|     Documentation     >   |
|    Playground API     >   |
|   Ã‰tat des services   >   |
+---------------------------+
|        [Logout]           |
+---------------------------+
```

**Sections :**
- **Profil** : Avatar, niveau support, nom, rÃ´le, sociÃ©tÃ©, email, NIC
- **Raccourcis** : Liens rapides vers sections HOME (Factures, Paiements, Services)
- **Liens externes** : Documentation, API, Status
- **Session** : Logout
