# PROMPT SPLIT v3 - Défactorisation Totale + Layout Specs
# Fusionné avec prompt_split_layout_method.txt
# Version: 3.0 (2025-12-31)

################################################################################
# A) ARCHITECTURE DE NAVIGATION
################################################################################

## Hiérarchie complète

| Niveau | Nom | Description | Exemple hosting |
|--------|-----|-------------|-----------------|
| **NAV1** | Catégorie | Menu principal | `web-cloud` |
| **NAV2** | Produit | Service/Produit | `hosting` |
| **NAV3** | Groupe | Groupe d'onglets | `general`, `sites`, `expert` |
| **NAV4** | Onglet | Onglet fonctionnel | `ftp`, `ssl`, `database` |
| **NAV5** | Sous-onglet | Vue détaillée | `statistics`, `dumps` |

## Règles

- Le 1er élément de NAV1 et NAV3 s'appelle `general`
- NAV3 regroupe les NAV4 par thème (général, sites, expert, etc.)
- NAV4 = unité de défactorisation (1 tab = 1 île isolée)
- NAV5 = sous-vues dans un même tab (partagent le même service)

## Objectif

DÉFACTORISER un module monolithique en modules ISOLÉS, un par NAV4.

> "Chaque tab (NAV4) est une île. Aucun pont entre les îles. Ni en JS, ni en CSS."

################################################################################
# B) ARBORESCENCE CIBLE
################################################################################

## Code source (src/pages/)

```
src/pages/{NAV1}/{NAV2}/
│
├── {nav2}.types.ts              # Types partagés (SEUL partage JS autorisé)
├── index.tsx                    # Layout + routing NAV3/NAV4
├── styles.css                   # CSS layout uniquement (sidebar, split, tabs)
│
├── {Nav2}Sidebar.tsx            # Composant sidebar (optionnel)
├── {Nav2}Layout.tsx             # Composant layout (optionnel)
├── Onboarding.tsx               # État vide / accueil (optionnel)
│
├── {nav3}/                      # ══════ GROUPE NAV3 ══════
│   │
│   └── {nav4}/                  # ══════ ONGLET NAV4 (ISOLÉ) ══════
│       │
│       ├── index.ts             # Barrel export (export default)
│       ├── {Nav4}Tab.tsx        # Composant principal
│       ├── {Nav4}Tab.service.ts # Service API isolé
│       ├── {Nav4}Tab.css        # Styles isolés (préfixe .{nav4}-*)
│       │
│       ├── modals.ts            # Index des modales (optionnel)
│       ├── Create{Nav4}Modal.tsx
│       ├── Edit{Nav4}Modal.tsx
│       ├── Delete{Nav4}Modal.tsx
│       │
│       └── {Nav4}{Nav5}Tab.tsx  # Sous-onglet NAV5 (optionnel)
```

## Exemple : web-cloud/hosting

```
src/pages/web-cloud/hosting/
│
├── hosting.types.ts             # Types partagés
├── index.tsx                    # Layout + routing
├── styles.css                   # CSS layout (sidebar, split, header, tabs)
├── HostingSidebar.tsx
├── HostingLayout.tsx
├── Onboarding.tsx
│
├── general/                     # NAV3: [Général]
│   ├── general/                 # NAV4: Home (défaut)
│   │   ├── index.ts
│   │   ├── GeneralTab.tsx
│   │   ├── GeneralTab.service.ts
│   │   └── GeneralTab.css
│   │
│   ├── modules/                 # NAV4: Modules
│   │   ├── index.ts
│   │   ├── ModulesTab.tsx
│   │   ├── ModulesTab.service.ts
│   │   ├── ModulesTab.css
│   │   ├── modals.ts
│   │   ├── InstallModuleModal.tsx
│   │   └── DeleteModuleModal.tsx
│   │
│   ├── logs/                    # NAV4: Logs (avec NAV5)
│   │   ├── index.ts
│   │   ├── LogsTab.tsx          # NAV5: Logs OVH (défaut)
│   │   ├── LogsTab.service.ts
│   │   ├── LogsTab.css
│   │   └── UserLogsTab.tsx      # NAV5: User Logs
│   │
│   └── seo/                     # NAV4: SEO
│       └── ...
│
├── sites/                       # NAV3: [Sites]
│   ├── multisite/               # NAV4: Multisite
│   │   └── ...
│   └── ssl/                     # NAV4: SSL
│       └── ...
│
└── expert/                      # NAV3: [Expert]
    ├── ftp/                     # NAV4: FTP
    │   ├── index.ts
    │   ├── FtpTab.tsx
    │   ├── FtpTab.service.ts
    │   ├── FtpTab.css
    │   ├── modals.ts
    │   ├── CreateFtpUserModal.tsx
    │   ├── EditFtpUserModal.tsx
    │   ├── DeleteFtpUserModal.tsx
    │   └── ChangePasswordModal.tsx
    │
    ├── database/                # NAV4: BDD (avec NAV5)
    │   ├── index.ts
    │   ├── DatabaseTab.tsx      # NAV5: Liste (défaut)
    │   ├── DatabaseTab.service.ts
    │   ├── DatabaseTab.css
    │   ├── DatabaseStatisticsTab.tsx  # NAV5: Statistics
    │   └── DatabaseDumpsTab.tsx       # NAV5: Dumps
    │
    ├── cdn/                     # NAV4: CDN
    ├── boost/                   # NAV4: Boost
    ├── emails/                  # NAV4: Emails
    ├── envvars/                 # NAV4: Variables
    ├── runtimes/                # NAV4: Runtimes
    ├── cron/                    # NAV4: Cron
    └── tasks/                   # NAV4: Tâches
```

## Traductions (public/locales/)

```
public/locales/{lang}/{NAV1}/{NAV2}/
│
├── index.json                        # Traductions communes NAV2
├── {nav1}.{nav2}.json                # Alias (optionnel)
│
├── {nav1}.{nav2}.{nav4}.json         # Par onglet NAV4
│   Exemples:
│   ├── web-cloud.hosting.ftp.json
│   ├── web-cloud.hosting.ssl.json
│   ├── web-cloud.hosting.database.json
│   └── web-cloud.hosting.multisite.json
│
├── modals/                           # Modales complexes (optionnel)
│   └── migration.json
│
└── tabs/                             # Sous-onglets NAV5 (optionnel)
    ├── database-statistics.json
    └── database-dumps.json
```

## Résumé fichiers par niveau

| Niveau | Fichiers | Partage |
|--------|----------|---------|
| **NAV2** | `{nav2}.types.ts`, `index.tsx`, `styles.css` | Layout uniquement |
| **NAV4** | `{Nav4}Tab.tsx`, `.service.ts`, `.css`, `index.ts`, `*Modal.tsx` | AUCUN (isolé) |
| **Locales** | `{nav1}.{nav2}.{nav4}.json` | — |

################################################################################
# C) PRINCIPE DE DÉFACTORISATION
################################################################################

## Définition

**DÉFACTORISATION** = L'inverse de la factorisation/mutualisation.
Au lieu de partager le code commun, on le **DUPLIQUE VOLONTAIREMENT** pour garantir l'**INDÉPENDANCE TOTALE**.

## Pourquoi défactoriser ?

| Factorisation (AVANT)                | Défactorisation (APRÈS)              |
|--------------------------------------|--------------------------------------|
| 1 service partagé = 1 point de casse | N services isolés = 0 régression     |
| 1 CSS partagé = styles qui cassent   | N CSS isolés = styles indépendants   |
| Modifier FTP casse SSL               | Modifier FTP n'impacte QUE FTP       |
| Couplage fort entre tabs             | Couplage ZÉRO entre tabs             |
| "DRY" mal appliqué                   | "WET" assumé (Write Everything Twice)|
| Refacto globale risquée              | Refacto locale safe                  |

## Règle d'or

```
SI deux tabs (NAV4) ont besoin de la même fonction/style/helper :
   → DUPLIQUER le code dans CHAQUE tab
   → NE JAMAIS créer un fichier partagé entre tabs
```

################################################################################
# D) INTERDITS ABSOLUS - JAVASCRIPT/TYPESCRIPT
################################################################################

### ❌ INTERDIT JS-1 : Import croisé entre tabs (NAV4)

```typescript
// ❌ INTERDIT - FtpTab.tsx ne doit JAMAIS faire :
import { sslService } from "../ssl/SslTab.service";
import { quelqueChose } from "../../general/general/GeneralTab";
import { formatDomain } from "../../sites/multisite/MultisiteTab";
```

### ❌ INTERDIT JS-2 : Service partagé dans /services/

```typescript
// ❌ INTERDIT - Plus JAMAIS de service mutualisé par NAV2 :
import { hostingService } from "@/services/web-cloud.hosting";
import { databaseService } from "@/services/web-cloud.private-database";
```

### ❌ INTERDIT JS-3 : Helper/utils partagé au niveau NAV2

```typescript
// ❌ INTERDIT - Pas de fichier utils/helpers commun entre tabs :
import { formatDate } from "../../hosting.utils";
import { validateDomain } from "../../hosting.helpers";
import { useHostingData } from "../../hooks/useHostingData";
```

### ❌ INTERDIT JS-4 : Composant partagé interne entre tabs

```typescript
// ❌ INTERDIT - Pas de composants mutualisés entre tabs :
import { HostingCard } from "../../components/HostingCard";
import { DomainSelector } from "../../shared/DomainSelector";
```

### ❌ INTERDIT JS-5 : Barrel file NAV2 qui ré-exporte les tabs

```typescript
// ❌ INTERDIT - hosting/index.ts NE DOIT PAS faire :
export * from "./general/ftp/FtpTab";
export * from "./sites/ssl/SslTab";
export { FtpTab, SslTab, DatabaseTab };
```

### ❌ INTERDIT JS-6 : Context/Provider partagé entre tabs

```typescript
// ❌ INTERDIT - Pas de context commun entre tabs :
import { useHostingContext } from "../../HostingContext";
import { HostingProvider } from "../../HostingProvider";
```

################################################################################
# E) INTERDITS ABSOLUS - CSS/STYLES
################################################################################

### ❌ INTERDIT CSS-1 : CSS tabs dans le fichier layout NAV2

```css
/* ❌ INTERDIT dans styles.css (niveau NAV2) */
.ftp-table { }      /* Style de tab = doit être dans FtpTab.css */
.ssl-badge { }      /* Style de tab = doit être dans SslTab.css */
```

### ❌ INTERDIT CSS-2 : Import CSS croisé entre tabs

```typescript
// ❌ INTERDIT - FtpTab ne doit JAMAIS importer le CSS d'un autre tab :
import "../ssl/SslTab.css";
import "../../general/general/GeneralTab.css";
```

### ❌ INTERDIT CSS-3 : Classes CSS génériques sans préfixe

```css
/* ❌ INTERDIT - Pas de classes génériques dans un tab */
.card { }
.table { }
.modal-overlay { }
.btn-primary { }
```

### ❌ INTERDIT CSS-4 : Préfixe générique (wh-, hosting-)

```css
/* ❌ INTERDIT - Préfixes génériques partagés */
.wh-ftp-table { }      /* wh- = préfixe global, pas isolé */
.hosting-modal { }     /* hosting- = préfixe NAV2, pas NAV4 */
```

### ❌ INTERDIT CSS-5 : Variables CSS au niveau NAV2

```css
/* ❌ INTERDIT - Pas de variables communes entre tabs */
:root {
  --hosting-primary: #0050d7;
  --hosting-spacing: 16px;
}
```

################################################################################
# F) AUTORISÉS
################################################################################

### ✅ AUTORISÉ 1 : Types partagés au niveau NAV2

```typescript
// ✅ OK - Un seul fichier types partagé (contrats API)
import type { HostingInfo, FtpUser, SslCertificate } from "../../hosting.types";
```

**Pourquoi ?** Les types sont des contrats d'API, pas du code exécutable.

### ✅ AUTORISÉ 2 : Services API globaux (/services/api.ts)

```typescript
// ✅ OK - Fonctions API bas niveau
import { ovhGet, ovhPost, ovhPut, ovhDelete } from "@/services/api";
```

### ✅ AUTORISÉ 3 : Composants design system global (/components/)

```typescript
// ✅ OK - Composants UI génériques de l'application
import { Button, Modal, Table, Alert } from "@/components/ui";
import { DataGrid } from "@/components/DataGrid";
```

### ✅ AUTORISÉ 4 : CSS layout au niveau NAV2

```typescript
// ✅ OK - styles.css au niveau NAV2 pour le LAYOUT uniquement
import "./styles.css";
```

Le fichier `styles.css` au niveau NAV2 contient UNIQUEMENT :
- Layout principal (`.hosting-page`, `.hosting-split`)
- Sidebar (`.hosting-sidebar`, `.hosting-service-*`)
- Header service (`.hosting-detail-header`)
- Navigation NAV3/NAV4 (`.hosting-tabs`, `.hosting-tab-btn`)
- États vides (`.hosting-empty`)
- Squelettes de chargement

**Ce fichier NE CONTIENT PAS de styles de tabs.**

### ✅ AUTORISÉ 5 : Variables CSS globales ODS

```css
/* ✅ OK - Utiliser les variables du design system */
.ftp-card {
  color: var(--ods-color-primary);
  padding: var(--ods-spacing-md);
  border-radius: var(--ods-radius-md);
}
```

### ✅ AUTORISÉ 6 : Hooks globaux (/hooks/)

```typescript
// ✅ OK - Hooks génériques de l'application
import { useApi } from "@/hooks/useApi";
import { useToast } from "@/hooks/useToast";
```

### ✅ AUTORISÉ 7 : Barrel file DANS un tab (export unique)

```typescript
// ✅ OK - hosting/expert/ftp/index.ts
export { FtpTab } from "./FtpTab";
export { FtpTab as default } from "./FtpTab";
```

### ✅ AUTORISÉ 8 : Duplication JS assumée

```typescript
// ✅ OK - Si FTP et SSL ont besoin de formatDate(), CHAQUE tab a SA copie :

// expert/ftp/FtpTab.service.ts
const formatDate = (d: string) => new Date(d).toLocaleDateString("fr-FR");

// sites/ssl/SslTab.service.ts
const formatDate = (d: string) => new Date(d).toLocaleDateString("fr-FR");
```

### ✅ AUTORISÉ 9 : Duplication CSS assumée

```css
/* ✅ OK - Si FTP et SSL ont besoin du même style, CHAQUE tab a SA copie */

/* expert/ftp/FtpTab.css */
.ftp-status-badge {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
}

/* sites/ssl/SslTab.css */
.ssl-status-badge {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
}
```

################################################################################
# G) SPECS LAYOUT (ex prompt_split_layout_method.txt)
################################################################################

## Template obligatoire

Chaque NAV2 DOIT avoir ces 4 éléments de layout avec les specs exactes :

### G.1 CONTAINER (.{nav2}-page)

```css
.{nav2}-page {
  display: flex;
  flex-direction: column;
  height: 100%;
  min-height: 0;
  overflow: hidden;
  /* PAS DE PADDING - conteneur racine */
}
```

### G.2 SPLIT (.{nav2}-split)

```css
.{nav2}-split {
  display: flex;
  flex-direction: row;
  flex: 1;
  min-height: 0;
  overflow: hidden;

  /* ══════ SPECS CRITIQUES ══════ */
  padding: 15px 24px 24px 24px;  /* top=15px (gap NAV2), autres=24px */
  gap: 16px;                     /* entre sidebar et main */
}
```

### G.3 SIDEBAR (.{nav2}-sidebar)

```css
.{nav2}-sidebar {
  /* ══════ SPECS CRITIQUES ══════ */
  width: 280px;
  min-width: 280px;
  max-width: 280px;
  flex-shrink: 0;

  /* Reste du style */
  height: 100%;
  display: flex;
  flex-direction: column;
  background: #FFFFFF;
  border: 1px solid #E5E7EB;
  border-radius: 8px;
  overflow: hidden;
}
```

### G.4 MAIN (.{nav2}-main)

```css
.{nav2}-main {
  /* ══════ SPECS CRITIQUES ══════ */
  flex: 1;
  min-width: 0;

  /* Reste du style */
  height: 100%;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
}
```

## Récapitulatif specs

```
┌─────────────────────────────────────────────────────────────┐
│                    SPECS LAYOUT CRITIQUES                   │
├─────────────────────────────────────────────────────────────┤
│  NAV1 height       │  50px                                  │
│  NAV2 height       │  40px                                  │
│  Gap NAV2→Content  │  15px (padding-top du split)           │
│  Margins latérales │  24px (padding left/right du split)    │
│  Sidebar width     │  280px (min/max aussi)                 │
│  Gap panels        │  16px (entre sidebar et main)          │
├─────────────────────────────────────────────────────────────┤
│  .{nav2}-split {                                            │
│    padding: 15px 24px 24px 24px;                            │
│    gap: 16px;                                               │
│  }                                                          │
│  .{nav2}-sidebar {                                          │
│    width: 280px; min-width: 280px; max-width: 280px;        │
│  }                                                          │
└─────────────────────────────────────────────────────────────┘
```

################################################################################
# H) CONVENTIONS DE NOMMAGE
################################################################################

## Fichiers

| Élément | Convention | Exemple |
|---------|------------|---------|
| Types NAV2 | `{nav2}.types.ts` | `hosting.types.ts` |
| Layout NAV2 | `{Nav2}Layout.tsx` | `HostingLayout.tsx` |
| Sidebar NAV2 | `{Nav2}Sidebar.tsx` | `HostingSidebar.tsx` |
| CSS Layout | `styles.css` | `styles.css` |
| Composant NAV4 | `{Nav4}Tab.tsx` | `FtpTab.tsx` |
| Service NAV4 | `{Nav4}Tab.service.ts` | `FtpTab.service.ts` |
| CSS NAV4 | `{Nav4}Tab.css` | `FtpTab.css` |
| Barrel NAV4 | `index.ts` | `index.ts` |
| Modale | `{Action}{Nav4}Modal.tsx` | `CreateFtpUserModal.tsx` |
| Index modales | `modals.ts` | `modals.ts` |
| Traduction | `{nav1}.{nav2}.{nav4}.json` | `web-cloud.hosting.ftp.json` |

## Classes CSS

**Préfixe OBLIGATOIRE : `.{nav4}-*`**

| Tab (NAV4) | Préfixe | Exemples |
|------------|---------|----------|
| general | `.general-` | `.general-card`, `.general-row` |
| ftp | `.ftp-` | `.ftp-user`, `.ftp-quota` |
| ssl | `.ssl-` | `.ssl-cert`, `.ssl-status` |
| cdn | `.cdn-` | `.cdn-domain`, `.cdn-flush` |
| multisite | `.multisite-` | `.multisite-table`, `.multisite-row` |
| database | `.database-` | `.database-card`, `.database-info` |
| boost | `.boost-` | `.boost-feature`, `.boost-btn` |
| cron | `.cron-` | `.cron-table`, `.cron-row` |
| logs | `.logs-` | `.logs-chart`, `.logs-filter` |
| modules | `.modules-` | `.modules-card`, `.modules-btn` |

**Modales : `.{nav4}-modal-*`**

```css
/* ✅ CORRECT */
.ftp-modal-overlay { }
.ftp-modal-container { }
.ftp-modal-header { }
.ftp-modal-footer { }

/* ❌ INCORRECT */
.modal-overlay { }      /* Générique, pas préfixé */
.wh-modal-btn { }       /* Préfixe wh- interdit */
```

## Imports depuis un tab

```typescript
// expert/ftp/FtpTab.tsx

// Service API global
import { ovhGet, ovhPost } from "@/services/api";

// Types NAV2
import type { HostingInfo, FtpUser } from "../../hosting.types";

// Service local (même dossier)
import { ftpService } from "./FtpTab.service";

// CSS local (même dossier)
import "./FtpTab.css";

// Modales locales (même dossier)
import { CreateFtpUserModal, EditFtpUserModal } from "./modals";
```

################################################################################
# I) INDÉPENDANCE ENTRE NIVEAUX
################################################################################

| Niveau | Indépendance | Partage autorisé |
|--------|--------------|------------------|
| **NAV1 ↔ NAV1** | ✅ TOTALE | Globaux uniquement (`/services/api.ts`, `/components/ui`, `/hooks/`) |
| **NAV2 ↔ NAV2** | ✅ TOTALE | Globaux uniquement |
| **NAV3 ↔ NAV3** | ✅ TOTALE | `{nav2}.types.ts` uniquement |
| **NAV4 ↔ NAV4** | ✅ TOTALE | `{nav2}.types.ts` uniquement |
| **NAV5 ↔ NAV5** | ⚠️ Partielle | Même service (dans le même NAV4) |

## Schéma

```
NAV4: FTP                    NAV4: SSL                    NAV4: Database
┌──────────────────┐         ┌──────────────────┐         ┌──────────────────┐
│ FtpTab.tsx       │         │ SslTab.tsx       │         │ DatabaseTab.tsx  │
│ FtpTab.service.ts│  ✖──────│ SslTab.service.ts│  ✖──────│ ...service.ts    │
│ FtpTab.css       │  JAMAIS │ SslTab.css       │  JAMAIS │ ...              │
└────────┬─────────┘         └────────┬─────────┘         └────────┬─────────┘
         │                            │                            │
         └────────────────────────────┼────────────────────────────┘
                                      │
                           ┌──────────▼──────────┐
                           │  hosting.types.ts   │  ← SEUL partage autorisé
                           │  (types = contrats) │
                           └─────────────────────┘
```

################################################################################
# J) WORKFLOW DE DÉFACTORISATION
################################################################################

## PHASE 1 : ANALYSE

```bash
# 1. Lister les méthodes du service monolithique
grep -n "export.*function\|export.*const.*=" services/{nav1}.{nav2}.ts

# 2. Lister les types
grep -n "export.*type\|export.*interface" services/{nav1}.{nav2}.ts

# 3. Lister les classes CSS utilisées
grep -roh 'className="[^"]*"' src/pages/{nav1}/{nav2}/ | sort | uniq -c | sort -rn

# 4. Identifier les imports croisés existants
grep -rn "from.*\/.*Tab" src/pages/{nav1}/{nav2}/
```

## PHASE 2 : CRÉATION TYPES NAV2

```typescript
// src/pages/{nav1}/{nav2}/{nav2}.types.ts

// Types partagés - SEUL fichier partagé entre les tabs
// Contrats API uniquement, pas de code exécutable

export interface {Nav2}Info {
  serviceName: string;
  // ...
}

export interface FtpUser {
  // ...
}

export interface SslCertificate {
  // ...
}
```

## PHASE 3 : CRÉATION SERVICE PAR TAB

```typescript
// src/pages/{nav1}/{nav2}/{nav3}/{nav4}/{Nav4}Tab.service.ts

import { ovhGet, ovhPost, ovhPut, ovhDelete } from "@/services/api";
import type { {Nav4}Data } from "../../{nav2}.types";

// ========================================
// SERVICE {NAV4} - ISOLÉ
// ========================================

// Helpers locaux (dupliqués si nécessaire)
const formatDate = (d: string) => new Date(d).toLocaleDateString("fr-FR");

// API calls
export const {nav4}Service = {
  getAll: (serviceName: string): Promise<{Nav4}Data[]> =>
    ovhGet(`/hosting/web/${serviceName}/{nav4}`),

  get: (serviceName: string, id: string): Promise<{Nav4}Data> =>
    ovhGet(`/hosting/web/${serviceName}/{nav4}/${id}`),

  create: (serviceName: string, data: Partial<{Nav4}Data>): Promise<void> =>
    ovhPost(`/hosting/web/${serviceName}/{nav4}`, data),

  update: (serviceName: string, id: string, data: Partial<{Nav4}Data>): Promise<void> =>
    ovhPut(`/hosting/web/${serviceName}/{nav4}/${id}`, data),

  delete: (serviceName: string, id: string): Promise<void> =>
    ovhDelete(`/hosting/web/${serviceName}/{nav4}/${id}`),
};
```

## PHASE 4 : CRÉATION CSS PAR TAB

```css
/* src/pages/{nav1}/{nav2}/{nav3}/{nav4}/{Nav4}Tab.css */

/* ========================================
   STYLES {NAV4} - ISOLÉS
   Préfixe OBLIGATOIRE : .{nav4}-*
   ======================================== */

.{nav4}-tab {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.{nav4}-toolbar {
  display: flex;
  align-items: center;
  gap: 12px;
}

.{nav4}-table {
  width: 100%;
  background: #FFFFFF;
  border-radius: 8px;
}

.{nav4}-status-badge {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
}

/* Modales */
.{nav4}-modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.{nav4}-modal-container {
  background: #FFFFFF;
  border-radius: 8px;
  width: 480px;
  max-height: 90vh;
  overflow-y: auto;
}
```

## PHASE 5 : VÉRIFICATION

```bash
# ===== TESTS D'ISOLATION JS (DOIVENT RETOURNER 0 RÉSULTAT) =====

echo "=== Test JS-1: imports croisés entre tabs ==="
grep -rn "from.*\/.*Tab\." src/pages/{nav1}/{nav2}/{nav3}/{nav4}/ | grep -v "from \"./"

echo "=== Test JS-2: ancien service monolithique ==="
grep -rn "from.*services/{nav1}\.{nav2}" src/pages/{nav1}/{nav2}/

echo "=== Test JS-3: utils/helpers partagés ==="
grep -rn "from.*{nav2}\.utils\|from.*{nav2}\.helpers" src/pages/{nav1}/{nav2}/

# ===== TESTS D'ISOLATION CSS (DOIVENT RETOURNER 0 RÉSULTAT) =====

echo "=== Test CSS-1: import CSS croisé entre tabs ==="
grep -rn "import.*\.\.\/.*\.css" src/pages/{nav1}/{nav2}/{nav3}/{nav4}/

echo "=== Test CSS-2: classes sans préfixe ==="
grep -rn 'className="modal-\|className="btn-\|className="card-' src/pages/{nav1}/{nav2}/{nav3}/{nav4}/

echo "=== Test CSS-3: préfixe wh- interdit ==="
grep -rn 'className="wh-' src/pages/{nav1}/{nav2}/{nav3}/{nav4}/

# ===== TESTS LAYOUT =====

echo "=== Test Layout: padding split ==="
grep -n "padding.*15px.*24px.*24px.*24px" src/pages/{nav1}/{nav2}/styles.css

echo "=== Test Layout: gap split ==="
grep -n "gap.*16px" src/pages/{nav1}/{nav2}/styles.css

echo "=== Test Layout: sidebar width ==="
grep -n "width.*280px" src/pages/{nav1}/{nav2}/styles.css

# ===== BUILD =====
npm run build:dev
```

################################################################################
# K) CHECKLIST FINALE
################################################################################

## Avant de commencer
- [ ] Structure NAV3/NAV4 identifiée
- [ ] Service monolithique JS identifié
- [ ] CSS monolithique identifié
- [ ] Liste des tabs (NAV4) à défactoriser

## Création structure
- [ ] `{nav2}.types.ts` créé avec TOUS les types
- [ ] Dossiers `{nav3}/{nav4}/` créés
- [ ] `{Nav4}Tab.service.ts` créé pour CHAQUE tab
- [ ] `{Nav4}Tab.css` créé pour CHAQUE tab
- [ ] `index.ts` créé pour CHAQUE tab
- [ ] Modales dans le même dossier que le tab

## CSS
- [ ] Layout dans `styles.css` au niveau NAV2
- [ ] Toutes les classes tabs préfixées `.{nav4}-*`
- [ ] Aucune classe générique (modal-, btn-, card-)
- [ ] Aucun préfixe `wh-`

## Traductions
- [ ] `{nav1}.{nav2}.{nav4}.json` créé pour CHAQUE tab (FR)
- [ ] `{nav1}.{nav2}.{nav4}.json` créé pour CHAQUE tab (EN)

## Validation JS
- [ ] Test imports croisés → 0 résultat
- [ ] Test ancien service → 0 résultat
- [ ] Test utils partagés → 0 résultat

## Validation CSS
- [ ] Test CSS croisé → 0 résultat
- [ ] Test classes sans préfixe → 0 résultat
- [ ] Test préfixe wh- → 0 résultat

## Validation Layout
- [ ] padding split: 15px 24px 24px 24px
- [ ] gap split: 16px
- [ ] sidebar width: 280px

## Finalisation
- [ ] Build réussi (`npm run build:dev`)
- [ ] Ancien service JS backupé + supprimé
- [ ] Test fonctionnel

################################################################################
# L) RAPPEL FINAL
################################################################################

> **DÉFACTORISATION = DUPLICATION VOLONTAIRE (JS + CSS)**
>
> Si tu hésites entre "factoriser pour éviter la duplication" et "dupliquer pour garantir l'isolation" :
>
> **→ TOUJOURS CHOISIR L'ISOLATION**
>
> Le coût de la duplication (quelques lignes JS/CSS en plus) est INFINIMENT plus faible
> que le coût du couplage (régressions en cascade, styles qui cassent, tests impossibles).
>
> **"Chaque tab (NAV4) est une île. Aucun pont entre les îles. Ni en JS, ni en CSS."**

################################################################################
# FIN PROMPT SPLIT v3
################################################################################
